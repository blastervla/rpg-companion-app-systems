[
  {
    "id": "level",
    "name": "Level",
    "type": "base",
    "value_type": "integer",
    "default_value": 1
  },
  {
    "id": "calculators",
    "name": "Calculators",
    "type": "base",
    "value_type": "array",
    "sub_value_type": "resource",
    "resource_type": "value_calculator",
    "default_value": []
  },
  {
    "id": "aggregation_type",
    "name": "Aggregation type",
    "type": "base",
    "value_type": "string",
    "default_value": "max"
  },
  {
    "id": "is_levelled",
    "name": "Is levelled",
    "type": "base",
    "value_type": "bool",
    "default_value": true
  },
  {
    "id": "calculators_as_values",
    "name": "Calculators as values",
    "type": "calculated",
    "value_type": "array",
    "sub_value_type": "integer",
    "components": {
      "type": "map",
      "components": {
        "type": "stat",
        "stat": "calculators"
      },
      "mapper": {
        "type": "stat",
        "stat": "$mapValue.calculated_value"
      }
    }
  },
  {
    "id": "calculated_value",
    "name": "Calculated value",
    "type": "calculated",
    "value_type": "integer",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "and",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "defined",
                  "stat": "$character"
                },
                {
                  "type": "equals",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "stat",
                        "stat": "aggregation_type"
                      },
                      {
                        "type": "constant",
                        "value": "max",
                        "value_type": "string"
                      }
                    ]
                  }
                }
              ]
            }
          },
          "components": {
            "type": "max",
            "components": {
              "type": "stat",
              "stat": "calculators_as_values"
            }
          }
        },
        {
          "condition": {
            "type": "and",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "defined",
                  "stat": "$character"
                },
                {
                  "type": "equals",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "stat",
                        "stat": "aggregation_type"
                      },
                      {
                        "type": "constant",
                        "value": "min",
                        "value_type": "string"
                      }
                    ]
                  }
                }
              ]
            }
          },
          "components": {
            "type": "min",
            "components": {
              "type": "stat",
              "stat": "calculators_as_values"
            }
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": 0,
            "value_type": "integer"
          }
        }
      ]
    }
  },
  {
    "id": "description",
    "name": "Display description",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "concat",
      "components": {
        "type": "list",
        "components": [
          {
            "type": "constant",
            "value": "Lvl. ",
            "value_type": "string"
          },
          {
            "type": "stat",
            "stat": "level"
          },
          {
            "type": "constant",
            "value": ": ",
            "value_type": "string"
          },
          {
            "type": "stat",
            "stat": "aggregation_type"
          },
          {
            "type": "constant",
            "value": "(",
            "value_type": "string"
          },
          {
            "type": "joinToString",
            "separator": ", ",
            "components": {
              "type": "map",
              "components": {
                "type": "stat",
                "stat": "calculators"
              },
              "mapper": {
                "type": "stat",
                "stat": "$mapValue.description"
              }
            }
          },
          {
            "type": "constant",
            "value": ")",
            "value_type": "string"
          }
        ]
      }
    }
  }
]