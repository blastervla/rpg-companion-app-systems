[
  {
    "id": "name",
    "name": "Name",
    "type": "base",
    "value_type": "string",
    "default_value": ""
  },
  {
    "id": "source",
    "name": "Source",
    "type": "base",
    "value_type": "string",
    "default_value": ""
  },
  {
    "id": "is_core",
    "name": "Core",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "mastery",
    "name": "Mastery",
    "type": "base",
    "value_type": "string",
    "default_value": "none"
  },
  {
    "id": "description",
    "name": "Description",
    "type": "base",
    "value_type": "string",
    "default_value": ""
  },
  {
    "id": "cost",
    "name": "Cost",
    "type": "base",
    "value_type": "resource",
    "default_value": null
  },
  {
    "id": "weight",
    "name": "Weight",
    "type": "base",
    "value_type": "resource",
    "default_value": null
  },
  {
    "id": "type",
    "name": "Type",
    "type": "base",
    "value_type": "string",
    "default_value": "club"
  },
  {
    "id": "attack_ability",
    "name": "Attack ability",
    "type": "base",
    "value_type": "string",
    "default_value": "strength"
  },
  {
    "id": "add_attack_ability_to_damage",
    "name": "Add attack ability to damage",
    "type": "base",
    "value_type": "bool",
    "default_value": true
  },
  {
    "id": "rarity",
    "name": "Rarity",
    "type": "base",
    "value_type": "string",
    "default_value": "common"
  },
  {
    "id": "requires_attunement",
    "name": "Requires attunement",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "display_type",
    "name": "Display type",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "and",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "stat",
                  "stat": "is_simple"
                },
                {
                  "type": "stat",
                  "stat": "is_range"
                }
              ]
            }
          },
          "components": {
            "type": "constant",
            "value": "simple_ranged",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "and",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "stat",
                  "stat": "is_simple"
                },
                {
                  "type": "not",
                  "components": {
                    "type": "stat",
                    "stat": "is_range"
                  }
                }
              ]
            }
          },
          "components": {
            "type": "constant",
            "value": "simple_melee",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "and",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "not",
                  "components": {
                    "type": "stat",
                    "stat": "is_simple"
                  }
                },
                {
                  "type": "stat",
                  "stat": "is_range"
                }
              ]
            }
          },
          "components": {
            "type": "constant",
            "value": "martial_ranged",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "and",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "not",
                  "components": {
                    "type": "stat",
                    "stat": "is_simple"
                  }
                },
                {
                  "type": "not",
                  "components": {
                    "type": "stat",
                    "stat": "is_range"
                  }
                }
              ]
            }
          },
          "components": {
            "type": "constant",
            "value": "martial_melee",
            "value_type": "string"
          }
        }
      ]
    }
  },
  {
    "id": "is_simple",
    "name": "Is simple",
    "type": "base",
    "value_type": "bool",
    "default_value": true
  },
  {
    "id": "is_two_handed",
    "name": "Is two-handed",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_finesse",
    "name": "Is finesse",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_silver",
    "name": "Is silver",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_thrown",
    "name": "Is thrown",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "thrown_range",
    "name": "Thrown range",
    "type": "base",
    "value_type": "string",
    "default_value": "80/320"
  },
  {
    "id": "is_heavy",
    "name": "Is heavy",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_light",
    "name": "Is light",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_loading",
    "name": "Is loading",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_reach",
    "name": "Is reach",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "reach_range",
    "name": "Reach range",
    "type": "base",
    "value_type": "integer",
    "default_value": 5
  },
  {
    "id": "is_special",
    "name": "Is special",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_improvised",
    "name": "Is improvised",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_range",
    "name": "Is range",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "range",
    "name": "Range",
    "type": "base",
    "value_type": "string",
    "default_value": "80/320"
  },
  {
    "id": "ammunition_type",
    "name": "Ammunition type",
    "type": "base",
    "value_type": "string",
    "default_value": "none"
  },
  {
    "id": "extra_attack_bonus",
    "name": "Extra attack bonus",
    "type": "base",
    "value_type": "integer",
    "default_value": 0
  },
  {
    "id": "damage_dice",
    "name": "Damage dice",
    "type": "base",
    "value_type": "array",
    "sub_value_type": "resource",
    "resource_type": "damage_dice",
    "default_value": []
  },
  {
    "id": "is_versatile",
    "name": "Is versatile",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "versatile_damage_dice",
    "name": "Versatile damage dice",
    "type": "base",
    "value_type": "array",
    "sub_value_type": "resource",
    "resource_type": "damage_dice",
    "default_value": []
  },
  {
    "id": "should_load_effects",
    "name": "Should not load effects",
    "type": "calculated",
    "value_type": "bool",
    "components": {
      "type": "defaultIfNull",
      "components": {
        "type": "stat",
        "stat": "$parent?.should_load_effects?"
      },
      "default_components": {
        "type": "constant",
        "value": true,
        "value_type": "bool"
      }
    }
  },
  {
    "id": "effects",
    "name": "Effects",
    "type": "base",
    "value_type": "array",
    "sub_value_type": "resource",
    "resource_type": "effect",
    "default_value": []
  },
  {
    "id": "override_is_proficient",
    "name": "Override is proficient",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "is_attuned",
    "name": "Is attuned",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "currently_used_as_versatile",
    "name": "Is it currently being used as versatile?",
    "type": "base",
    "value_type": "bool",
    "default_value": false
  },
  {
    "id": "advantage_status",
    "name": "Advantage status",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "or",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "defaultIfNull",
                  "components": {
                    "type": "stat",
                    "stat": "$character?.is_not_wearing_inproficient_armor"
                  },
                  "default_components": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                  }
                },
                {
                  "type": "and",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "notEquals",
                        "components": {
                          "type": "list",
                          "components": [
                            {
                              "type": "stat",
                              "stat": "attack_ability"
                            },
                            {
                              "type": "constant",
                              "value": "strength",
                              "value_type": "string"
                            }
                          ]
                        }
                      },
                      {
                        "type": "notEquals",
                        "components": {
                          "type": "list",
                          "components": [
                            {
                              "type": "stat",
                              "stat": "attack_ability"
                            },
                            {
                              "type": "constant",
                              "value": "dexterity",
                              "value_type": "string"
                            }
                          ]
                        }
                      }
                    ]
                  }
                }
              ]
            }
          },
          "components": {
            "type": "constant",
            "value": "none",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": "disadvantage",
            "value_type": "string"
          }
        }
      ]
    }
  },
  {
    "id": "has_ammunition",
    "name": "Has ammunition",
    "type": "calculated",
    "value_type": "bool",
    "components": {
      "type": "and",
      "components": {
        "type": "list",
        "components": [
          {
            "type": "stat",
            "stat": "is_range"
          },
          {
            "type": "notEquals",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "stat",
                  "stat": "ammunition_type"
                },
                {
                  "type": "constant",
                  "value": "none",
                  "value_type": "string"
                }
              ]
            }
          }
        ]
      }
    }
  },
  {
    "id": "is_proficient",
    "name": "Is proficient",
    "type": "calculated",
    "value_type": "bool",
    "components": {
      "type": "or",
      "components": {
        "type": "list",
        "components": [
          {
            "type": "stat",
            "stat": "override_is_proficient"
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "defined",
                  "stat": "$character"
                },
                "components": {
                  "type": "or",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "contains",
                        "haystack": {
                          "type": "stat",
                          "stat": "$character.weapon_proficiencies"
                        },
                        "needle": {
                          "type": "stat",
                          "stat": "type"
                        }
                      },
                      {
                        "type": "and",
                        "components": {
                          "type": "list",
                          "components": [
                            {
                              "type": "contains",
                              "haystack": {
                                "type": "stat",
                                "stat": "$character.weapon_proficiencies"
                              },
                              "needle": {
                                "type": "constant",
                                "value": "all_martial",
                                "value_type": "string"
                              }
                            },
                            {
                              "type": "not",
                              "components": {
                                "type": "stat",
                                "stat": "is_simple"
                              }
                            }
                          ]
                        }
                      },
                      {
                        "type": "and",
                        "components": {
                          "type": "list",
                          "components": [
                            {
                              "type": "contains",
                              "haystack": {
                                "type": "stat",
                                "stat": "$character.weapon_proficiencies"
                              },
                              "needle": {
                                "type": "constant",
                                "value": "all_simple",
                                "value_type": "string"
                              }
                            },
                            {
                              "type": "stat",
                              "stat": "is_simple"
                            }
                          ]
                        }
                      }
                    ]
                  }
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "constant",
                  "value": false,
                  "value_type": "bool"
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "id": "versatile_damage_dice_display_description",
    "name": "Display versatile damage dice",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "isEmpty",
            "components": {
              "type": "stat",
              "stat": "versatile_damage_dice"
            }
          },
          "components": {
            "type": "constant",
            "value": "no damage",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "concat",
            "components": {
              "type": "flatAppend",
              "components": [
                {
                  "type": "list",
                  "components": [
                    {
                      "type": "joinToString",
                      "separator": " + ",
                      "components": {
                        "type": "map",
                        "components": {
                          "type": "stat",
                          "stat": "versatile_damage_dice"
                        },
                        "mapper": {
                          "type": "stat",
                          "stat": "$mapValue.display_description"
                        }
                      }
                    }
                  ]
                },
                {
                  "type": "flatAppend",
                  "components": [
                    {
                      "type": "when",
                      "clauses": [
                        {
                          "condition": {
                            "type": "greaterThan",
                            "components": {
                              "type": "list",
                              "components": [
                                {
                                  "type": "stat",
                                  "stat": "damage_bonus"
                                },
                                {
                                  "type": "constant",
                                  "value": 0,
                                  "value_type": "integer"
                                }
                              ]
                            }
                          },
                          "components": {
                            "type": "list",
                            "components": [
                              {
                                "type": "constant",
                                "value": " + ",
                                "value_type": "string"
                              },
                              {
                                "type": "stat",
                                "stat": "damage_bonus"
                              }
                            ]
                          }
                        },
                        {
                          "condition": {
                            "type": "lessThan",
                            "components": {
                              "type": "list",
                              "components": [
                                {
                                  "type": "stat",
                                  "stat": "damage_bonus"
                                },
                                {
                                  "type": "constant",
                                  "value": 0,
                                  "value_type": "integer"
                                }
                              ]
                            }
                          },
                          "components": {
                            "type": "list",
                            "components": [
                              {
                                "type": "constant",
                                "value": " - ",
                                "value_type": "string"
                              },
                              {
                                "type": "multiply",
                                "components": {
                                  "type": "list",
                                  "components": [
                                    {
                                      "type": "stat",
                                      "stat": "damage_bonus"
                                    },
                                    {
                                      "type": "constant",
                                      "value": -1,
                                      "value_type": "integer"
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        },
                        {
                          "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                          },
                          "components": {
                            "type": "list",
                            "components": []
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    }
  },
  {
    "id": "properties",
    "name": "Properties",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "joinToString",
      "separator": ", ",
      "components": {
        "type": "flatAppend",
        "components": [
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "notEquals",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "stat",
                        "stat": "rarity"
                      },
                      {
                        "type": "constant",
                        "value": "none",
                        "value_type": "string"
                      }
                    ]
                  }
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "enumeratedName",
                      "enumerated_type": "item_rarity",
                      "id": {
                        "type": "stat",
                        "stat": "rarity"
                      }
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "notEquals",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "stat",
                        "stat": "mastery"
                      },
                      {
                        "type": "constant",
                        "value": "none",
                        "value_type": "string"
                      }
                    ]
                  }
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "enumeratedName",
                      "enumerated_type": "weapon_masteries",
                      "id": {
                        "type": "stat",
                        "stat": "mastery"
                      }
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_two_handed"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "two-handed",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_versatile"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "concat",
                      "components": {
                        "type": "list",
                        "components": [
                          {
                            "type": "constant",
                            "value": "versatile",
                            "value_type": "string"
                          }
                        ]
                      }
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_silver"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "silver",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_finesse"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "finesse",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_thrown"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "concat",
                      "components": {
                        "type": "list",
                        "components": [
                          {
                            "type": "constant",
                            "value": "thrown (",
                            "value_type": "string"
                          },
                          {
                            "type": "stat",
                            "stat": "thrown_range"
                          },
                          {
                            "type": "constant",
                            "value": ")",
                            "value_type": "string"
                          }
                        ]
                      }
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_heavy"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "heavy",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_light"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "light",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_loading"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "loading",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_special"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "special",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_improvised"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "improvised",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_range"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "concat",
                      "components": {
                        "type": "list",
                        "components": [
                          {
                            "type": "constant",
                            "value": "range (",
                            "value_type": "string"
                          },
                          {
                            "type": "stat",
                            "stat": "range"
                          },
                          {
                            "type": "constant",
                            "value": ")",
                            "value_type": "string"
                          }
                        ]
                      }
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_reach"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "concat",
                      "components": {
                        "type": "list",
                        "components": [
                          {
                            "type": "constant",
                            "value": "reach ",
                            "value_type": "string"
                          },
                          {
                            "type": "stat",
                            "stat": "reach_range"
                          },
                          {
                            "type": "constant",
                            "value": " ft.",
                            "value_type": "string"
                          }
                        ]
                      }
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "requires_attunement"
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "constant",
                      "value": "requires attunement",
                      "value_type": "string"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "notEquals",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "defaultIfNull",
                        "components": {
                          "type": "stat",
                          "stat": "cost?.value"
                        },
                        "default_components": {
                          "type": "constant",
                          "value": 0,
                          "value_type": "integer"
                        }
                      },
                      {
                        "type": "constant",
                        "value": 0,
                        "value_type": "integer"
                      }
                    ]
                  }
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "stat",
                      "stat": "cost.description"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "notEquals",
                  "components": {
                    "type": "list",
                    "components": [
                      {
                        "type": "defaultIfNull",
                        "components": {
                          "type": "stat",
                          "stat": "weight?.value"
                        },
                        "default_components": {
                          "type": "constant",
                          "value": 0,
                          "value_type": "integer"
                        }
                      },
                      {
                        "type": "constant",
                        "value": 0,
                        "value_type": "integer"
                      }
                    ]
                  }
                },
                "components": {
                  "type": "list",
                  "components": [
                    {
                      "type": "stat",
                      "stat": "weight.description"
                    }
                  ]
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "list",
                  "components": []
                }
              }
            ]
          }
        ]
      }
    }
  },
  {
    "id": "attack_modifier_stat_id",
    "name": "Attack modifier stat id",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "concat",
      "components": {
        "type": "list",
        "components": [
          {
            "type": "constant",
            "value": "$character.",
            "value_type": "string"
          },
          {
            "type": "stat",
            "stat": "attack_ability"
          },
          {
            "type": "constant",
            "value": "_modifier",
            "value_type": "string"
          }
        ]
      }
    }
  },
  {
    "id": "attack_bonus",
    "name": "Attack bonus",
    "type": "calculated",
    "value_type": "integer",
    "components": {
      "type": "add",
      "components": {
        "type": "list",
        "components": [
          {
            "type": "max",
            "components": {
              "type": "flatAppend",
              "components": [
                {
                  "type": "list",
                  "components": [
                    {
                      "type": "metaStat",
                      "meta_stat": {
                        "type": "stat",
                        "stat": "attack_modifier_stat_id"
                      }
                    }
                  ]
                },
                {
                  "type": "when",
                  "clauses": [
                    {
                      "condition": {
                        "type": "stat",
                        "stat": "is_finesse"
                      },
                      "components": {
                        "type": "list",
                        "components": [
                          {
                            "type": "stat",
                            "stat": "$character.dexterity_modifier"
                          }
                        ]
                      }
                    },
                    {
                      "condition": {
                        "type": "constant",
                        "value": true,
                        "value_type": "bool"
                      },
                      "components": {
                        "type": "list",
                        "components": []
                      }
                    }
                  ]
                }
              ]
            }
          },
          {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "is_proficient"
                },
                "components": {
                  "type": "stat",
                  "stat": "$character.proficiency_bonus"
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "constant",
                  "value": 0,
                  "value_type": "integer"
                }
              }
            ]
          },
          {
            "type": "stat",
            "stat": "extra_attack_bonus"
          }
        ]
      }
    }
  },
  {
    "id": "damage_bonus",
    "name": "Damage bonus",
    "type": "calculated",
    "value_type": "integer",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "and",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "defined",
                  "stat": "$character"
                },
                {
                  "type": "stat",
                  "stat": "add_attack_ability_to_damage"
                }
              ]
            }
          },
          "components": {
            "type": "max",
            "components": {
              "type": "flatAppend",
              "components": [
                {
                  "type": "list",
                  "components": [
                    {
                      "type": "metaStat",
                      "meta_stat": {
                        "type": "stat",
                        "stat": "attack_modifier_stat_id"
                      }
                    }
                  ]
                },
                {
                  "type": "when",
                  "clauses": [
                    {
                      "condition": {
                        "type": "stat",
                        "stat": "is_finesse"
                      },
                      "components": {
                        "type": "list",
                        "components": [
                          {
                            "type": "stat",
                            "stat": "$character.dexterity_modifier"
                          }
                        ]
                      }
                    },
                    {
                      "condition": {
                        "type": "constant",
                        "value": true,
                        "value_type": "bool"
                      },
                      "components": {
                        "type": "list",
                        "components": []
                      }
                    }
                  ]
                }
              ]
            }
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": 0,
            "value_type": "integer"
          }
        }
      ]
    }
  },
  {
    "id": "display_attack_bonus",
    "name": "Display attack bonus",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "defined",
            "stat": "$character"
          },
          "components": {
            "type": "concat",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "when",
                  "clauses": [
                    {
                      "condition": {
                        "type": "greaterThanEquals",
                        "components": {
                          "type": "list",
                          "components": [
                            {
                              "type": "stat",
                              "stat": "attack_bonus"
                            },
                            {
                              "type": "constant",
                              "value": 0,
                              "value_type": "integer"
                            }
                          ]
                        }
                      },
                      "components": {
                        "type": "constant",
                        "value": "+",
                        "value_type": "string"
                      }
                    },
                    {
                      "condition": {
                        "type": "constant",
                        "value": true,
                        "value_type": "bool"
                      },
                      "components": {
                        "type": "constant",
                        "value": "",
                        "value_type": "string"
                      }
                    }
                  ]
                },
                {
                  "type": "stat",
                  "stat": "attack_bonus"
                }
              ]
            }
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": "",
            "value_type": "string"
          }
        }
      ]
    }
  },
  {
    "id": "damage_dice_display_description",
    "name": "Display versatile damage dice",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "isEmpty",
            "components": {
              "type": "stat",
              "stat": "damage_dice"
            }
          },
          "components": {
            "type": "constant",
            "value": "no damage",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "concat",
            "components": {
              "type": "flatAppend",
              "components": [
                {
                  "type": "list",
                  "components": [
                    {
                      "type": "joinToString",
                      "separator": " + ",
                      "components": {
                        "type": "map",
                        "components": {
                          "type": "stat",
                          "stat": "damage_dice"
                        },
                        "mapper": {
                          "type": "stat",
                          "stat": "$mapValue.display_description"
                        }
                      }
                    }
                  ]
                },
                {
                  "type": "flatAppend",
                  "components": [
                    {
                      "type": "when",
                      "clauses": [
                        {
                          "condition": {
                            "type": "not",
                            "components": {
                              "type": "defined",
                              "stat": "$character"
                            }
                          },
                          "components": {
                            "type": "list",
                            "components": []
                          }
                        },
                        {
                          "condition": {
                            "type": "greaterThan",
                            "components": {
                              "type": "list",
                              "components": [
                                {
                                  "type": "stat",
                                  "stat": "damage_bonus"
                                },
                                {
                                  "type": "constant",
                                  "value": 0,
                                  "value_type": "integer"
                                }
                              ]
                            }
                          },
                          "components": {
                            "type": "list",
                            "components": [
                              {
                                "type": "constant",
                                "value": " + ",
                                "value_type": "string"
                              },
                              {
                                "type": "stat",
                                "stat": "damage_bonus"
                              }
                            ]
                          }
                        },
                        {
                          "condition": {
                            "type": "lessThan",
                            "components": {
                              "type": "list",
                              "components": [
                                {
                                  "type": "stat",
                                  "stat": "damage_bonus"
                                },
                                {
                                  "type": "constant",
                                  "value": 0,
                                  "value_type": "integer"
                                }
                              ]
                            }
                          },
                          "components": {
                            "type": "list",
                            "components": [
                              {
                                "type": "constant",
                                "value": " - ",
                                "value_type": "string"
                              },
                              {
                                "type": "multiply",
                                "components": {
                                  "type": "list",
                                  "components": [
                                    {
                                      "type": "stat",
                                      "stat": "damage_bonus"
                                    },
                                    {
                                      "type": "constant",
                                      "value": -1,
                                      "value_type": "integer"
                                    }
                                  ]
                                }
                              }
                            ]
                          }
                        },
                        {
                          "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                          },
                          "components": {
                            "type": "list",
                            "components": []
                          }
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          }
        }
      ]
    }
  },
  {
    "id": "display_first_line_extra",
    "name": "Display first line extra",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "defined",
            "stat": "$character"
          },
          "components": {
            "type": "stat",
            "stat": "display_attack_bonus"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "stat",
            "stat": "damage_dice_display_description"
          }
        }
      ]
    }
  },
  {
    "id": "display_second_line_extra",
    "name": "Display second line extra",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "defined",
            "stat": "$character"
          },
          "components": {
            "type": "stat",
            "stat": "damage_dice_display_description"
          }
        },
        {
          "condition": {
            "type": "or",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "not",
                  "components": {
                    "type": "isEmpty",
                    "components": {
                      "type": "stat",
                      "stat": "effects"
                    }
                  }
                },
                {
                  "type": "stat",
                  "stat": "requires_attunement"
                }
              ]
            }
          },
          "components": {
            "type": "constant",
            "value": "Magic",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": "",
            "value_type": "string"
          }
        }
      ]
    }
  },
  {
    "id": "second_line_extra_color",
    "name": "Second line extra color",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "not",
            "components": {
              "type": "isEmpty",
              "components": {
                "type": "stat",
                "stat": "effects"
              }
            }
          },
          "components": {
            "type": "constant",
            "value": "accent",
            "value_type": "string"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": "text",
            "value_type": "string"
          }
        }
      ]
    }
  },
  {
    "id": "temp_shoot_ammo",
    "name": "Temp ammo item being shot",
    "type": "base",
    "value_type": "string",
    "default_value": ""
  },
  {
    "id": "ammunition_items",
    "name": "Items that can be used as ammunition for this weapon",
    "type": "calculated",
    "value_type": "array",
    "sub_value_type": "resource",
    "resource_type": "item",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "defined",
            "stat": "$character"
          },
          "components": {
            "type": "filter",
            "components": {
              "type": "stat",
              "stat": "$character.equipment"
            },
            "filter": {
              "type": "and",
              "components": {
                "type": "list",
                "components": [
                  {
                    "type": "equals",
                    "components": {
                      "type": "list",
                      "components": [
                        {
                          "type": "stat",
                          "stat": "$filterValue.type"
                        },
                        {
                          "type": "constant",
                          "value": "ammunition",
                          "value_type": "string"
                        }
                      ]
                    }
                  },
                  {
                    "type": "equals",
                    "components": {
                      "type": "list",
                      "components": [
                        {
                          "type": "stat",
                          "stat": "$filterValue.ammunition_type"
                        },
                        {
                          "type": "stat",
                          "stat": "ammunition_type"
                        }
                      ]
                    }
                  }
                ]
              }
            }
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "list",
            "components": []
          }
        }
      ]
    }
  },
  {
    "id": "selected_item_to_shoot",
    "name": "Selected item to shoot",
    "type": "calculated",
    "value_type": "resource",
    "resource_type": "item",
    "components": {
      "type": "findFirst",
      "components": {
        "type": "stat",
        "stat": "ammunition_items"
      },
      "filter": {
        "type": "equals",
        "components": {
          "type": "list",
          "components": [
            {
              "type": "stat",
              "stat": "$findFirstValue.id"
            },
            {
              "type": "stat",
              "stat": "$view?.weapon_display_ammunition_select?"
            }
          ]
        }
      }
    }
  }
]