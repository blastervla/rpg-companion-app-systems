{
  "title": {
    "id": "edit_proficiencies_title",
    "name": "Proficiencies"
  },
  "view": {
    "id": "edit_character_proficiencies",
    "type": "list",
    "padding": 32,
    "subviews": [
      {
        "id": "edit_character_proficiencies_languages",
        "type": "resourceArray",
        "resource_id": "levelled_choice_text",
        "stat": "creator_language_proficiency_choices",
        "view_type": "display",
        "left_view": {
          "id": "edit_character_proficiencies_languages_label",
          "type": "text",
          "text": {
            "type": "constant",
            "value": "Languages proficiencies:",
            "value_type": "string"
          },
          "style": "text",
          "bold": true
        }
      },
      {
        "id": "edit_character_proficiencies_skills",
        "type": "resourceArray",
        "resource_id": "levelled_skill_proficiency",
        "stat": "creator_skill_proficiency_choices",
        "view_type": "display",
        "left_view": {
          "id": "edit_character_proficiencies_skills_label",
          "type": "text",
          "text": {
            "type": "constant",
            "value": "Skill proficiencies:",
            "value_type": "string"
          },
          "style": "text",
          "bold": true
        }
      },
      {
        "id": "edit_character_proficiencies_armors",
        "type": "resourceArray",
        "resource_id": "levelled_armor_proficiency",
        "stat": "creator_armor_proficiency_choices",
        "view_type": "display",
        "left_view": {
          "id": "edit_character_proficiencies_armors_label",
          "type": "text",
          "text": {
            "type": "constant",
            "value": "Armor proficiencies:",
            "value_type": "string"
          },
          "style": "text",
          "bold": true
        }
      },
      {
        "id": "edit_character_proficiencies_weapons",
        "type": "resourceArray",
        "resource_id": "levelled_choice_text",
        "stat": "creator_weapon_proficiency_choices",
        "view_type": "display",
        "left_view": {
          "id": "edit_character_proficiencies_weapons_label",
          "type": "text",
          "text": {
            "type": "constant",
            "value": "Weapon proficiencies:",
            "value_type": "string"
          },
          "style": "text",
          "bold": true
        }
      },
      {
        "id": "edit_character_proficiencies_tools",
        "type": "resourceArray",
        "resource_id": "levelled_choice_text",
        "stat": "creator_tool_proficiency_choices",
        "view_type": "display",
        "left_view": {
          "id": "edit_character_proficiencies_tools_label",
          "type": "text",
          "text": {
            "type": "constant",
            "value": "Tool proficiencies:",
            "value_type": "string"
          },
          "style": "text",
          "bold": true
        }
      }
    ]
  },
  "on_page_open": {
    "type": "setStat",
    "stat": "selecting",
    "new_value": {
      "type": "constant",
      "value": true,
      "value_type": "bool"
    },
    "aggregation_type": "set"
  },
  "on_page_close": {
    "type": "setStat",
    "stat": "selecting",
    "new_value": {
      "type": "constant",
      "value": false,
      "value_type": "bool"
    },
    "aggregation_type": "set"
  },
  "post_edit": {
    "type": "sequence",
    "effects": [
      {
        "type": "setStat",
        "stat": "language_proficiencies",
        "new_value": {
          "type": "flatAppend",
          "treat_as_set": true,
          "components": [
            {
              "type": "stat",
              "stat": "language_proficiencies"
            },
            {
              "type": "map",
              "components": {
                "type": "flatMap",
                "components": {
                  "type": "stat",
                  "stat": "creator_language_proficiency_choices"
                },
                "mapper": {
                  "type": "split",
                  "separator": "\\\\s*,\\\\s*",
                  "components": {
                    "type": "stat",
                    "stat": "$mapValue.selected_options"
                  }
                }
              },
              "mapper": {
                "type": "trim",
                "components": {
                  "type": "stat",
                  "stat": "$mapValue"
                }
              }
            }
          ]
        },
        "aggregation_type": "set"
      },
      {
        "type": "setStat",
        "stat": "armor_proficiencies",
        "new_value": {
          "type": "flatAppend",
          "treat_as_set": true,
          "components": [
            {
              "type": "stat",
              "stat": "armor_proficiencies"
            },
            {
              "type": "map",
              "components": {
                "type": "stat",
                "stat": "creator_armor_proficiency_choices"
              },
              "mapper": {
                "type": "stat",
                "stat": "$mapValue.selected_option"
              }
            }
          ]
        },
        "aggregation_type": "set"
      },
      {
        "type": "forEach",
        "components": {
          "type": "stat",
          "stat": "creator_skill_proficiency_choices"
        },
        "apply": {
          "type": "setStat",
          "meta_stat": {
            "type": "concat",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "stat",
                  "stat": "$forEachValue.selected_option"
                },
                {
                  "type": "constant",
                  "value": "_proficiency",
                  "value_type": "string"
                }
              ]
            }
          },
          "new_value": {
            "type": "when",
            "clauses": [
              {
                "condition": {
                  "type": "stat",
                  "stat": "$forEachValue.is_expertise"
                },
                "components": {
                  "type": "constant",
                  "value": "expert",
                  "value_type": "string"
                }
              },
              {
                "condition": {
                  "type": "constant",
                  "value": true,
                  "value_type": "bool"
                },
                "components": {
                  "type": "constant",
                  "value": "proficient",
                  "value_type": "string"
                }
              }
            ]
          },
          "aggregation_type": "set"
        }
      },
      {
        "type": "setStat",
        "stat": "weapon_proficiencies",
        "new_value": {
          "type": "flatAppend",
          "treat_as_set": true,
          "components": [
            {
              "type": "stat",
              "stat": "weapon_proficiencies"
            },
            {
              "type": "list",
              "components": [
                {
                  "type": "constant",
                  "value": "unarmed_strike",
                  "value_type": "string"
                }
              ]
            },
            {
              "type": "map",
              "components": {
                "type": "stat",
                "stat": "creator_weapon_proficiency_choices"
              },
              "mapper": {
                "type": "stat",
                "stat": "$mapValue.selected_option"
              }
            }
          ]
        },
        "aggregation_type": "set"
      },
      {
        "type": "setStat",
        "stat": "tool_proficiencies",
        "new_value": {
          "type": "flatAppend",
          "treat_as_set": true,
          "components": [
            {
              "type": "stat",
              "stat": "tool_proficiencies"
            },
            {
              "type": "map",
              "components": {
                "type": "flatMap",
                "components": {
                  "type": "stat",
                  "stat": "creator_tool_proficiency_choices"
                },
                "mapper": {
                  "type": "split",
                  "separator": "\\\\s*,\\\\s*",
                  "components": {
                    "type": "stat",
                    "stat": "$mapValue.selected_options"
                  }
                }
              },
              "mapper": {
                "type": "trim",
                "components": {
                  "type": "stat",
                  "stat": "$mapValue"
                }
              }
            }
          ]
        },
        "aggregation_type": "set"
      }
    ]
  }
}