{
    "id": "5e2024",
    "name": "5.5e",
    "abbreviation": "5e 2024",
    "version": "0.5.0",
    "min_app_version": "0.5.0",
    "character_stats": [
        {
            "id": "created_at_display",
            "name": "Created at display",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "concat",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": "Created ",
                            "value_type": "string"
                        },
                        {
                            "type": "date",
                            "components": {
                                "type": "stat",
                                "stat": "created_at"
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "photo",
            "name": "Photo",
            "type": "base",
            "value_type": "photo",
            "default_value": null
        },
        {
            "id": "name",
            "name": "Name",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "alignment",
            "name": "Alignment",
            "type": "base",
            "value_type": "string",
            "default_value": "true_neutral"
        },
        {
            "id": "personality_traits",
            "name": "Personality traits",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "ideals",
            "name": "Ideals",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "bonds",
            "name": "Bonds",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "flaws",
            "name": "Flaws",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "about",
            "name": "About",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "notes",
            "name": "Notes",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "note",
            "default_value": []
        },
        {
            "id": "base_hp",
            "name": "Base HP",
            "type": "base",
            "value_type": "integer",
            "default_value": 1
        },
        {
            "id": "current_hp",
            "name": "Current HP",
            "type": "base",
            "value_type": "integer",
            "default_value": 1
        },
        {
            "id": "max_hp",
            "name": "Maximum HP",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "base_hp"
                        },
                        {
                            "type": "stat",
                            "stat": "classes_hp_mods"
                        }
                    ]
                }
            }
        },
        {
            "id": "hit_point_mode",
            "name": "Hit point mode",
            "type": "base",
            "value_type": "string",
            "default_value": "roll"
        },
        {
            "id": "classes_hp_mods",
            "name": "Classes HP mods",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "max",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": 0,
                            "value_type": "integer"
                        },
                        {
                            "type": "multiply",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    },
                                    {
                                        "type": "max",
                                        "components": {
                                            "type": "map",
                                            "map_value_key": "$class",
                                            "components": {
                                                "type": "stat",
                                                "stat": "classes"
                                            },
                                            "mapper": {
                                                "type": "add",
                                                "components": {
                                                    "type": "map",
                                                    "components": {
                                                        "type": "defaultIfNull",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.selected_archetype?.actual_hp_modifiers"
                                                        },
                                                        "default_components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_hp_modifiers"
                                                        }
                                                    },
                                                    "mapper": {
                                                        "type": "metaStat",
                                                        "potential_stat_values": [
                                                            "strength_modifier",
                                                            "dexterity_modifier",
                                                            "constitution_modifier",
                                                            "intelligence_modifier",
                                                            "wisdom_modifier",
                                                            "charisma_modifier"
                                                        ],
                                                        "meta_stat": {
                                                            "type": "concat",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "$mapValue"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "_modifier",
                                                                        "value_type": "string"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "current_d4_hit_dice",
            "name": "Hit Dice (d4)",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_d4_hit_dice",
            "name": "Max d4 hit dice",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "filter",
                        "filter_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$class.class.actual_hit_die"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "d4",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class_level"
                    }
                }
            }
        },
        {
            "id": "current_d6_hit_dice",
            "name": "Hit Dice (d6)",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_d6_hit_dice",
            "name": "Max d6 hit dice",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "filter",
                        "filter_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$class.class.actual_hit_die"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "d6",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class_level"
                    }
                }
            }
        },
        {
            "id": "current_d8_hit_dice",
            "name": "Hit Dice (d8)",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_d8_hit_dice",
            "name": "Max d8 hit dice",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "filter",
                        "filter_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$class.class.actual_hit_die"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "d8",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class_level"
                    }
                }
            }
        },
        {
            "id": "current_d10_hit_dice",
            "name": "Hit Dice (d10)",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_d10_hit_dice",
            "name": "Max d10 hit dice",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "filter",
                        "filter_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$class.class.actual_hit_die"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "d10",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class_level"
                    }
                }
            }
        },
        {
            "id": "current_d12_hit_dice",
            "name": "Hit Dice (d12)",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_d12_hit_dice",
            "name": "Max d12 hit dice",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "filter",
                        "filter_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$class.class.actual_hit_die"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "d12",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class_level"
                    }
                }
            }
        },
        {
            "id": "current_d20_hit_dice",
            "name": "Hit Dice (d20)",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_d20_hit_dice",
            "name": "Max d20 hit dice",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "filter",
                        "filter_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$class.class.actual_hit_die"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "d20",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class_level"
                    }
                }
            }
        },
        {
            "id": "total_hit_dice",
            "name": "Hit Dice (total)",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "current_d4_hit_dice"
                        },
                        {
                            "type": "stat",
                            "stat": "current_d6_hit_dice"
                        },
                        {
                            "type": "stat",
                            "stat": "current_d8_hit_dice"
                        },
                        {
                            "type": "stat",
                            "stat": "current_d10_hit_dice"
                        },
                        {
                            "type": "stat",
                            "stat": "current_d12_hit_dice"
                        },
                        {
                            "type": "stat",
                            "stat": "current_d20_hit_dice"
                        }
                    ]
                }
            }
        },
        {
            "id": "description",
            "name": "Description",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "concat",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "race.selected_subrace?.name"
                            },
                            "default_components": {
                                "type": "stat",
                                "stat": "race.name"
                            }
                        },
                        {
                            "type": "constant",
                            "value": " ",
                            "value_type": "string" 
                        },
                        {
                            "type": "joinToString",
                            "separator": " / ",
                            "components": {
                                "type": "map",
                                "map_value_key": "$class",
                                "components": {
                                    "type": "stat",
                                    "stat": "classes"
                                },
                                "mapper": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$class.class.name"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$class.class_level"
                                            }
                                        ]
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "classes",
            "name": "Classes",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "class_details",
            "default_value": []
        },
        {
            "id": "background",
            "name": "Background",
            "type": "base",
            "value_type": "resource",
            "resource_type": "background",
            "default_value": null
        },
        {
            "id": "race",
            "name": "Race",
            "type": "base",
            "value_type": "resource",
            "resource_type": "race",
            "default_value": null
        },
        {
            "id": "subrace_id",
            "name": "Subrace ID",
            "type": "base",
            "value_type": "string",
            "default_value": null
        },
        {
            "id": "racial_traits",
            "name": "Racial traits",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "sortBy",
                "order": "asc",
                "components": {
                    "type": "filter",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "race.traits"
                            },
                            {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "race.selected_subrace?.traits"
                                },
                                "default_components": {
                                    "type": "list",
                                    "components": []
                                }
                            }
                        ]
                    },
                    "filter": {
                        "type": "lessThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "$filterValue.min_level"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                },
                "sort_by_selector": {
                    "type": "stat",
                    "stat": "$sortByValue.min_level"
                }
            }
        },
        {
            "id": "advantages",
            "name": "Advantages",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "string",
            "default_value": []
        },
        {
            "id": "disadvantages",
            "name": "Disadvantages",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "string",
            "default_value": []
        },
        {
            "id": "is_not_wearing_inproficient_armor",
            "name": "Character is not currently wear a piece of armor its not proficient with",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "or",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "isNull",
                            "components": {
                                "type": "stat",
                                "stat": "equipped_armor"
                            }
                        },
                        {
                            "type": "contains",
                            "haystack": {
                                "type": "stat",
                                "stat": "armor_proficiencies"
                            },
                            "needle": {
                                "type": "stat",
                                "stat": "equipped_armor?.type"
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "armor_disadvantages",
            "name": "Armor disadvantages",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "stat",
                            "stat": "is_not_wearing_inproficient_armor"
                        },
                        "components": {
                            "type": "list",
                            "components": []
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "strength_modifier",
                                    "value_type": "string"
                                },
                                {
                                    "type": "constant",
                                    "value": "dexterity_modifier",
                                    "value_type": "string"
                                },
                                {
                                    "type": "constant",
                                    "value": "strength_saving_throw",
                                    "value_type": "string"
                                },
                                {
                                    "type": "constant",
                                    "value": "dexterity_saving_throw",
                                    "value_type": "string"
                                },
                                {
                                    "type": "constant",
                                    "value": "athletics",
                                    "value_type": "string"
                                },
                                {
                                    "type": "constant",
                                    "value": "acrobatics",
                                    "value_type": "string"
                                },
                                {
                                    "type": "constant",
                                    "value": "sleight_of_hand",
                                    "value_type": "string"
                                },
                                {
                                    "type": "constant",
                                    "value": "stealth",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                ]
            }
        },
        {
            "id": "equipped_armor_imposes_stealth_disadvantage",
            "name": "Equipped armor imposes stealth disadvantage",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "defaultIfNull",
                "components": {
                    "type": "stat",
                    "stat": "equipped_armor?.impose_stealth_disadvantage"
                },
                "default_components": {
                    "type": "constant",
                    "value": false,
                    "value_type": "bool"
                }
            }
        },
        {
            "id": "all_disadvantages",
            "name": "Disadvantages",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "string",
            "components": {
                "type": "flatAppend",
                "treat_as_set": true,
                "components": [
                    {
                        "type": "stat",
                        "stat": "disadvantages"
                    },
                    {
                        "type": "stat",
                        "stat": "armor_disadvantages"
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "equipped_armor_imposes_stealth_disadvantage"
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": "stealth",
                                            "value_type": "string"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "list",
                                    "components": []
                                }
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "language_proficiencies",
            "name": "Language proficiencies",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "string",
            "default_value": []
        },
        {
            "id": "armor_proficiencies",
            "name": "Armor proficiencies",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "string",
            "default_value": []
        },
        {
            "id": "weapon_proficiencies",
            "name": "Weapon proficiencies",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "string",
            "default_value": []
        },
        {
            "id": "tool_proficiencies",
            "name": "Tool proficiencies",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "string",
            "default_value": []
        },
        {
            "id": "acrobatics_proficiency",
            "name": "Acrobatics proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "acrobatics",
            "name": "Acrobatics",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "dexterity_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "acrobatics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "acrobatics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "acrobatics_formatted",
            "name": "Acrobatics formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "acrobatics"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "acrobatics"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "acrobatics"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "acrobatics_color",
            "name": "Acrobatics number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "acrobatics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "acrobatics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "acrobatics_label_color",
            "name": "Acrobatics label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "acrobatics_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "animal_handling_proficiency",
            "name": "Animal Handling proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "animal_handling",
            "name": "Animal Handling",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "wisdom_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "animal_handling_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "animal_handling_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "animal_handling_formatted",
            "name": "Animal Handling formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "animal_handling"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "animal_handling"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "animal_handling"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "animal_handling_color",
            "name": "Animal Handling number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "animal_handling_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "animal_handling_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "animal_handling_label_color",
            "name": "Animal Handling label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "animal_handling_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "arcana_proficiency",
            "name": "Arcana proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "arcana",
            "name": "Arcana",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "intelligence_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "arcana_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "arcana_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "arcana_formatted",
            "name": "Arcana formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "arcana"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "arcana"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "arcana"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "arcana_color",
            "name": "Arcana number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "arcana_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "arcana_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "arcana_label_color",
            "name": "Arcana label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "arcana_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "athletics_proficiency",
            "name": "Athletics proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "athletics",
            "name": "Athletics",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "strength_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "athletics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "athletics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "athletics_formatted",
            "name": "Athletics formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "athletics"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "athletics"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "athletics"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "athletics_color",
            "name": "Athletics number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "athletics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "athletics_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "athletics_label_color",
            "name": "Athletics label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "athletics_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "deception_proficiency",
            "name": "Deception proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "deception",
            "name": "Deception",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "charisma_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "deception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "deception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "deception_formatted",
            "name": "Deception formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "deception"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "deception"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "deception"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "deception_color",
            "name": "Deception number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "deception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "deception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "deception_label_color",
            "name": "Deception label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "deception_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "history_proficiency",
            "name": "History proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "history",
            "name": "History",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "intelligence_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "history_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "history_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "history_formatted",
            "name": "History formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "history"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "history"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "history"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "history_color",
            "name": "History number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "history_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "history_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "history_label_color",
            "name": "History label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "history_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "insight_proficiency",
            "name": "Insight proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "insight",
            "name": "Insight",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "wisdom_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "insight_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "insight_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "insight_formatted",
            "name": "Insight formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "insight"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "insight"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "insight"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "insight_color",
            "name": "Insight number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "insight_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "insight_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "insight_label_color",
            "name": "Insight label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "insight_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "intimidation_proficiency",
            "name": "Intimidation proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "intimidation",
            "name": "Intimidation",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "charisma_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "intimidation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "intimidation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "intimidation_formatted",
            "name": "Intimidation formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "intimidation"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "intimidation"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "intimidation"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "intimidation_color",
            "name": "Intimidation number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "intimidation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "intimidation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "intimidation_label_color",
            "name": "Intimidation label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "intimidation_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "investigation_proficiency",
            "name": "Investigation proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "investigation",
            "name": "Investigation",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "intelligence_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "investigation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "investigation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "investigation_formatted",
            "name": "Investigation formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "investigation"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "investigation"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "investigation"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "investigation_color",
            "name": "Investigation number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "investigation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "investigation_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "investigation_label_color",
            "name": "Investigation label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "investigation_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "medicine_proficiency",
            "name": "Medicine proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "medicine",
            "name": "Medicine",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "wisdom_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "medicine_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "medicine_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "medicine_formatted",
            "name": "Medicine formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "medicine"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "medicine"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "medicine"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "medicine_color",
            "name": "Medicine number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "medicine_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "medicine_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "medicine_label_color",
            "name": "Medicine label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "medicine_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "nature_proficiency",
            "name": "Nature proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "nature",
            "name": "Nature",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "intelligence_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "nature_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "nature_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "nature_formatted",
            "name": "Nature formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "nature"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "nature"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "nature"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "nature_color",
            "name": "Nature number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "nature_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "nature_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "nature_label_color",
            "name": "Nature label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "nature_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "perception_proficiency",
            "name": "Perception proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "perception",
            "name": "Perception",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "wisdom_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "perception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "perception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "perception_formatted",
            "name": "Perception formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "perception"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "perception"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "perception"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "perception_color",
            "name": "Perception number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "perception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "perception_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "perception_label_color",
            "name": "Perception label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "perception_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "performance_proficiency",
            "name": "Performance proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "performance",
            "name": "Performance",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "charisma_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "performance_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "performance_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "performance_formatted",
            "name": "Performance formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "performance"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "performance"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "performance"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "performance_color",
            "name": "Performance number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "performance_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "performance_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "performance_label_color",
            "name": "Performance label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "performance_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "persuasion_proficiency",
            "name": "Persuasion proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "persuasion",
            "name": "Persuasion",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "charisma_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "persuasion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "persuasion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "persuasion_formatted",
            "name": "Persuasion formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "persuasion"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "persuasion"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "persuasion"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "persuasion_color",
            "name": "Persuasion number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "persuasion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "persuasion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "persuasion_label_color",
            "name": "Persuasion label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "persuasion_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "religion_proficiency",
            "name": "Religion proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "religion",
            "name": "Religion",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "intelligence_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "religion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "religion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "religion_formatted",
            "name": "Religion formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "religion"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "religion"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "religion"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "religion_color",
            "name": "Religion number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "religion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "religion_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "religion_label_color",
            "name": "Religion label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "religion_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "sleight_of_hand_proficiency",
            "name": "Sleight of Hand proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "sleight_of_hand",
            "name": "Sleight of Hand",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "dexterity_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "sleight_of_hand_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "sleight_of_hand_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "sleight_of_hand_formatted",
            "name": "Sleight of Hand formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "sleight_of_hand"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "sleight_of_hand"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "sleight_of_hand"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "sleight_of_hand_color",
            "name": "Sleight of Hand number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "sleight_of_hand_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "sleight_of_hand_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "sleight_of_hand_label_color",
            "name": "Sleight of Hand label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "sleight_of_hand_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "stealth_proficiency",
            "name": "Stealth proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "stealth",
            "name": "Stealth",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "dexterity_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "stealth_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "stealth_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "stealth_formatted",
            "name": "Stealth formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "stealth"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "stealth"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "stealth"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "stealth_color",
            "name": "Stealth number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "stealth_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "stealth_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "stealth_label_color",
            "name": "Stealth label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "stealth_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "survival_proficiency",
            "name": "Survival proficiency (none, proficient, expert)",
            "type": "base",
            "value_type": "string",
            "default_value": "none"
        },
        {
            "id": "survival",
            "name": "Survival",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "wisdom_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "survival_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "survival_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "multiply",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "has_jack_of_all_trades"
                                    },
                                    "components": {
                                        "type": "divide",
                                        "rounding_method": "down",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "proficiency_bonus"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "survival_formatted",
            "name": "Survival formatted",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "survival"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "survival"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "survival"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "survival_color",
            "name": "Survival number color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "survival_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "proficient",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "survival_proficiency"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "expert",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "text",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "survival_label_color",
            "name": "Survival label color",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "survival_proficiency"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "expert",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "accent",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "hint",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "sort_skills_by_name",
            "name": "Should sort skills by name",
            "type": "base",
            "value_type": "bool",
            "default_value": true
        },
        {
            "id": "equipped_armor_id",
            "name": "Equipped armor ID",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "equipped_shield_id",
            "name": "Equipped shield ID",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "speed",
            "name": "Speed",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "race.current_speed"
                        },
                        {
                            "type": "stat",
                            "stat": "worn_armor_speed_modifier"
                        }
                    ]
                }
            }
        },
        {
            "id": "burrow_speed",
            "name": "Burrow speed",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "race.current_burrow_speed"
                        },
                        {
                            "type": "stat",
                            "stat": "worn_armor_speed_modifier"
                        }
                    ]
                }
            }
        },
        {
            "id": "climb_speed",
            "name": "Climb speed",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "race.current_climb_speed"
                        },
                        {
                            "type": "stat",
                            "stat": "worn_armor_speed_modifier"
                        }
                    ]
                }
            }
        },
        {
            "id": "fly_speed",
            "name": "Fly speed",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "race.current_fly_speed"
                        },
                        {
                            "type": "stat",
                            "stat": "worn_armor_speed_modifier"
                        }
                    ]
                }
            }
        },
        {
            "id": "swim_speed",
            "name": "Swim speed",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "race.current_swim_speed"
                        },
                        {
                            "type": "stat",
                            "stat": "worn_armor_speed_modifier"
                        }
                    ]
                }
            }
        },
        {
            "id": "worn_armor_speed_modifier",
            "name": "Worn armor speed modifier (penalty)",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "notEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "equipped_armor"
                                    },
                                    {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "greaterThanEquals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "strength_score"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "equipped_armor.required_strength"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": -10,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 0,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "level",
            "name": "Level",
            "abbreviation": "Lvl.",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class_level"
                    }
                }
            }
        },
        {
            "id": "armor_class",
            "name": "Armor Class",
            "abbreviation": "AC",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "equipped_armor_ac"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "classes_ac"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "race_ac"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "contains",
                                        "haystack": {
                                            "type": "map",
                                            "components": {
                                                "type": "stat",
                                                "stat": "armors"
                                            },
                                            "mapper": {
                                                "type": "stat",
                                                "stat": "$mapValue.id"
                                            }
                                        },
                                        "needle": {
                                            "type": "stat",
                                            "stat": "equipped_shield_id"
                                        }
                                    },
                                    "components": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "contains",
                                                    "haystack": {
                                                        "type": "stat",
                                                        "stat": "armor_proficiencies"
                                                    },
                                                    "needle": {
                                                        "type": "stat",
                                                        "stat": "equipped_shield?.type"
                                                    }
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "base_ac",
                                                    "for_resource": {
                                                        "type": "stat",
                                                        "stat": "equipped_shield"
                                                    }
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "race_ac",
            "name": "Race AC",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "race.actual_base_ac"
                        },
                        {
                            "type": "add",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "stat",
                                    "stat": "race.actual_ac_modifiers"
                                },
                                "mapper": {
                                    "type": "metaStat",
                                    "potential_stat_values": [
                                        "strength_modifier",
                                        "dexterity_modifier",
                                        "constitution_modifier",
                                        "intelligence_modifier",
                                        "wisdom_modifier",
                                        "charisma_modifier"
                                    ],
                                    "meta_stat": {
                                        "type": "concat",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$mapValue"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "_modifier",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "classes_ac",
            "name": "Classes AC",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "max",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "add",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "$class.class.actual_base_ac"
                                },
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$class.class.actual_ac_modifiers"
                                        },
                                        "mapper": {
                                            "type": "metaStat",
                                            "potential_stat_values": [
                                                "strength_modifier",
                                                "dexterity_modifier",
                                                "constitution_modifier",
                                                "intelligence_modifier",
                                                "wisdom_modifier",
                                                "charisma_modifier"
                                            ],
                                            "meta_stat": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$mapValue"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "_modifier",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            }
        },
        {
            "id": "equipped_armor_ac",
            "name": "Equipped armor AC",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "contains",
                            "haystack": {
                                "type": "map",
                                "components": {
                                    "type": "stat",
                                    "stat": "armors"
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$mapValue.id"
                                }
                            },
                            "needle": {
                                "type": "stat",
                                "stat": "equipped_armor_id"
                            }
                        },
                        "components": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "base_ac",
                                        "for_resource": {
                                            "type": "stat",
                                            "stat": "equipped_armor"
                                        }
                                    },
                                    {
                                        "type": "min",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "notEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "constant",
                                                                            "value": "none",
                                                                            "value_type": "string"
                                                                        },
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "modifier",
                                                                            "for_resource": {
                                                                                "type": "stat",
                                                                                "stat": "equipped_armor"
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "metaStat",
                                                                "potential_stat_values": [
                                                                    "strength_modifier",
                                                                    "dexterity_modifier",
                                                                    "constitution_modifier",
                                                                    "intelligence_modifier",
                                                                    "wisdom_modifier",
                                                                    "charisma_modifier"
                                                                ],
                                                                "meta_stat": {
                                                                    "type": "concat",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "modifier",
                                                                                "for_resource": {
                                                                                    "type": "stat",
                                                                                    "stat": "equipped_armor"
                                                                                }
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": "_modifier",
                                                                                "value_type": "string"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "stat",
                                                                "stat": "has_max_bonus",
                                                                "for_resource": {
                                                                    "type": "stat",
                                                                    "stat": "equipped_armor"
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "max_bonus",
                                                                "for_resource": {
                                                                    "type": "stat",
                                                                    "stat": "equipped_armor"
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 10000,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 0,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "equipped_armor",
            "name": "Equipped armor",
            "type": "calculated",
            "value_type": "resource",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "stat",
                    "stat": "armors"
                },
                "filter": {
                    "type": "equals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$findFirstValue.id"
                            },
                            {
                                "type": "stat",
                                "stat": "equipped_armor_id"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "equipped_shield",
            "name": "Equipped shield",
            "type": "calculated",
            "value_type": "resource",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "stat",
                    "stat": "armors"
                },
                "filter": {
                    "type": "equals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$findFirstValue.id"
                            },
                            {
                                "type": "stat",
                                "stat": "equipped_shield_id"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "passive_perception",
            "name": "Passive perception",
            "abbreviation": "PP",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": 10,
                            "value_type": "integer"
                        },
                        {
                            "type": "stat",
                            "stat": "perception"
                        }
                    ]
                }
            }
        },
        {
            "id": "initiative",
            "name": "Initiative",
            "abbreviation": "Ini.",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "stat",
                "stat": "dexterity_modifier"
            }
        },
        {
            "id": "proficiency_bonus",
            "name": "Proficiency Bonus",
            "abbreviation": "PB",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": 1,
                            "value_type": "integer"
                        },
                        {
                            "type": "divide",
                            "rounding_method": "up",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 4,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "display_proficiency_bonus",
            "name": "Display proficiency bonus",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "+",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "strength_score",
            "name": "Strength",
            "abbreviation": "STR",
            "type": "base",
            "value_type": "integer",
            "default_value": 8
        },
        {
            "id": "dexterity_score",
            "name": "Dexterity",
            "abbreviation": "DEX",
            "type": "base",
            "value_type": "integer",
            "default_value": 8
        },
        {
            "id": "constitution_score",
            "name": "Constitution",
            "abbreviation": "CON",
            "type": "base",
            "value_type": "integer",
            "default_value": 8
        },
        {
            "id": "intelligence_score",
            "name": "Intelligence",
            "abbreviation": "INT",
            "type": "base",
            "value_type": "integer",
            "default_value": 8
        },
        {
            "id": "wisdom_score",
            "name": "Wisdom",
            "abbreviation": "WIS",
            "type": "base",
            "value_type": "integer",
            "default_value": 8
        },
        {
            "id": "charisma_score",
            "name": "Charisma",
            "abbreviation": "CHA",
            "type": "base",
            "value_type": "integer",
            "default_value": 8
        },
        {
            "id": "strength_modifier",
            "name": "Strength",
            "abbreviation": "STR",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "divide",
                "rounding_method": "down",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "strength_score"
                                    },
                                    {
                                        "type": "constant",
                                        "value": -10,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "constant",
                            "value": 2,
                            "value_type": "integer"
                        }
                    ]
                }
            }
        },
        {
            "id": "dexterity_modifier",
            "name": "Dexterity",
            "abbreviation": "DEX",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "divide",
                "rounding_method": "down",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "dexterity_score"
                                    },
                                    {
                                        "type": "constant",
                                        "value": -10,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "constant",
                            "value": 2,
                            "value_type": "integer"
                        }
                    ]
                }
            }
        },
        {
            "id": "constitution_modifier",
            "name": "Constitution",
            "abbreviation": "CON",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "divide",
                "rounding_method": "down",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "constitution_score"
                                    },
                                    {
                                        "type": "constant",
                                        "value": -10,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "constant",
                            "value": 2,
                            "value_type": "integer"
                        }
                    ]
                }
            }
        },
        {
            "id": "intelligence_modifier",
            "name": "Intelligence",
            "abbreviation": "INT",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "divide",
                "rounding_method": "down",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "intelligence_score"
                                    },
                                    {
                                        "type": "constant",
                                        "value": -10,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "constant",
                            "value": 2,
                            "value_type": "integer"
                        }
                    ]
                }
            }
        },
        {
            "id": "wisdom_modifier",
            "name": "Wisdom",
            "abbreviation": "WIS",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "divide",
                "rounding_method": "down",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "wisdom_score"
                                    },
                                    {
                                        "type": "constant",
                                        "value": -10,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "constant",
                            "value": 2,
                            "value_type": "integer"
                        }
                    ]
                }
            }
        },
        {
            "id": "charisma_modifier",
            "name": "Charisma",
            "abbreviation": "CHA",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "divide",
                "rounding_method": "down",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "charisma_score"
                                    },
                                    {
                                        "type": "constant",
                                        "value": -10,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "constant",
                            "value": 2,
                            "value_type": "integer"
                        }
                    ]
                }
            }
        },
        {
            "id": "attacks_per_action",
            "name": "Attacks per action",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "max",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.attacks_per_action"
                    }
                }
            }
        },
        {
            "id": "all_weapons",
            "name": "All weapons (including racial and class weapons)",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "weapon",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.weapons"
                    },
                    {
                        "type": "flatMap",
                        "map_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$class.class.weapons"
                            },
                            "default_components": {
                                "type": "list",
                                "components": []
                            }
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "weapons"
                    }
                ]
            }
        },
        {
            "id": "weapons",
            "name": "Weapons",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "weapon",
            "default_value": []
        },
        {
            "id": "armors",
            "name": "Armors",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "armor",
            "default_value": []
        },
        {
            "id": "equipment",
            "name": "Equipment",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "item",
            "default_value": []
        },
        {
            "id": "sorted_spells",
            "name": "Sorted spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "sortBy",
                "components": {
                    "type": "flatAppend",
                    "treat_as_set": true,
                    "components": [
                        {
                            "type": "map",
                            "components": {
                                "type": "filter",
                                "components": {
                                    "type": "flatAppend",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "race.spells"
                                        },
                                        {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "race.selected_subrace?.spells"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            }
                                        ]
                                    }
                                }
                            },
                            "mapper": {
                                "type": "stat",
                                "stat": "$mapValue.spell"
                            }
                        },
                        {
                            "type": "stat",
                            "stat": "spells"
                        }
                    ]
                },
                "sort_by_selector": {
                    "type": "stat",
                    "stat": "$sortByValue.name"
                }
            }
        },
        {
            "id": "cantrips",
            "name": "Cantrips",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "filter",
                "components": {
                    "type": "stat",
                    "stat": "sorted_spells"
                },
                "filter": {
                    "type": "equals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "constant",
                                "value": "spell_level_0",
                                "value_type": "string"
                            },
                            {
                                "type": "stat",
                                "stat": "$filterValue.level"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "level_1_spells",
            "name": "Level 1 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_1",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_1",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_2_spells",
            "name": "Level 2 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_2",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_2",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_3_spells",
            "name": "Level 3 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_3",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_3",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_4_spells",
            "name": "Level 4 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_4",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_4",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_5_spells",
            "name": "Level 5 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_5",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_5",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_6_spells",
            "name": "Level 6 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_6",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_6",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_7_spells",
            "name": "Level 7 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_7",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_7",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_8_spells",
            "name": "Level 8 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_8",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_8",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "level_9_spells",
            "name": "Level 9 spells",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_9",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.prepared"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_spells"
                        },
                        "filter": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "spell_level_9",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$filterValue.prepared"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "spells",
            "name": "Spells",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "spell",
            "default_value": []
        },
        {
            "id": "max_spell_slots_1_bonus",
            "name": "Max lvl 1 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_2_bonus",
            "name": "Max lvl 2 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_3_bonus",
            "name": "Max lvl 3 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_4_bonus",
            "name": "Max lvl 4 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_5_bonus",
            "name": "Max lvl 5 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_6_bonus",
            "name": "Max lvl 6 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_7_bonus",
            "name": "Max lvl 7 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_8_bonus",
            "name": "Max lvl 8 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "max_spell_slots_9_bonus",
            "name": "Max lvl 9 slots bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_1",
            "name": "1st",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_2",
            "name": "2nd",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_3",
            "name": "3rd",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_4",
            "name": "4th",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_5",
            "name": "5th",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_6",
            "name": "6th",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_7",
            "name": "7th",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_8",
            "name": "8th",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_slots_9",
            "name": "9th",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "str_point_buy_point_worth",
            "name": "Strength point buy point worth",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_str?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 13,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": -8,
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_str?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_character_basics_ability_scores_point_buy_str?"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 14,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": 7,
                            "value_type": "integer"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 9,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "dex_point_buy_point_worth",
            "name": "Dexterity point buy point worth",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_dex?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 13,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": -8,
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_dex?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_character_basics_ability_scores_point_buy_dex?"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 14,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": 7,
                            "value_type": "integer"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 9,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "con_point_buy_point_worth",
            "name": "Constitution point buy point worth",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_con?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 13,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": -8,
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_con?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_character_basics_ability_scores_point_buy_con?"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 14,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": 7,
                            "value_type": "integer"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 9,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "int_point_buy_point_worth",
            "name": "Intelligence point buy point worth",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_int?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 13,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": -8,
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_int?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_character_basics_ability_scores_point_buy_int?"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 14,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": 7,
                            "value_type": "integer"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 9,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "wis_point_buy_point_worth",
            "name": "Wisdom point buy point worth",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_wis?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 13,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": -8,
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_wis?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_character_basics_ability_scores_point_buy_wis?"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 14,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": 7,
                            "value_type": "integer"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 9,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "cha_point_buy_point_worth",
            "name": "Charisma point buy point worth",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_cha?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 13,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": -8,
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.edit_character_basics_ability_scores_point_buy_cha?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 8,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_character_basics_ability_scores_point_buy_cha?"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 14,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": 7,
                            "value_type": "integer"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": 9,
                            "value_type": "integer"
                        }
                    }
                ]
            }
        },
        {
            "id": "remaining_point_buy_points",
            "name": "Remaining point buy points",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "subtract",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": 27,
                            "value_type": "integer"
                        },
                        {
                            "type": "stat",
                            "stat": "str_point_buy_point_worth"
                        },
                        {
                            "type": "stat",
                            "stat": "dex_point_buy_point_worth"
                        },
                        {
                            "type": "stat",
                            "stat": "con_point_buy_point_worth"
                        },
                        {
                            "type": "stat",
                            "stat": "int_point_buy_point_worth"
                        },
                        {
                            "type": "stat",
                            "stat": "wis_point_buy_point_worth"
                        },
                        {
                            "type": "stat",
                            "stat": "cha_point_buy_point_worth"
                        }
                    ]
                }
            }
        },
        {
            "id": "creator_selected_subrace",
            "name": "Selected creator subrace",
            "type": "calculated",
            "value_type": "resource",
            "resource_type": "race",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "defaultIfNull",
                    "components": {
                        "type": "stat",
                        "stat": "$view?.edit_character_basics_race_select?.subraces"
                    },
                    "default_components": {
                        "type": "list",
                        "components": []
                    }
                },
                "filter": {
                    "type": "equals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$findFirstValue.id"
                            },
                            {
                                "type": "stat",
                                "stat": "$view?.edit_character_basics_subrace_select?"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "creator_ability_score_increases",
            "name": "Creator ability score increases",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "ability_score_increase",
            "components": {
                "type": "defaultIfNull",
                "components": {
                    "type": "stat",
                    "stat": "$view?.edit_character_basics_background_select?.ability_score_increases"
                },
                "default_components": {
                    "type": "list",
                    "components": []
                }
            }
        },
        {
            "id": "old_creator_ability_score_increases",
            "name": "Old creator ability score increases",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "ability_score_increase",
            "default_value": []
        },
        {
            "id": "ability_score_mode",
            "name": "Ability score mode",
            "type": "base",
            "value_type": "string",
            "default_value": "custom"
        },
        {
            "id": "creator_language_proficiency_choices",
            "name": "Creator language proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.language_proficiencies_for_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.language_proficiencies_for_current_level"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.language_proficiencies_for_current_level"
                    }
                ]
            }
        },
        {
            "id": "creator_skill_proficiency_choices",
            "name": "Creator skill proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.skill_proficiencies_for_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.skill_proficiencies_for_current_level"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.skill_proficiencies_for_current_level"
                    }
                ]
            }
        },
        {
            "id": "creator_armor_proficiency_choices",
            "name": "Creator armor proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.armor_proficiencies_for_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.armor_proficiencies_for_current_level"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.armor_proficiencies_for_current_level"
                    }
                ]
            }
        },
        {
            "id": "creator_weapon_proficiency_choices",
            "name": "Creator weapon proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.weapon_proficiencies_for_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.weapon_proficiencies_for_current_level"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.weapon_proficiencies_for_current_level"
                    }
                ]
            }
        },
        {
            "id": "creator_tool_proficiency_choices",
            "name": "Creator tool proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.tool_proficiencies_for_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.tool_proficiencies_for_current_level"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.tool_proficiencies_for_current_level"
                    }
                ]
            }
        },
        {
            "id": "creator_starting_equipment_choices",
            "name": "Creator starting equipment choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "selectable_items",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.selectable_equipments"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.selectable_equipments"
                    }
                ]
            }
        },
        {
            "id": "creator_starting_armor_choices",
            "name": "Creator starting armor choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "selectable_armors",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.selectable_armors"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.selectable_armors"
                    }
                ]
            }
        },
        {
            "id": "creator_starting_weapon_choices",
            "name": "Creator starting weapon choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "selectable_weapons",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.selectable_weapons"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.selectable_weapons"
                    }
                ]
            }
        },
        {
            "id": "spell_attack_extra_bonus",
            "name": "Extra spell attack bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "spell_dc_extra_bonus",
            "name": "Extra spell save DC bonus",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "strength_saving_throw_proficiency",
            "name": "Strength",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class.has_strength_saving_throw_proficiency"
                    }
                },
                "filter": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                }
            }
        },
        {
            "id": "strength_saving_throw",
            "name": "Strength",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "strength_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "strength_saving_throw_proficiency"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "dexterity_saving_throw_proficiency",
            "name": "Dexterity",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class.has_dexterity_saving_throw_proficiency"
                    }
                },
                "filter": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                }
            }
        },
        {
            "id": "dexterity_saving_throw",
            "name": "Dexterity",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "dexterity_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "dexterity_saving_throw_proficiency"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "constitution_saving_throw_proficiency",
            "name": "Constitution",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class.has_constitution_saving_throw_proficiency"
                    }
                },
                "filter": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                }
            }
        },
        {
            "id": "constitution_saving_throw",
            "name": "Constitution",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "constitution_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "constitution_saving_throw_proficiency"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "intelligence_saving_throw_proficiency",
            "name": "Intelligence",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class.has_intelligence_saving_throw_proficiency"
                    }
                },
                "filter": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                }
            }
        },
        {
            "id": "intelligence_saving_throw",
            "name": "Intelligence",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "intelligence_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "intelligence_saving_throw_proficiency"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "wisdom_saving_throw_proficiency",
            "name": "Wisdom",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class.has_wisdom_saving_throw_proficiency"
                    }
                },
                "filter": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                }
            }
        },
        {
            "id": "wisdom_saving_throw",
            "name": "Wisdom",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "wisdom_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "wisdom_saving_throw_proficiency"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "charisma_saving_throw_proficiency",
            "name": "Charisma",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "stat",
                        "stat": "$class.class.has_charisma_saving_throw_proficiency"
                    }
                },
                "filter": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                }
            }
        },
        {
            "id": "charisma_saving_throw",
            "name": "Charisma",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "charisma_modifier"
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "charisma_saving_throw_proficiency"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "proficiency_bonus"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "class_hit_dice_formatted",
            "name": "Class hit dice (formatted e.g: 1d10)",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "string",
            "components": {
                "type": "map",
                "map_value_key": "$class",
                "components": {
                    "type": "stat",
                    "stat": "classes"
                },
                "mapper": {
                    "type": "concat",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$class.class_level"
                            },
                            {
                                "type": "stat",
                                "stat": "$class.class.actual_hit_die"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "selected_selectable_feature_ids",
            "name": "Selected selectable feature ids",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "string",
            "default_value": []
        },
        {
            "id": "race_traits",
            "name": "Race traits",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "sortBy",
                "components": {
                    "type": "stat",
                    "stat": "race.current_level_traits"
                },
                "sort_by_selector": {
                    "type": "stat",
                    "stat": "$sortByValue.min_level"
                }
            }
        },
        {
            "id": "background_features",
            "name": "Background features",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "sortBy",
                "components": {
                    "type": "stat",
                    "stat": "background.current_level_features"
                },
                "sort_by_selector": {
                    "type": "stat",
                    "stat": "$sortByValue.min_level"
                }
            }
        },
        {
            "id": "feats",
            "name": "Feats",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "default_value": []
        },
        {
            "id": "selected_selectable_feats",
            "name": "Selected selectable feats",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "flatMap",
                "components": {
                    "type": "stat",
                    "stat": "feats"
                },
                "mapper": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$mapValue.has_selectable_features"
                                    },
                                    "components": {
                                        "type": "filter",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$mapValue.selectable_features"
                                        },
                                        "filter": {
                                            "type": "contains",
                                            "haystack": {
                                                "type": "stat",
                                                "stat": "selected_selectable_feature_ids"
                                            },
                                            "needle": {
                                                "type": "stat",
                                                "stat": "$filterValue.id"
                                            }
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "all_feats",
            "name": "All feats (with selectable features included)",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "flatMap",
                "components": {
                    "type": "stat",
                    "stat": "feats"
                },
                "mapper": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "$mapValue"
                                }
                            ]
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$mapValue.has_selectable_features"
                                    },
                                    "components": {
                                        "type": "filter",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$mapValue.selectable_features"
                                        },
                                        "filter": {
                                            "type": "contains",
                                            "haystack": {
                                                "type": "stat",
                                                "stat": "selected_selectable_feature_ids"
                                            },
                                            "needle": {
                                                "type": "stat",
                                                "stat": "$filterValue.id"
                                            }
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    ]
                }
            }
        },
        {
            "id": "blinded",
            "name": "Blinded",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "charmed",
            "name": "Charmed",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "deafened",
            "name": "Deafened",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "frightened",
            "name": "Frightened",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "grappled",
            "name": "Grappled",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "incapacitated",
            "name": "Incapacitated",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "invisible",
            "name": "Invisible",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "paralyzed",
            "name": "Paralyzed",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "petrified",
            "name": "Petrified",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "poisoned",
            "name": "Poisoned",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "prone",
            "name": "Prone",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "restrained",
            "name": "Restrained",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "stunned",
            "name": "Stunned",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "unconscious",
            "name": "Unconscious",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "exhausted",
            "name": "Exhausted",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "temp_short_rest_hit_dice_d4",
            "name": "d4",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "temp_short_rest_hit_dice_d6",
            "name": "d6",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "temp_short_rest_hit_dice_d8",
            "name": "d8",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "temp_short_rest_hit_dice_d10",
            "name": "d10",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "temp_short_rest_hit_dice_d12",
            "name": "d12",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "temp_short_rest_hit_dice_d20",
            "name": "d20",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "is_single_third_level_caster",
            "name": "Is single third level caster",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "and",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "length",
                                        "components": {
                                            "type": "stat",
                                            "stat": "classes"
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 1,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "findFirst",
                            "components": {
                                "type": "map",
                                "map_value_key": "$class",
                                "components": {
                                    "type": "stat",
                                    "stat": "classes"
                                },
                                "mapper": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$class.class.actual_effective_caster_level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "third",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            },
                            "filter": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "first_third_level_caster_class",
            "name": "First third level caster class",
            "type": "calculated",
            "value_type": "resource",
            "resource_type": "class_details",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "stat",
                            "stat": "is_single_third_level_caster"
                        },
                        "components": {
                            "type": "findFirst",
                            "components": {
                                "type": "stat",
                                "stat": "classes"
                            },
                            "filter": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": null,
                            "value_type": "resource"
                        }
                    }
                ]
            }
        },
        {
            "id": "spellcaster_level",
            "name": "Spellcaster level",
            "type": "calculated",
            "value_type": "integer",
            "components": {
                "type": "add",
                "components": {
                    "type": "map",
                    "map_value_key": "$class",
                    "components": {
                        "type": "stat",
                        "stat": "classes"
                    },
                    "mapper": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$class.class.actual_effective_caster_level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "full",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$class.class_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$class.class.actual_effective_caster_level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "half",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "divide",
                                    "rounding_method": "up",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$class.class_level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 2,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$class.class.actual_effective_caster_level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "third",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "divide",
                                    "rounding_method": "down",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$class.class_level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 3,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 0,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "custom_spell_slot_classes",
            "name": "Custom spell slot classes",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "class_details",
            "components": {
                "type": "filter",
                "filter_value_key": "$class",
                "components": {
                    "type": "stat",
                    "stat": "classes"
                },
                "filter": {
                    "type": "equals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$class.class.actual_effective_caster_level"
                            },
                            {
                                "type": "constant",
                                "value": "custom",
                                "value_type": "string"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "copper_pieces",
            "name": "CP",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "silver_pieces",
            "name": "SP",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "electrum_pieces",
            "name": "EP",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "gold_pieces",
            "name": "GP",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "platinum_pieces",
            "name": "PP",
            "type": "base",
            "value_type": "integer",
            "default_value": 0
        },
        {
            "id": "death_saving_throws_success_1",
            "name": "Death saving throw success 1",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "death_saving_throws_success_2",
            "name": "Death saving throw success 2",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "death_saving_throws_success_3",
            "name": "Death saving throw success 3",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "death_saving_throws_failure_1",
            "name": "Death saving throw failure 1",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "death_saving_throws_failure_2",
            "name": "Death saving throw failure 2",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "death_saving_throws_failure_3",
            "name": "Death saving throw failure 3",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "level_up_selected_class_details",
            "name": "Selected existing class when levelling up",
            "type": "calculated",
            "value_type": "resource",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "stat",
                    "stat": "classes"
                },
                "filter": {
                    "type": "equals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$findFirstValue.class.id"
                            },
                            {
                                "type": "stat",
                                "stat": "$view?.level_up_select_class?"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "level_up_available_archetypes",
            "name": "Available archetypes for level up",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "class",
            "components": {
                "type": "defaultIfNull",
                "components": {
                    "type": "stat",
                    "stat": "level_up_selected_class_details?.class.archetypes?"
                },
                "default_components": {
                    "type": "list",
                    "components": []
                }
            }
        },
        {
            "id": "level_up_has_to_select_archetype",
            "name": "Has to select an archetype when levelling up for the current selected class",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "and",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "level_up_available_archetypes"
                                }
                            }
                        },
                        {
                            "type": "isNull",
                            "components": {
                                "type": "stat",
                                "stat": "level_up_selected_class_details?.archetype_id"
                            }
                        },
                        {
                            "type": "greaterThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "level_up_selected_class_details?.class_level"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": 0,
                                                        "value_type": "integer"
                                                    }
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "level_up_selected_class_details?.class.archetype_selection_level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 0,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "temp_level_up_class",
            "name": "Temporary variable for selecting among existing classes",
            "type": "base",
            "value_type": "string",
            "default_value": null
        },
        {
            "id": "temp_level_up_archetype",
            "name": "Temporary variable for selecting an archetype for an existing class",
            "type": "base",
            "value_type": "string",
            "default_value": null
        },
        {
            "id": "temp_level_up_multiclass",
            "name": "Temporary variable for selecting to multiclass",
            "type": "base",
            "value_type": "bool",
            "default_value": null
        },
        {
            "id": "temp_level_up_new_class",
            "name": "Temporary variable for levelling up into a new class",
            "type": "base",
            "value_type": "resource",
            "resource_type": "class_details",
            "default_value": null
        },
        {
            "id": "level_up_language_proficiency_choices",
            "name": "Level up language proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.language_proficiencies_choices_in_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$mapValue.should_select_on_level_up"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.class.language_proficiencies_choices_in_current_level"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.language_proficiencies_choices_in_current_level"
                    }
                ]
            }
        },
        {
            "id": "level_up_skill_proficiency_choices",
            "name": "Level up skill proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.skill_proficiencies_choices_in_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$mapValue.should_select_on_level_up"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.class.skill_proficiencies_choices_in_current_level"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.skill_proficiencies_choices_in_current_level"
                    }
                ]
            }
        },
        {
            "id": "level_up_armor_proficiency_choices",
            "name": "Level up armor proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.armor_proficiencies_choices_in_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$mapValue.should_select_on_level_up"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.class.armor_proficiencies_choices_in_current_level"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.armor_proficiencies_choices_in_current_level"
                    }
                ]
            }
        },
        {
            "id": "level_up_weapon_proficiency_choices",
            "name": "Level up weapon proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.weapon_proficiencies_choices_in_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$mapValue.should_select_on_level_up"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.class.weapon_proficiencies_choices_in_current_level"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.weapon_proficiencies_choices_in_current_level"
                    }
                ]
            }
        },
        {
            "id": "level_up_tool_proficiency_choices",
            "name": "Level up tool proficiency choices",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "levelled_choice_text",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.tool_proficiencies_choices_in_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$mapValue.should_select_on_level_up"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.class.tool_proficiencies_choices_in_current_level"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.tool_proficiencies_choices_in_current_level"
                    }
                ]
            }
        },
        {
            "id": "temp_last_level_up_class_id",
            "name": "Last level up class ID",
            "type": "base",
            "value_type": "string",
            "default_value": null
        },
        {
            "id": "last_level_up_class_details",
            "name": "Last level up class",
            "type": "calculated",
            "value_type": "resource",
            "components": {
                "type": "findFirst",
                "components": {
                    "type": "stat",
                    "stat": "classes"
                },
                "filter": {
                    "type": "equals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$findFirstValue.class.id"
                            },
                            {
                                "type": "stat",
                                "stat": "temp_last_level_up_class_id"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "should_show_asi",
            "name": "Should show ASI",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "or",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "last_level_up_class_details?.class_level"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 4,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "last_level_up_class_details?.class_level"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 8,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "last_level_up_class_details?.class_level"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 12,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "last_level_up_class_details?.class_level"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 16,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "last_level_up_class_details?.class_level"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 19,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "contains",
                                        "haystack": {
                                            "type": "toLowerCase",
                                            "components": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "last_level_up_class_details?.class.name"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": "",
                                                    "value_type": "string"
                                                }
                                            }
                                        },
                                        "needle": {
                                            "type": "constant",
                                            "value": "rogue",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "last_level_up_class_details?.class_level"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 10,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "contains",
                                        "haystack": {
                                            "type": "toLowerCase",
                                            "components": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "last_level_up_class_details?.class.name"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": "",
                                                    "value_type": "string"
                                                }
                                            }
                                        },
                                        "needle": {
                                            "type": "constant",
                                            "value": "fighter",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "type": "or",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "last_level_up_class_details?.class_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 6,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "last_level_up_class_details?.class_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 14,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "temp_asi_selection_1",
            "name": "Temp ASI selection",
            "type": "base",
            "value_type": "string",
            "default_value": null
        },
        {
            "id": "temp_asi_selection_2",
            "name": "Temp ASI selection",
            "type": "base",
            "value_type": "string",
            "default_value": null
        },
        {
            "id": "temp_asi_choose_feat",
            "name": "Temp choose feat",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "temp_asi_feat_selection",
            "name": "Temp feat selection",
            "type": "base",
            "value_type": "resource",
            "resource_type": "feat",
            "default_value": null
        },
        {
            "id": "features_with_new_descriptions_in_new_level",
            "name": "Features with new descriptions in new level",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "race.traits_with_updates_in_current_level"
                    },
                    {
                        "type": "flatMap",
                        "components": {
                            "type": "filter",
                            "components": {
                                "type": "stat",
                                "stat": "classes"
                            },
                            "filter": {
                                "type": "equals",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "last_level_up_class_details?.class.id"
                                        },
                                        {
                                            "type": "stat",
                                            "stat": "$filterValue.class.id"
                                        }
                                    ]
                                }
                            }
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.class.features_with_updates_in_current_level"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "background.features_with_updates_in_current_level"
                    }
                ]
            }
        },
        {
            "id": "currently_levelling_up",
            "name": "Currently levelling up",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "selectable_features_with_new_amounts_in_new_level",
            "name": "Selectable features with new amounts in the new level",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "filter",
                "components": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "race.current_level_traits"
                        },
                        {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "last_level_up_class_details?.class.current_level_features"
                            },
                            "default_components": {
                                "type": "list",
                                "components": []
                            }
                        },
                        {
                            "type": "stat",
                            "stat": "background.current_level_features"
                        }
                    ]
                },
                "filter": {
                    "type": "stat",
                    "stat": "$filterValue.can_choose_new_selectable_features_in_current_level"
                }
            }
        },
        {
            "id": "hair_color",
            "name": "Hair color",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "eye_color",
            "name": "Eye color",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "outfit",
            "name": "Outfit",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "appearance_weapon",
            "name": "Appearance weapon",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "sex",
            "name": "Sex",
            "type": "base",
            "value_type": "string",
            "default_value": ""
        },
        {
            "id": "photo_prompt",
            "name": "Photo prompt",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "joinToString",
                "separator": ",",
                "components": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "race.actual_hair_color_selectable"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "(",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "hair_color"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ":1.6)",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "race.actual_eye_color_selectable"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "(",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "eye_color"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ":1.3)",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "race.actual_outfit_selectable"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "(",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "outfit"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ":1.3)",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "race.actual_appearance_weapon_selectable"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "(",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "appearance_weapon"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ":1.6)",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "race.actual_sex_selectable"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "(",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "sex"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ":1.3)",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        {
                            "type": "map",
                            "components": {
                                "type": "stat",
                                "stat": "race.actual_visual_traits"
                            },
                            "mapper": {
                                "type": "concat",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": "(",
                                            "value_type": "string"
                                        },
                                        {
                                            "type": "stat",
                                            "stat": "$mapValue.selected_option"
                                        },
                                        {
                                            "type": "constant",
                                            "value": ":1.",
                                            "value_type": "string"
                                        },
                                        {
                                            "type": "stat",
                                            "stat": "$mapValue.importance"
                                        },
                                        {
                                            "type": "constant",
                                            "value": ")",
                                            "value_type": "string"
                                        }
                                    ]
                                }
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "attuned_armors",
            "name": "Attuned armors",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "mixed",
            "components": {
                "type": "filter",
                "components": {
                    "type": "stat",
                    "stat": "armors"
                },
                "filter": {
                    "type": "and",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$filterValue.requires_attunement"
                            },
                            {
                                "type": "stat",
                                "stat": "$filterValue.is_attuned"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "attuned_weapons",
            "name": "Attuned weapons",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "mixed",
            "components": {
                "type": "filter",
                "components": {
                    "type": "stat",
                    "stat": "all_weapons"
                },
                "filter": {
                    "type": "and",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$filterValue.requires_attunement"
                            },
                            {
                                "type": "stat",
                                "stat": "$filterValue.is_attuned"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "attuned_items",
            "name": "Attuned items",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "mixed",
            "components": {
                "type": "filter",
                "components": {
                    "type": "stat",
                    "stat": "equipment"
                },
                "filter": {
                    "type": "and",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "$filterValue.requires_attunement"
                            },
                            {
                                "type": "stat",
                                "stat": "$filterValue.is_attuned"
                            }
                        ]
                    }
                }
            }
        },
        {
            "id": "attuned_resources",
            "name": "Attuned resources",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "mixed",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "stat",
                        "stat": "attuned_armors"
                    },
                    {
                        "type": "stat",
                        "stat": "attuned_weapons"
                    },
                    {
                        "type": "stat",
                        "stat": "attuned_items"
                    }
                ]
            }
        },
        {
            "id": "attuned_resources_count_message",
            "name": "Attuned resources count message",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "concat",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": "Attuned to ",
                            "value_type": "string"
                        },
                        {
                            "type": "length",
                            "components": {
                                "type": "stat",
                                "stat": "attuned_resources"
                            }
                        },
                        {
                            "type": "constant",
                            "value": " / 3 items",
                            "value_type": "string"
                        }
                    ]
                }
            }
        },
        {
            "id": "selecting",
            "name": "Player is selecting things for this character",
            "type": "base",
            "value_type": "bool",
            "default_value": false
        },
        {
            "id": "should_show_controls_for_choices",
            "name": "Should show controls for choices (for race, background, etc choices like equipments or proficiencies)",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "or",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "stat",
                            "stat": "selecting"
                        },
                        {
                            "type": "stat",
                            "stat": "currently_levelling_up"
                        }
                    ]
                }
            }
        },
        {
            "id": "all_features",
            "name": "All features",
            "type": "calculated",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "feat",
            "components": {
                "type": "flatAppend",
                "components": [
                    {
                        "type": "flatMap",
                        "map_value_key": "$class",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$class.features"
                        }
                    },
                    {
                        "type": "stat",
                        "stat": "all_feats"
                    },
                    {
                        "type": "stat",
                        "stat": "race_traits"
                    },
                    {
                        "type": "stat",
                        "stat": "background_features"
                    }
                ]
            }
        },
        {
            "id": "has_jack_of_all_trades",
            "name": "Has jack of all trades",
            "type": "calculated",
            "value_type": "bool",
            "components": {
                "type": "or",
                "components": {
                    "type": "map",
                    "components": {
                        "type": "stat",
                        "stat": "all_features"
                    },
                    "mapper": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "toLowerCase",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.name"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": "jack of all trades",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                }
            }
        },
        {
            "id": "is_new_and_should_long_rest",
            "name": "Is new and should long rest?",
            "type": "base",
            "value_type": "bool",
            "default_value": true
        },
        {
            "id": "companions",
            "name": "Companions",
            "type": "base",
            "value_type": "array",
            "sub_value_type": "resource",
            "resource_type": "companion",
            "default_value": []
        },
        {
            "id": "companion_section_title",
            "name": "Companion section title",
            "type": "calculated",
            "value_type": "string",
            "components": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "contains",
                            "haystack": {
                                "type": "map",
                                "components": {
                                    "type": "stat",
                                    "stat": "classes"
                                },
                                "mapper": {
                                    "type": "toLowerCase",
                                    "components": {
                                        "type": "trim",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$mapValue.class.name"
                                        }
                                    }
                                }
                            },
                            "needle": {
                                "type": "constant",
                                "value": "druid",
                                "value_type": "string"
                            }
                        },
                        "components": {
                            "type": "constant",
                            "value": "Wild shape",
                            "value_type": "string"
                        }
                    },
                    {
                        "condition": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "components": {
                            "type": "constant",
                            "value": "Companions / familiars",
                            "value_type": "string"
                        }
                    }
                ]
            }
        }
    ],
    "character_indexed_stats": [
        "name", "created_at_display", "description"
    ],
    "character_search_item_view": {
        "id": "character_list_item",
        "type": "composite",
        "row_only": true,
        "margin_top": 16,
        "margin_bottom": 16,
        "margin_left": 16,
        "margin_right": 16,
        "subviews": [
            {
                "id": "character_list_item_avatar",
                "type": "avatar",
                "name_stat": "name",
                "photo_stat": "photo",
                "size": "medium",
                "margin_right": 16
            },
            {
                "id": "character_list_item_texts",
                "type": "list",
                "alignment": "start",
                "subviews": [
                    {
                        "id": "character_list_item_name",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "name"
                        },
                        "style": "subhead"
                    },
                    {
                        "id": "character_list_item_name",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text"
                    },
                    {
                        "id": "character_list_item_name",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "created_at_display"
                        },
                        "style": "caption"
                    }
                ]
            }
        ]
    },
    "character_creation_flow": [
        {
            "title": {
                "id": "edit_basics_title",
                "name": "Character basics"
            },
            "view": {
                "id": "edit_character_basics",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "edit_character_basics_subheader",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "What's your name, race and classes?",
                            "value_type": "string"
                        },
                        "style": "subhead"
                    },
                    {
                        "id": "edit_character_basics_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "title",
                        "max_length": 80,
                        "label": {
                            "type": "constant",
                            "value": "Character name",
                            "value_type": "string"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.edit_character_basics_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please make sure to provide a name for your character!",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "edit_character_basics_class_subheader",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "What's your class?",
                            "value_type": "string"
                        },
                        "style": "subhead"
                    },
                    {
                        "id": "edit_character_basics_classes",
                        "type": "resourceArray",
                        "resource_id": "class_details",
                        "stat": "classes",
                        "view_type": "edit",
                        "auto_add_first": true,
                        "left_view": {
                            "id": "edit_character_basics_classes_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Classes: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.edit_character_basics_classes"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please pick at least one class",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "and",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$is_new"
                                                    }
                                                },
                                                {
                                                    "type": "or",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "greaterThan",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "length",
                                                                            "components": {
                                                                                "type": "stat",
                                                                                "stat": "$view.edit_character_basics_classes"
                                                                            }
                                                                        },
                                                                        {
                                                                            "type": "length",
                                                                            "components": {
                                                                                "type": "stat",
                                                                                "stat": "classes"
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            {
                                                                "type": "and",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "notEquals",
                                                                            "components": {
                                                                                "type": "list",
                                                                                "components": [
                                                                                    {
                                                                                        "type": "constant",
                                                                                        "value": 1,
                                                                                        "value_type": "integer"
                                                                                    },
                                                                                    {
                                                                                        "type": "length",
                                                                                        "components": {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.edit_character_basics_classes"
                                                                                        }
                                                                                    }
                                                                                ]
                                                                            }
                                                                        },
                                                                        {
                                                                            "type": "or",
                                                                            "components": {
                                                                                "type": "map",
                                                                                "components": {
                                                                                    "type": "stat",
                                                                                    "stat": "$view.edit_character_basics_classes"
                                                                                },
                                                                                "map_value_key": "$class",
                                                                                "mapper": {
                                                                                    "type": "equals",
                                                                                    "components": {
                                                                                        "type": "list",
                                                                                        "components": [
                                                                                            {
                                                                                                "type": "length",
                                                                                                "components": {
                                                                                                    "type": "filter",
                                                                                                    "components": {
                                                                                                        "type": "stat",
                                                                                                        "stat": "classes"
                                                                                                    },
                                                                                                    "filter": {
                                                                                                        "type": "equals",
                                                                                                        "components": {
                                                                                                            "type": "list",
                                                                                                            "components": [
                                                                                                                {
                                                                                                                    "type": "stat",
                                                                                                                    "stat": "$class.$view.class_details_edit_class_select.name"
                                                                                                                },
                                                                                                                {
                                                                                                                    "type": "stat",
                                                                                                                    "stat": "$filterValue.class.name"
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    }
                                                                                                }
                                                                                            },
                                                                                            {
                                                                                                "type": "constant",
                                                                                                "value": 0,
                                                                                                "value_type": "integer"
                                                                                            }
                                                                                        ]
                                                                                    }
                                                                                }
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "To multiclass, please use the EXP / LEVEL UP button at the top-center of the character sheet.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "or",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$view.edit_character_basics_classes"
                                            },
                                            "map_value_key": "$class",
                                            "mapper": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "length",
                                                            "components": {
                                                                "type": "filter",
                                                                "components": {
                                                                    "type": "stat",
                                                                    "stat": "$view.edit_character_basics_classes"
                                                                },
                                                                "filter": {
                                                                    "type": "equals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.$view.class_details_edit_class_select.name"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$filterValue.$view.class_details_edit_class_select.name"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 1,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "It looks like you have selected the same class multiple times. Please remove one of the duplicates.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "edit_character_basics_origin_subheader",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "What's your origin?",
                            "value_type": "string"
                        },
                        "style": "subhead"
                    },
                    {
                        "id": "edit_character_basics_background_composite",
                        "type": "composite",
                        "alignment": "end",
                        "margin_bottom": 4,
                        "subviews": [
                            {
                                "id": "edit_character_basics_see_background_button",
                                "type": "popUpButton",
                                "text": {
                                    "type": "constant",
                                    "value": "SEE DETAILS",
                                    "value_type": "string"
                                },
                                "pop_up_view": {
                                    "id": "edit_character_basics_see_background_bottom_sheet",
                                    "type": "resource",
                                    "view_type": "display",
                                    "resource_id": "background",
                                    "stat": "$view.edit_character_basics_background_select"
                                },
                                "pop_up_title": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view?.edit_character_basics_background_select?.name"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "Background",
                                        "value_type": "string"
                                    }
                                },
                                "display_cancel_button": true,
                                "cancel_text": {
                                    "type": "constant",
                                    "value": "OK",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$view?.edit_character_basics_background_select?"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "resource"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "edit_character_basics_background_select",
                                "type": "selectResources",
                                "stat": "background",
                                "resource_id": "background",
                                "margin_right": 4,
                                "margin_bottom": 4,
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "notNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view.edit_character_basics_background_select"
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "Please pick a background",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "id": "edit_character_basics_race_subrace_composite",
                        "type": "composite",
                        "alignment": "end",
                        "margin_bottom": 4,
                        "subviews": [
                            {
                                "id": "edit_character_basics_see_race_button",
                                "type": "popUpButton",
                                "text": {
                                    "type": "constant",
                                    "value": "SEE DETAILS",
                                    "value_type": "string"
                                },
                                "pop_up_view": {
                                    "id": "edit_character_basics_see_race_bottom_sheet",
                                    "type": "resource",
                                    "view_type": "display",
                                    "resource_id": "race",
                                    "stat": "$view.edit_character_basics_race_select"
                                },
                                "pop_up_title": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view?.edit_character_basics_race_select?.name"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "Race",
                                        "value_type": "string"
                                    }
                                },
                                "display_cancel_button": true,
                                "cancel_text": {
                                    "type": "constant",
                                    "value": "OK",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$view?.edit_character_basics_race_select?"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "resource"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "edit_character_basics_race_select",
                                "type": "selectResources",
                                "stat": "race",
                                "resource_id": "race",
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "notNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view.edit_character_basics_race_select"
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "Please pick a race",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "edit_character_basics_subrace_select",
                                "type": "select",
                                "stat": "subrace_id",
                                "margin_left": 4,
                                "resource_options": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view.edit_character_basics_race_select?.subraces"
                                    },
                                    "default_components": {
                                        "type": "list",
                                        "components": []
                                    }
                                },
                                "options_display_stat": "name",
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$view.edit_character_basics_race_select?.subraces"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "id": "edit_character_basics_hit_point_composite",
                        "type": "composite",
                        "margin_bottom": 4,
                        "subviews": [
                            {
                                "id": "edit_character_basics_hit_points_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Hit points: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "edit_character_basics_hit_point_mode_select",
                                "type": "select",
                                "stat": "hit_point_mode",
                                "options": "hit_point_modes"
                            }
                        ]
                    },
                    {
                        "id": "edit_character_basics_edit_ability_scores_warning_comp",
                        "type": "composite",
                        "alignment": "center",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "$is_new"
                            }
                        },
                        "subviews": [
                            {
                                "id": "edit_character_basics_edit_ability_scores_warning_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "To edit ability scores, please long-press on them in the character sheet",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            }
                        ]
                    },
                    {
                        "id": "edit_character_basics_ability_score_composite",
                        "type": "composite",
                        "margin_bottom": 4,
                        "subviews": [
                            {
                                "id": "edit_character_basics_ability_scores_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Ability Scores: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "edit_character_basics_ability_score_mode_select",
                                "type": "select",
                                "stat": "ability_score_mode",
                                "options": "ability_score_modes"
                            }
                        ],
                        "is_visible": {
                            "type": "stat",
                            "stat": "$is_new"
                        }
                    },
                    {
                        "id": "edit_character_basics_select_ability_score_increases",
                        "type": "resourceArray",
                        "resource_id": "ability_score_increase",
                        "stat": "creator_ability_score_increases",
                        "view_type": "display",
                        "is_visible": {
                            "type": "stat",
                            "stat": "$is_new"
                        }
                    },
                    {
                        "id": "edit_character_basics_ability_scores_custom_composite",
                        "type": "composite",
                        "alignment": "center",
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$is_new"
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.edit_character_basics_ability_score_mode_select"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "custom",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "subviews": [
                            {
                                "id": "edit_character_basics_ability_scores_custom_str",
                                "type": "text",
                                "edit_stat": "strength_score",
                                "style": "text",
                                "max_length": 2,
                                "margin_right": 4,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "8",
                                    "value_type": "string"
                                },
                                "label": {
                                    "type": "constant",
                                    "value": "STR",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "edit_character_basics_ability_scores_custom_dex",
                                "type": "text",
                                "edit_stat": "dexterity_score",
                                "style": "text",
                                "max_length": 2,
                                "margin_right": 4,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "8",
                                    "value_type": "string"
                                },
                                "label": {
                                    "type": "constant",
                                    "value": "DEX",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "edit_character_basics_ability_scores_custom_con",
                                "type": "text",
                                "edit_stat": "constitution_score",
                                "style": "text",
                                "max_length": 2,
                                "margin_right": 4,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "8",
                                    "value_type": "string"
                                },
                                "label": {
                                    "type": "constant",
                                    "value": "CON",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "edit_character_basics_ability_scores_custom_int",
                                "type": "text",
                                "edit_stat": "intelligence_score",
                                "style": "text",
                                "max_length": 2,
                                "margin_right": 4,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "8",
                                    "value_type": "string"
                                },
                                "label": {
                                    "type": "constant",
                                    "value": "INT",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "edit_character_basics_ability_scores_custom_wis",
                                "type": "text",
                                "edit_stat": "wisdom_score",
                                "style": "text",
                                "max_length": 2,
                                "margin_right": 4,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "8",
                                    "value_type": "string"
                                },
                                "label": {
                                    "type": "constant",
                                    "value": "WIS",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "edit_character_basics_ability_scores_custom_cha",
                                "type": "text",
                                "edit_stat": "charisma_score",
                                "style": "text",
                                "max_length": 2,
                                "margin_right": 4,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "8",
                                    "value_type": "string"
                                },
                                "label": {
                                    "type": "constant",
                                    "value": "CHA",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "edit_character_basics_ability_scores_point_buy_remaining_points_label",
                        "type": "text",
                        "text": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "Remaining points: ",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "remaining_point_buy_points"
                                    }
                                ]
                            }
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$is_new"
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.edit_character_basics_ability_score_mode_select"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "point_buy",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "edit_character_basics_ability_scores_point_buy_composite",
                        "type": "section",
                        "header": [],
                        "show_divider": false,
                        "content_item_min_width": 100,
                        "collapsible": false,
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$is_new"
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.edit_character_basics_ability_score_mode_select"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "point_buy",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        "content": [
                            {
                                "id": "edit_character_basics_ability_scores_point_buy_str",
                                "type": "stat",
                                "stat": "strength_score",
                                "min_value_allowed": 8,
                                "max_value_allowed": 15
                            },
                            {
                                "id": "edit_character_basics_ability_scores_point_buy_dex",
                                "type": "stat",
                                "stat": "dexterity_score",
                                "min_value_allowed": 8,
                                "max_value_allowed": 15
                            },
                            {
                                "id": "edit_character_basics_ability_scores_point_buy_con",
                                "type": "stat",
                                "stat": "constitution_score",
                                "min_value_allowed": 8,
                                "max_value_allowed": 15
                            },
                            {
                                "id": "edit_character_basics_ability_scores_point_buy_int",
                                "type": "stat",
                                "stat": "intelligence_score",
                                "min_value_allowed": 8,
                                "max_value_allowed": 15
                            },
                            {
                                "id": "edit_character_basics_ability_scores_point_buy_wis",
                                "type": "stat",
                                "stat": "wisdom_score",
                                "min_value_allowed": 8,
                                "max_value_allowed": 15
                            },
                            {
                                "id": "edit_character_basics_ability_scores_point_buy_cha",
                                "type": "stat",
                                "stat": "charisma_score",
                                "min_value_allowed": 8,
                                "max_value_allowed": 15
                            }
                        ]
                    }
                ]
            },
            "post_edit": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "$is_new"
                                },
                                "effect": {
                                    "type": "forEach",
                                    "components": {
                                        "type": "stat",
                                        "stat": "creator_ability_score_increases"
                                    },
                                    "apply": {
                                        "type": "addToStat",
                                        "meta_stat": {
                                            "type": "concat",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "$forEachValue.temp_selected_modifier"
                                                    },
                                                    {
                                                        "type": "constant",
                                                        "value": "_score",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        "value": {
                                            "type": "stat",
                                            "stat": "$forEachValue.value"
                                        },
                                        "aggregation_type": "set"
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "$is_new"
                                },
                                "effect": {
                                    "type": "setStat",
                                    "stat": "old_creator_ability_score_increases",
                                    "new_value": {
                                        "type": "stat",
                                        "stat": "creator_ability_score_increases"
                                    },
                                    "aggregation_type": "set"
                                }
                            }
                        ]
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "contains",
                                                "haystack": {
                                                    "type": "stat",
                                                    "stat": "$updated_stats"
                                                },
                                                "needle": {
                                                    "type": "stat",
                                                    "stat": "hit_point_mode"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$is_new"
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "roll",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "hit_point_mode"
                                                        }
                                                    ]
                                                }
                                            },
                                            "effect": {
                                                "type": "setStat",
                                                "stat": "base_hp",
                                                "new_value": {
                                                    "type": "roll",
                                                    "formula": {
                                                        "type": "joinToString",
                                                        "separator": " + ",
                                                        "components": {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "isEmpty",
                                                                        "components": {
                                                                            "type": "stat",
                                                                            "stat": "class_hit_dice_formatted"
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "constant",
                                                                                "value": "1d8",
                                                                                "value_type": "string"
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "class_hit_dice_formatted"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    }
                                                },
                                                "aggregation_type": "set"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "average",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "hit_point_mode"
                                                        }
                                                    ]
                                                }
                                            },
                                            "effect": {
                                                "type": "setStat",
                                                "stat": "base_hp",
                                                "new_value": {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "map_value_key": "$class",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "classes"
                                                        },
                                                        "mapper": {
                                                            "type": "multiply",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "$class.class_level"
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "$class.hit_die_average"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    }
                                                },
                                                "aggregation_type": "set"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "max",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "hit_point_mode"
                                                        }
                                                    ]
                                                }
                                            },
                                            "effect": {
                                                "type": "setStat",
                                                "stat": "base_hp",
                                                "new_value": {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "map_value_key": "$class",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "classes"
                                                        },
                                                        "mapper": {
                                                            "type": "multiply",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "$class.class_level"
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "$class.hit_die_max"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    }
                                                },
                                                "aggregation_type": "set"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d4_hit_dice",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "classes"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.class.actual_hit_die"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "d4",
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$mapValue.class_level"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d6_hit_dice",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "classes"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.class.actual_hit_die"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "d6",
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$mapValue.class_level"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d8_hit_dice",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "classes"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.class.actual_hit_die"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "d8",
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$mapValue.class_level"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d10_hit_dice",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "classes"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.class.actual_hit_die"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "d10",
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$mapValue.class_level"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d12_hit_dice",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "classes"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.class.actual_hit_die"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "d12",
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$mapValue.class_level"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d20_hit_dice",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "classes"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.class.actual_hit_die"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "d20",
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$mapValue.class_level"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "$is_new"
                                },
                                "effect": {
                                    "type": "setStat",
                                    "stat": "current_hp",
                                    "new_value": {
                                        "type": "stat",
                                        "stat": "max_hp"
                                    },
                                    "aggregation_type": "set"
                                }
                            }
                        ]
                    },
                    {
                        "type": "forEach",
                        "components": {
                            "type": "stat",
                            "stat": "classes"
                        },
                        "for_each_value_key": "$class",
                        "apply": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "lessThan",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$class.class_level"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$class.class.archetype_selection_level"
                                                }
                                            ]
                                        }
                                    },
                                    "effect": {
                                        "type": "setStat",
                                        "stat": "$class.archetype_id",
                                        "new_value": {
                                            "type": "constant",
                                            "value": null,
                                            "value_type": "string"
                                        },
                                        "aggregation_type": "set"
                                    }
                                }
                            ]
                        }
                    }
                ]
            }
        },
        {
            "title": {
                "id": "edit_about_title",
                "name": "About"
            },
            "view": {
                "id": "edit_character_about",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "edit_character_about_subheader",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Choose an alignment",
                            "value_type": "string"
                        },
                        "style": "subhead"
                    },
                    {
                        "id": "edit_character_about_alignment",
                        "type": "select",
                        "stat": "alignment",
                        "options": "alignments",
                        "margin_bottom": 4
                    },
                    {
                        "id": "edit_character_about_subheader",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Write a bit about your character",
                            "value_type": "string"
                        },
                        "style": "subhead"
                    },
                    {
                        "id": "edit_character_about_about",
                        "type": "text",
                        "edit_stat": "about",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "About",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "title": {
                "id": "edit_proficiencies_title",
                "name": "Proficiencies"
            },
            "view": {
                "id": "edit_character_proficiencies",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "edit_character_proficiencies_languages",
                        "type": "resourceArray",
                        "resource_id": "levelled_choice_text",
                        "stat": "creator_language_proficiency_choices",
                        "view_type": "display",
                        "left_view": {
                            "id": "edit_character_proficiencies_languages_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Languages proficiencies:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        }
                    },
                    {
                        "id": "edit_character_proficiencies_skills",
                        "type": "resourceArray",
                        "resource_id": "levelled_skill_proficiency",
                        "stat": "creator_skill_proficiency_choices",
                        "view_type": "display",
                        "left_view": {
                            "id": "edit_character_proficiencies_skills_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Skill proficiencies:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        }
                    },
                    {
                        "id": "edit_character_proficiencies_armors",
                        "type": "resourceArray",
                        "resource_id": "levelled_armor_proficiency",
                        "stat": "creator_armor_proficiency_choices",
                        "view_type": "display",
                        "left_view": {
                            "id": "edit_character_proficiencies_armors_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Armor proficiencies:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        }
                    },
                    {
                        "id": "edit_character_proficiencies_weapons",
                        "type": "resourceArray",
                        "resource_id": "levelled_choice_text",
                        "stat": "creator_weapon_proficiency_choices",
                        "view_type": "display",
                        "left_view": {
                            "id": "edit_character_proficiencies_weapons_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Weapon proficiencies:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        }
                    },
                    {
                        "id": "edit_character_proficiencies_tools",
                        "type": "resourceArray",
                        "resource_id": "levelled_choice_text",
                        "stat": "creator_tool_proficiency_choices",
                        "view_type": "display",
                        "left_view": {
                            "id": "edit_character_proficiencies_tools_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Tool proficiencies:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        }
                    }
                ]
            },
            "on_page_open": {
                "type": "setStat",
                "stat": "selecting",
                "new_value": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                },
                "aggregation_type": "set"
            },
            "on_page_close": {
                "type": "setStat",
                "stat": "selecting",
                "new_value": {
                    "type": "constant",
                    "value": false,
                    "value_type": "bool"
                },
                "aggregation_type": "set"
            },
            "post_edit": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "setStat",
                        "stat": "language_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "flatMap",
                                        "components": {
                                            "type": "stat",
                                            "stat": "creator_language_proficiency_choices"
                                        },
                                        "mapper": {
                                            "type": "split",
                                            "separator": "\\\\s*,\\\\s*",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$mapValue.selected_options"
                                            }
                                        }
                                    },
                                    "mapper": {
                                        "type": "trim",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "armor_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "stat",
                                        "stat": "creator_armor_proficiency_choices"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.selected_option"
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "forEach",
                        "components": {
                            "type": "stat",
                            "stat": "creator_skill_proficiency_choices"
                        },
                        "apply": {
                            "type": "setStat",
                            "meta_stat": {
                                "type": "concat",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$forEachValue.selected_option"
                                        },
                                        {
                                            "type": "constant",
                                            "value": "_proficiency",
                                            "value_type": "string"
                                        }
                                    ]
                                }
                            },
                            "new_value": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "stat",
                                            "stat": "$forEachValue.is_expertise"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "expert",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "proficient",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            },
                            "aggregation_type": "set"
                        }
                    },
                    {
                        "type": "setStat",
                        "stat": "weapon_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                },
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": "unarmed_strike",
                                            "value_type": "string"
                                        }
                                    ]
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "stat",
                                        "stat": "creator_weapon_proficiency_choices"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.selected_option"
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "tool_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "flatMap",
                                        "components": {
                                            "type": "stat",
                                            "stat": "creator_tool_proficiency_choices"
                                        },
                                        "mapper": {
                                            "type": "split",
                                            "separator": "\\\\s*,\\\\s*",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$mapValue.selected_options"
                                            }
                                        }
                                    },
                                    "mapper": {
                                        "type": "trim",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    }
                ]
            }
        },
        {
            "title": {
                "id": "edit_starting_equipment_title",
                "name": "Starting equipment"
            },
            "view": {
                "id": "edit_character_starting_equipment",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "edit_character_starting_equipment_subheader",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Select your starting equipment",
                            "value_type": "string"
                        },
                        "style": "subhead"
                    },
                    {
                        "id": "edit_character_starting_equipment_equipment",
                        "type": "resourceArray",
                        "resource_id": "selectable_items",
                        "stat": "creator_starting_equipment_choices",
                        "view_type": "display"
                    },
                    {
                        "id": "edit_character_starting_equipment_armor",
                        "type": "resourceArray",
                        "resource_id": "selectable_armors",
                        "stat": "creator_starting_armor_choices",
                        "view_type": "display"
                    },
                    {
                        "id": "edit_character_starting_equipment_weapon",
                        "type": "resourceArray",
                        "resource_id": "selectable_weapons",
                        "stat": "creator_starting_weapon_choices",
                        "view_type": "display"
                    }
                ]
            },
            "on_page_open": {
                "type": "setStat",
                "stat": "selecting",
                "new_value": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                },
                "aggregation_type": "set"
            },
            "on_page_close": {
                "type": "setStat",
                "stat": "selecting",
                "new_value": {
                    "type": "constant",
                    "value": false,
                    "value_type": "bool"
                },
                "aggregation_type": "set"
            },
            "post_edit": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "forEach",
                        "components": {
                            "type": "flatMap",
                            "components": {
                                "type": "stat",
                                "stat": "creator_starting_equipment_choices"
                            },
                            "mapper": {
                                "type": "stat",
                                "stat": "$mapValue.selected_options"
                            }
                        },
                        "apply": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "notNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$forEachValue.item"
                                        }
                                    },
                                    "effect": {
                                        "type": "setStat",
                                        "stat": "$forEachValue.item.quantity",
                                        "new_value": {
                                            "type": "stat",
                                            "stat": "$forEachValue.amount"
                                        },
                                        "aggregation_type": "set"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "type": "addToStat",
                        "stat": "equipment",
                        "value": {
                            "type": "filter",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "flatMap",
                                    "components": {
                                        "type": "stat",
                                        "stat": "creator_starting_equipment_choices"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.selected_options"
                                    }
                                },
                                "mapper": {
                                    "type": "copyResource",
                                    "preserve_ids": false,
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.item"
                                    }
                                }
                            },
                            "filter": {
                                "type": "notNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$filterValue"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "addToStat",
                        "stat": "armors",
                        "value": {
                            "type": "filter",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "flatMap",
                                    "components": {
                                        "type": "stat",
                                        "stat": "creator_starting_armor_choices"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.selected_options"
                                    }
                                },
                                "mapper": {
                                    "type": "copyResource",
                                    "preserve_ids": false,
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.armor"
                                    }
                                }
                            },
                            "filter": {
                                "type": "notNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$filterValue"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "addToStat",
                        "stat": "weapons",
                        "value": {
                            "type": "filter",
                            "components": {
                                "type": "map",
                                "components": {
                                    "type": "flatMap",
                                    "components": {
                                        "type": "stat",
                                        "stat": "creator_starting_weapon_choices"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.selected_options"
                                    }
                                },
                                "mapper": {
                                    "type": "copyResource",
                                    "preserve_ids": false,
                                    "components": {
                                        "type": "stat",
                                        "stat": "$mapValue.weapon"
                                    }
                                }
                            },
                            "filter": {
                                "type": "notNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$filterValue"
                                }
                            }
                        },
                        "aggregation_type": "set"
                    }
                ]
            }
        }
    ],
    "character_sheet_sections": [
        {
            "id": "avatar",
            "view": {
                "id": "avatar",
                "type": "avatarSection",
                "bottom_right_stack": [
                    {
                        "id": "lifecycle_events_button",
                        "type": "menuButton",
                        "icon_name": "ic_daytime",
                        "icon_size": "small",
                        "icon_color": "accent",
                        "options": "lifecycle_events_menu"
                    }
                ],
                "center_content": [
                    {
                        "id": "avatar_view",
                        "type": "avatar",
                        "margin_top": 8,
                        "photo_stat": "photo",
                        "name_stat": "name",
                        "size": "massive",
                        "interactable": true
                    },
                    {
                        "id": "avatar_name",
                        "type": "text",
                        "margin_top": 8,
                        "margin_left": 48,
                        "margin_right": 48,
                        "text": {
                            "type": "stat",
                            "stat": "name"
                        },
                        "style": "headline"
                    },
                    {
                        "id": "avatar_description",
                        "type": "text",
                        "margin_bottom": 8,
                        "margin_left": 32,
                        "margin_right": 32,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text"
                    }
                ],
                "bottom_left_button_title": {
                    "type": "constant",
                    "value": "INFORMATION",
                    "value_type": "string"
                },
                "bottom_left_button_event": {
                    "name": "show_information"
                }
            }
        },
        {
            "id": "notes",
            "view": {
                "id": "notes_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "notes_section_icon",
                        "type": "icon",
                        "name": "ic_notes",
                        "size": "medium",
                        "color": "primary",
                        "margin_left": 16
                    },
                    {
                        "id": "notes_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "notes",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "notes_section_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "notes_section_add_weapon",
                        "type": "selectResources",
                        "stat": "notes",
                        "resource_id": "note",
                        "view_type": "icon",
                        "should_append": true,
                        "should_save_on_selection": true,
                        "create_in_place": true,
                        "creation_pop_up_type": "bottomSheet"
                    }
                ],
                "content": [
                    {
                        "id": "notes_list",
                        "type": "resourceSection",
                        "resource_stat": "notes",
                        "resource_id": "note"
                    }
                ]
            }
        },
        {
            "id": "conditions",
            "view": {
                "id": "conditions",
                "type": "section",
                "header": [
                    {
                        "id": "conditions_section_icon",
                        "type": "icon",
                        "name": "ic_conditions",
                        "size": "medium",
                        "color": "accent",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "conditions_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Conditions",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "conditions_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "conditions_edit_button",
                        "type": "popUpButton",
                        "margin_right": 8,
                        "icon": {
                            "id": "conditions_edit_icon",
                            "type": "icon",
                            "name": "ic_edit",
                            "size": "small",
                            "color": "text"
                        },
                        "pop_up_view": {
                            "id": "conditions_edit_bottom_sheet",
                            "type": "section",
                            "header": [],
                            "content": [
                                {
                                    "id": "blinded_check",
                                    "type": "checkbox",
                                    "stat": "blinded",
                                    "label": {
                                        "type": "constant",
                                        "value": "Blinded",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "charmed_check",
                                    "type": "checkbox",
                                    "stat": "charmed",
                                    "label": {
                                        "type": "constant",
                                        "value": "Charmed",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "deafened_check",
                                    "type": "checkbox",
                                    "stat": "deafened",
                                    "label": {
                                        "type": "constant",
                                        "value": "Deafened",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "frightened_check",
                                    "type": "checkbox",
                                    "stat": "frightened",
                                    "label": {
                                        "type": "constant",
                                        "value": "Frightened",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "grappled_check",
                                    "type": "checkbox",
                                    "stat": "grappled",
                                    "label": {
                                        "type": "constant",
                                        "value": "Grappled",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "incapacitated_check",
                                    "type": "checkbox",
                                    "stat": "incapacitated",
                                    "label": {
                                        "type": "constant",
                                        "value": "Incapacitated",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "invisible_check",
                                    "type": "checkbox",
                                    "stat": "invisible",
                                    "label": {
                                        "type": "constant",
                                        "value": "Invisible",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "paralyzed_check",
                                    "type": "checkbox",
                                    "stat": "paralyzed",
                                    "label": {
                                        "type": "constant",
                                        "value": "Paralyzed",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "petrified_check",
                                    "type": "checkbox",
                                    "stat": "petrified",
                                    "label": {
                                        "type": "constant",
                                        "value": "Petrified",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "poisoned_check",
                                    "type": "checkbox",
                                    "stat": "poisoned",
                                    "label": {
                                        "type": "constant",
                                        "value": "Poisoned",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "prone_check",
                                    "type": "checkbox",
                                    "stat": "prone",
                                    "label": {
                                        "type": "constant",
                                        "value": "Prone",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "restrained_check",
                                    "type": "checkbox",
                                    "stat": "restrained",
                                    "label": {
                                        "type": "constant",
                                        "value": "Restrained",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "stunned_check",
                                    "type": "checkbox",
                                    "stat": "stunned",
                                    "label": {
                                        "type": "constant",
                                        "value": "Stunned",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "unconscious_check",
                                    "type": "checkbox",
                                    "stat": "unconscious",
                                    "label": {
                                        "type": "constant",
                                        "value": "Unconscious",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "exhausted_check",
                                    "type": "checkbox",
                                    "stat": "exhausted",
                                    "label": {
                                        "type": "constant",
                                        "value": "Exhausted",
                                        "value_type": "string"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                },
                                {
                                    "id": "conditions_extra_view",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "",
                                        "value_type": "string"
                                    },
                                    "style": "text"
                                }
                            ],
                            "show_divider": false,
                            "content_item_min_width": 0.5
                        },
                        "pop_up_title": {
                            "type": "constant",
                            "value": "Manage conditions",
                            "value_type": "string"
                        },
                        "display_cancel_button": true,
                        "display_save_button": true,
                        "should_persist_on_save": true,
                        "alignment": "left"
                    }
                ],
                "content": [
                    {
                        "id": "blinded_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Blinded",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "blinded"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "blinded"
                        }
                    },
                    {
                        "id": "charmed_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Charmed",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "charmed"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "charmed"
                        }
                    },
                    {
                        "id": "deafened_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Deafened",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "deafened"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "deafened"
                        }
                    },
                    {
                        "id": "frightened_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Frightened",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "frightened"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "frightened"
                        }
                    },
                    {
                        "id": "grappled_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Grappled",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "grappled"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "grappled"
                        }
                    },
                    {
                        "id": "incapacitated_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Incapacitated",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "incapacitated"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "incapacitated"
                        }
                    },
                    {
                        "id": "invisible_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Invisible",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "invisible"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "invisible"
                        }
                    },
                    {
                        "id": "paralyzed_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Paralyzed",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "paralyzed"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "paralyzed"
                        }
                    },
                    {
                        "id": "petrified_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Petrified",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "petrified"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "petrified"
                        }
                    },
                    {
                        "id": "poisoned_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Poisoned",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "poisoned"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "poisoned"
                        }
                    },
                    {
                        "id": "prone_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Prone",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "prone"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "prone"
                        }
                    },
                    {
                        "id": "restrained_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Restrained",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "restrained"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "restrained"
                        }
                    },
                    {
                        "id": "stunned_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Stunned",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "stunned"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "stunned"
                        }
                    },
                    {
                        "id": "unconscious_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Unconscious",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "unconscious"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "unconscious"
                        }
                    },
                    {
                        "id": "exhausted_chip",
                        "type": "chip",
                        "margin_top": 6,
                        "margin_bottom": 6,
                        "margin_left": 4,
                        "margin_right": 4,
                        "text": {
                            "type": "constant",
                            "value": "Exhausted",
                            "value_type": "string"
                        },
                        "on_tap_event": {
                            "name": "remove_condition",
                            "payload": {
                                "condition": "exhausted"
                            }
                        },
                        "background_color": "buttonSurface",
                        "is_visible": {
                            "type": "stat",
                            "stat": "exhausted"
                        }
                    }
                ],
                "show_divider": true,
                "collapsible": true,
                "start_collapsed": false,
                "alignment": "start"
            }
        },
        {
            "id": "death_saving_throws",
            "view": {
                "id": "death_saving_throws",
                "type": "section",
                "content_item_min_width": 1,
                "is_visible": {
                    "type": "lessThanEquals",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "current_hp"
                            },
                            {
                                "type": "constant",
                                "value": 0,
                                "value_type": "integer"
                            }
                        ]
                    }
                },
                "header": [
                    {
                        "id": "death_saving_throws_section_icon",
                        "type": "icon",
                        "name": "ic_death",
                        "size": "medium",
                        "color": "accent",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "death_saving_throws_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Death Saves",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "death_saving_throws_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "death_saving_throws_menu_button",
                        "type": "menuButton",
                        "icon_name": "ic_more_vert",
                        "icon_size": "small",
                        "color": "text",
                        "options": "death_saves_menu"
                    }
                ],
                "content": [
                    {
                        "id": "death_saving_throws_successes_comp",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "death_saving_throws_success_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Successes",
                                    "value_type": "string"
                                },
                                "margin_left": 32,
                                "margin_right": 32,
                                "style": "text"
                            },
                            {
                                "id": "death_saving_throws_success_1",
                                "type": "checkbox",
                                "stat": "death_saving_throws_success_1",
                                "should_auto_save": true,
                                "margin_right": 32
                            },
                            {
                                "id": "death_saving_throws_success_2",
                                "type": "checkbox",
                                "stat": "death_saving_throws_success_2",
                                "should_auto_save": true,
                                "margin_right": 32,
                                "is_visible": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view?.death_saving_throws_success_1?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                }
                            },
                            {
                                "id": "death_saving_throws_success_3",
                                "type": "checkbox",
                                "stat": "death_saving_throws_success_3",
                                "should_auto_save": true,
                                "margin_right": 32,
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view?.death_saving_throws_success_1?"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": false,
                                                    "value_type": "bool"
                                                }
                                            },
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view?.death_saving_throws_success_2?"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": false,
                                                    "value_type": "bool"
                                                }
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "id": "death_saving_throws_failures_comp",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "death_saving_throws_failure_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Failures",
                                    "value_type": "string"
                                },
                                "margin_left": 50,
                                "margin_right": 32,
                                "style": "text"
                            },
                            {
                                "id": "death_saving_throws_failure_1",
                                "type": "checkbox",
                                "stat": "death_saving_throws_failure_1",
                                "should_auto_save": true,
                                "margin_right": 32
                            },
                            {
                                "id": "death_saving_throws_failure_2",
                                "type": "checkbox",
                                "stat": "death_saving_throws_failure_2",
                                "should_auto_save": true,
                                "margin_right": 32,
                                "is_visible": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view?.death_saving_throws_failure_1?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                }
                            },
                            {
                                "id": "death_saving_throws_failure_3",
                                "type": "checkbox",
                                "stat": "death_saving_throws_failure_3",
                                "should_auto_save": true,
                                "margin_right": 32,
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view?.death_saving_throws_failure_1?"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": false,
                                                    "value_type": "bool"
                                                }
                                            },
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view?.death_saving_throws_failure_2?"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": false,
                                                    "value_type": "bool"
                                                }
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                ],
                "show_divider": true,
                "collapsible": true,
                "start_collapsed": false,
                "alignment": "start"
            }
        },
        {
            "id": "status",
            "view": {
                "id": "status_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 125,
                "collapsible": false,
                "header": [
                    {
                        "id": "avatar_view",
                        "type": "avatar",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16,
                        "photo_stat": "photo",
                        "name_stat": "name",
                        "size": "small"
                    },
                    {
                        "id": "status_hp",
                        "type": "ticker",
                        "margin_left": 16,
                        "stat": "current_hp",
                        "style": "title",
                        "button_location": "right",
                        "button_look": "plusMinus",
                        "should_auto_save": true,
                        "change_amount": 1,
                        "min_value_allowed": 0,
                        "label": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "/ ",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "max_hp"
                                    },
                                    {
                                        "type": "constant",
                                        "value": " HP",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "label_alignment": "right",
                        "edit_bottom_sheet_title": {
                            "type": "constant",
                            "value": "Hit points",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "$edit_mode"
                            }
                        }
                    },
                    {
                        "id": "status_max_hp",
                        "type": "ticker",
                        "margin_left": 16,
                        "stat": "base_hp",
                        "style": "title",
                        "button_location": "right",
                        "button_look": "plusMinus",
                        "should_auto_save": true,
                        "change_amount": 1,
                        "min_value_allowed": 1,
                        "label": {
                            "type": "concat",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "Base HP + ",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "classes_hp_mods"
                                    },
                                    {
                                        "type": "constant",
                                        "value": " mods",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        },
                        "label_alignment": "right",
                        "edit_bottom_sheet_title": {
                            "type": "constant",
                            "value": "Max hit points",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "stat",
                            "stat": "$edit_mode"
                        }
                    }
                ],
                "content": [
                    {
                        "id": "armor_class",
                        "type": "stat",
                        "stat": "armor_class",
                        "change_amount": 1,
                        "min_value_allowed": 0
                    },
                    {
                        "id": "initiative",
                        "type": "stat",
                        "stat": "initiative",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "initiative",
                                "statName": "Initiative"
                            }
                        }
                    },
                    {
                        "id": "speed",
                        "type": "stat",
                        "stat": "speed",
                        "change_amount": 5,
                        "min_value_allowed": 0,
                        "bottom_sheet_in_edit_mode": true,
                        "bottom_sheet_view": {
                            "id": "speed_section",
                            "type": "section",
                            "header": [],
                            "show_divider": false,
                            "content_item_min_width": 125,
                            "collapsible": false,
                            "content": [
                                {
                                    "id": "speed_bottom_sheet_stat",
                                    "type": "stat",
                                    "stat": "speed",
                                    "change_amount": 5,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "burrow_speed_bottom_sheet_stat",
                                    "type": "stat",
                                    "stat": "burrow_speed",
                                    "change_amount": 5,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "climb_speed_bottom_sheet_stat",
                                    "type": "stat",
                                    "stat": "climb_speed",
                                    "change_amount": 5,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "fly_speed_bottom_sheet_stat",
                                    "type": "stat",
                                    "stat": "fly_speed",
                                    "change_amount": 5,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "swim_speed_bottom_sheet_stat",
                                    "type": "stat",
                                    "stat": "swim_speed",
                                    "change_amount": 5,
                                    "min_value_allowed": 0
                                }
                            ]
                        },
                        "sheet_title": {
                            "type": "constant",
                            "value": "Manage speeds",
                            "value_type": "string"
                        }
                    },
                    {
                        "id": "passive_perception",
                        "type": "stat",
                        "stat": "passive_perception",
                        "change_amount": 1,
                        "min_value_allowed": 0
                    },
                    {
                        "id": "proficiency_bonus",
                        "type": "stat",
                        "stat": "proficiency_bonus",
                        "change_amount": 1,
                        "min_value_allowed": 0,
                        "always_show_sign": true
                    },
                    {
                        "id": "hit_dice",
                        "type": "stat",
                        "stat": "total_hit_dice",
                        "change_amount": 0,
                        "min_value_allowed": 0,
                        "bottom_sheet_in_edit_mode": true,
                        "bottom_sheet_view": {
                            "id": "hit_dice_section",
                            "type": "section",
                            "header": [],
                            "show_divider": false,
                            "content_item_min_width": 125,
                            "collapsible": false,
                            "content": [
                                {
                                    "id": "hit_dice_d4_stat",
                                    "type": "stat",
                                    "stat": "current_d4_hit_dice",
                                    "change_amount": 1,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "hit_dice_d6_stat",
                                    "type": "stat",
                                    "stat": "current_d6_hit_dice",
                                    "change_amount": 1,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "hit_dice_d8_stat",
                                    "type": "stat",
                                    "stat": "current_d8_hit_dice",
                                    "change_amount": 1,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "hit_dice_d10_stat",
                                    "type": "stat",
                                    "stat": "current_d10_hit_dice",
                                    "change_amount": 1,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "hit_dice_d12_stat",
                                    "type": "stat",
                                    "stat": "current_d12_hit_dice",
                                    "change_amount": 1,
                                    "min_value_allowed": 0
                                },
                                {
                                    "id": "hit_dice_d20_stat",
                                    "type": "stat",
                                    "stat": "current_d20_hit_dice",
                                    "change_amount": 1,
                                    "min_value_allowed": 0
                                }
                            ]
                        },
                        "sheet_title": {
                            "type": "constant",
                            "value": "Manage hit dice",
                            "value_type": "string"
                        }
                    }
                ]
            }
        },
        {
            "id": "abilities",
            "view": {
                "id": "ability_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 125,
                "collapsible": false,
                "header": [
                    {
                        "id": "ability_section_icon",
                        "type": "icon",
                        "name": "ic_d20",
                        "size": "medium",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "ability_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Ability Modifiers",
                            "value_type": "string"
                        },
                        "style": "title"
                    }
                ],
                "content": [
                    {
                        "id": "strength",
                        "type": "stat",
                        "stat": "strength_modifier",
                        "edit_stat": "strength_score",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "strength_modifier",
                                "statName": "Strength"
                            }
                        }
                    },
                    {
                        "id": "dexterity",
                        "type": "stat",
                        "stat": "dexterity_modifier",
                        "edit_stat": "dexterity_score",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "dexterity_modifier",
                                "statName": "Dexterity"
                            }
                        }
                    },
                    {
                        "id": "constitution",
                        "type": "stat",
                        "stat": "constitution_modifier",
                        "edit_stat": "constitution_score",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "constitution_modifier",
                                "statName": "Constitution"
                            }
                        }
                    },
                    {
                        "id": "intelligence",
                        "type": "stat",
                        "stat": "intelligence_modifier",
                        "edit_stat": "intelligence_score",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "intelligence_modifier",
                                "statName": "Intelligence"
                            }
                        }
                    },
                    {
                        "id": "wisdom",
                        "type": "stat",
                        "stat": "wisdom_modifier",
                        "edit_stat": "wisdom_score",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "wisdom_modifier",
                                "statName": "Wisdom"
                            }
                        }
                    },
                    {
                        "id": "charisma",
                        "type": "stat",
                        "stat": "charisma_modifier",
                        "edit_stat": "charisma_score",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "charisma_modifier",
                                "statName": "Charisma"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "saving_throws",
            "view": {
                "id": "saving_throws_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 125,
                "collapsible": false,
                "header": [
                    {
                        "id": "saving_throws_section_icon",
                        "type": "icon",
                        "name": "ic_d20",
                        "size": "medium",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "saving_throws_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Saving Throws",
                            "value_type": "string"
                        },
                        "style": "title"
                    }
                ],
                "content": [
                    {
                        "id": "strength",
                        "type": "stat",
                        "stat": "strength_saving_throw",
                        "edit_stat": "strength_saving_throw_proficiency",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "strength_saving_throw",
                                "statName": "Strength saving throw"
                            }
                        }
                    },
                    {
                        "id": "dexterity",
                        "type": "stat",
                        "stat": "dexterity_saving_throw",
                        "edit_stat": "dexterity_saving_throw_proficiency",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "dexterity_saving_throw",
                                "statName": "Dexterity saving throw"
                            }
                        }
                    },
                    {
                        "id": "constitution",
                        "type": "stat",
                        "stat": "constitution_saving_throw",
                        "edit_stat": "constitution_saving_throw_proficiency",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "constitution_saving_throw",
                                "statName": "Constitution saving throw"
                            }
                        }
                    },
                    {
                        "id": "intelligence",
                        "type": "stat",
                        "stat": "intelligence_saving_throw",
                        "edit_stat": "intelligence_saving_throw_proficiency",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "intelligence_saving_throw",
                                "statName": "Intelligence saving throw"
                            }
                        }
                    },
                    {
                        "id": "wisdom",
                        "type": "stat",
                        "stat": "wisdom_saving_throw",
                        "edit_stat": "wisdom_saving_throw_proficiency",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "wisdom_saving_throw",
                                "statName": "Wisdom saving throw"
                            }
                        }
                    },
                    {
                        "id": "charisma",
                        "type": "stat",
                        "stat": "charisma_saving_throw",
                        "edit_stat": "charisma_saving_throw_proficiency",
                        "change_amount": 1,
                        "on_tap_event": {
                            "name": "rollStat",
                            "payload": {
                                "stat": "charisma_saving_throw",
                                "statName": "Charisma saving throw"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "skills",
            "view": {
                "id": "skills_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "skills_section_icon",
                        "type": "icon",
                        "name": "ic_skills",
                        "size": "medium",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "skills_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Skills",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "skills_section_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "skills_section_menu",
                        "type": "menuButton",
                        "margin_right": 8,
                        "icon_name": "ic_sort",
                        "icon_size": "small",
                        "icon_color": "accent",
                        "options": "sort_skill_proficiencies_menu",
                        "allowed_options": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "sort_skills_by_name"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "sort_by_ability",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "sort_by_name",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                ],
                "content": [
                    {
                        "id": "skills_section_by_name",
                        "type": "section",
                        "header": [],
                        "is_visible": {
                            "type": "stat",
                            "stat": "sort_skills_by_name"
                        },
                        "collapsible": false,
                        "content": [
                            {
                                "id": "acrobatics_by_name",
                                "type": "stat",
                                "stat": "acrobatics",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "acrobatics",
                                        "statName": "Acrobatics"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "acrobatics",
                                        "statName": "Acrobatics"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "acrobatics_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "acrobatics_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "medicine_by_name",
                                "type": "stat",
                                "stat": "medicine",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "medicine",
                                        "statName": "Medicine"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "medicine",
                                        "statName": "Medicine"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "medicine_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "medicine_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "animal_handling_by_name",
                                "type": "stat",
                                "stat": "animal_handling",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "animal_handling",
                                        "statName": "Animal Handling"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "animal_handling",
                                        "statName": "Animal Handling"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "animal_handling_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "animal_handling_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "nature_by_name",
                                "type": "stat",
                                "stat": "nature",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "nature",
                                        "statName": "Nature"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "nature",
                                        "statName": "Nature"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "nature_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "nature_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "arcana_by_name",
                                "type": "stat",
                                "stat": "arcana",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "arcana",
                                        "statName": "Arcana"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "arcana",
                                        "statName": "Arcana"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "arcana_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "arcana_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "perception_by_name",
                                "type": "stat",
                                "stat": "perception",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "perception",
                                        "statName": "Perception"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "perception",
                                        "statName": "Perception"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "perception_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "perception_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "athletics_by_name",
                                "type": "stat",
                                "stat": "athletics",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "athletics",
                                        "statName": "Athletics"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "athletics",
                                        "statName": "Athletics"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "athletics_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "athletics_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "performance_by_name",
                                "type": "stat",
                                "stat": "performance",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "performance",
                                        "statName": "Performance"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "performance",
                                        "statName": "Performance"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "performance_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "performance_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "deception_by_name",
                                "type": "stat",
                                "stat": "deception",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "deception",
                                        "statName": "Deception"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "deception",
                                        "statName": "Deception"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "deception_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "deception_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "persuasion_by_name",
                                "type": "stat",
                                "stat": "persuasion",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "persuasion",
                                        "statName": "Persuasion"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "persuasion",
                                        "statName": "Persuasion"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "persuasion_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "persuasion_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "history_by_name",
                                "type": "stat",
                                "stat": "history",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "history",
                                        "statName": "History"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "history",
                                        "statName": "History"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "history_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "history_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "religion_by_name",
                                "type": "stat",
                                "stat": "religion",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "religion",
                                        "statName": "Religion"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "religion",
                                        "statName": "Religion"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "religion_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "religion_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "insight_by_name",
                                "type": "stat",
                                "stat": "insight",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "insight",
                                        "statName": "Insight"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "insight",
                                        "statName": "Insight"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "insight_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "insight_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "sleight_of_hand_by_name",
                                "type": "stat",
                                "stat": "sleight_of_hand",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "sleight_of_hand",
                                        "statName": "Sleight of Hand"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "sleight_of_hand",
                                        "statName": "Sleight of Hand"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "sleight_of_hand_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "sleight_of_hand_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "intimidation_by_name",
                                "type": "stat",
                                "stat": "intimidation",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "intimidation",
                                        "statName": "Intimidation"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "intimidation",
                                        "statName": "Intimidation"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "intimidation_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "intimidation_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "stealth_by_name",
                                "type": "stat",
                                "stat": "stealth",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "stealth",
                                        "statName": "Stealth"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "stealth",
                                        "statName": "Stealth"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "stealth_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "stealth_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "investigation_by_name",
                                "type": "stat",
                                "stat": "investigation",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "investigation",
                                        "statName": "Investigation"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "investigation",
                                        "statName": "Investigation"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "investigation_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "investigation_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "survival_by_name",
                                "type": "stat",
                                "stat": "survival",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "survival",
                                        "statName": "Survival"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "survival",
                                        "statName": "Survival"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "survival_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "survival_label_color"
                                },
                                "always_show_sign": true
                            }
                        ],
                        "show_divider": false,
                        "content_item_min_width": 0.5
                    },
                    {
                        "id": "skills_section_by_ability",
                        "type": "section",
                        "header": [],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "sort_skills_by_name"
                            }
                        },
                        "collapsible": false,
                        "content": [
                            {
                                "id": "skills_section_strength_label",
                                "type": "text",
                                "margin_left": 32,
                                "margin_top": 12,
                                "margin_bottom": 12,
                                "text": {
                                    "type": "constant",
                                    "value": "Strength",
                                    "value_type": "string"
                                },
                                "style": "subhead",
                                "bold": true,
                                "color": {
                                    "type": "constant",
                                    "value": "primary",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "skills_section_wisdom_label",
                                "type": "text",
                                "margin_left": 32,
                                "margin_top": 12,
                                "margin_bottom": 12,
                                "text": {
                                    "type": "constant",
                                    "value": "Wisdom",
                                    "value_type": "string"
                                },
                                "style": "subhead",
                                "bold": true,
                                "color": {
                                    "type": "constant",
                                    "value": "primary",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "athletics_by_ability",
                                "type": "stat",
                                "stat": "athletics",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "athletics",
                                        "statName": "Athletics"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "athletics",
                                        "statName": "Athletics"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "athletics_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "athletics_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "animal_handling_by_ability",
                                "type": "stat",
                                "stat": "animal_handling",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "animal_handling",
                                        "statName": "Animal Handling"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "animal_handling",
                                        "statName": "Animal Handling"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "animal_handling_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "animal_handling_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "skills_section_dexterity_label",
                                "type": "text",
                                "margin_left": 32,
                                "margin_top": 12,
                                "margin_bottom": 12,
                                "text": {
                                    "type": "constant",
                                    "value": "Dexterity",
                                    "value_type": "string"
                                },
                                "style": "subhead",
                                "bold": true,
                                "color": {
                                    "type": "constant",
                                    "value": "primary",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "insight_by_ability",
                                "type": "stat",
                                "stat": "insight",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "insight",
                                        "statName": "Insight"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "insight",
                                        "statName": "Insight"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "insight_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "insight_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "acrobatics_by_ability",
                                "type": "stat",
                                "stat": "acrobatics",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "acrobatics",
                                        "statName": "Acrobatics"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "acrobatics",
                                        "statName": "Acrobatics"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "acrobatics_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "acrobatics_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "medicine_by_ability",
                                "type": "stat",
                                "stat": "medicine",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "medicine",
                                        "statName": "Medicine"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "medicine",
                                        "statName": "Medicine"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "medicine_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "medicine_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "sleight_of_hand_by_ability",
                                "type": "stat",
                                "stat": "sleight_of_hand",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "sleight_of_hand",
                                        "statName": "Sleight of Hand"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "sleight_of_hand",
                                        "statName": "Sleight of Hand"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "sleight_of_hand_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "sleight_of_hand_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "perception_by_ability",
                                "type": "stat",
                                "stat": "perception",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "perception",
                                        "statName": "Perception"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "perception",
                                        "statName": "Perception"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "perception_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "perception_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "stealth_by_ability",
                                "type": "stat",
                                "stat": "stealth",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "stealth",
                                        "statName": "Stealth"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "stealth",
                                        "statName": "Stealth"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "stealth_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "stealth_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "survival_by_ability",
                                "type": "stat",
                                "stat": "survival",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "survival",
                                        "statName": "Survival"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "survival",
                                        "statName": "Survival"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "survival_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "survival_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "skills_section_intelligence_label",
                                "type": "text",
                                "margin_left": 32,
                                "margin_top": 12,
                                "margin_bottom": 12,
                                "text": {
                                    "type": "constant",
                                    "value": "Intelligence",
                                    "value_type": "string"
                                },
                                "style": "subhead",
                                "bold": true,
                                "color": {
                                    "type": "constant",
                                    "value": "primary",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "skills_section_charisma_label",
                                "type": "text",
                                "margin_left": 32,
                                "margin_top": 12,
                                "margin_bottom": 12,
                                "text": {
                                    "type": "constant",
                                    "value": "Charisma",
                                    "value_type": "string"
                                },
                                "style": "subhead",
                                "bold": true,
                                "color": {
                                    "type": "constant",
                                    "value": "primary",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "arcana_by_ability",
                                "type": "stat",
                                "stat": "arcana",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "arcana",
                                        "statName": "Arcana"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "arcana",
                                        "statName": "Arcana"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "arcana_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "arcana_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "deception_by_ability",
                                "type": "stat",
                                "stat": "deception",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "deception",
                                        "statName": "Deception"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "deception",
                                        "statName": "Deception"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "deception_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "deception_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "history_by_ability",
                                "type": "stat",
                                "stat": "history",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "history",
                                        "statName": "History"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "history",
                                        "statName": "History"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "history_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "history_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "intimidation_by_ability",
                                "type": "stat",
                                "stat": "intimidation",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "intimidation",
                                        "statName": "Intimidation"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "intimidation",
                                        "statName": "Intimidation"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "intimidation_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "intimidation_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "investigation_by_ability",
                                "type": "stat",
                                "stat": "investigation",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "investigation",
                                        "statName": "Investigation"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "investigation",
                                        "statName": "Investigation"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "investigation_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "investigation_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "performance_by_ability",
                                "type": "stat",
                                "stat": "performance",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "performance",
                                        "statName": "Performance"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "performance",
                                        "statName": "Performance"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "performance_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "performance_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "nature_by_ability",
                                "type": "stat",
                                "stat": "nature",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "nature",
                                        "statName": "Nature"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "nature",
                                        "statName": "Nature"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "nature_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "nature_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "persuasion_by_ability",
                                "type": "stat",
                                "stat": "persuasion",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "persuasion",
                                        "statName": "Persuasion"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "persuasion",
                                        "statName": "Persuasion"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "persuasion_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "persuasion_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "religion_by_ability",
                                "type": "stat",
                                "stat": "religion",
                                "change_amount": 0,
                                "on_tap_event": {
                                    "name": "skillTap",
                                    "payload": {
                                        "stat": "religion",
                                        "statName": "Religion"
                                    }
                                },
                                "on_long_tap_event": {
                                    "name": "editSkillProficiency",
                                    "payload": {
                                        "stat": "religion",
                                        "statName": "Religion"
                                    }
                                },
                                "style": "list",
                                "stat_color": {
                                    "type": "stat",
                                    "stat": "religion_color"
                                },
                                "name_color": {
                                    "type": "stat",
                                    "stat": "religion_label_color"
                                },
                                "always_show_sign": true
                            },
                            {
                                "id": "",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "",
                                    "value_type": "string"
                                },
                                "style": "text"
                            }
                        ],
                        "show_divider": false,
                        "content_item_min_width": 0.5
                    }
                ]
            }
        },
        {
            "id": "companions",
            "view": {
                "id": "companions_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "companions_section_icon",
                        "type": "icon",
                        "name": "ic_pets",
                        "color": "#b3591d",
                        "size": "medium",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "companions_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "stat",
                            "stat": "companion_section_title"
                        },
                        "style": "title"
                    },
                    {
                        "id": "companions_section_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "companions_section_add_weapon",
                        "type": "selectResources",
                        "stat": "companions",
                        "resource_id": "companion",
                        "view_type": "icon",
                        "should_append": true,
                        "should_save_on_selection": true,
                        "create_in_place": true,
                        "creation_pop_up_type": "bottomSheet"
                    }
                ],
                "content": [
                    {
                        "id": "companions_list",
                        "type": "resourceSection",
                        "resource_stat": "companions",
                        "resource_id": "companion",
                        "tap_displays_resource": false
                    }
                ]
            }
        },
        {
            "id": "features",
            "view": {
                "id": "features_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "features_section_icon",
                        "type": "icon",
                        "name": "ic_star",
                        "size": "medium",
                        "margin_left": 16
                    },
                    {
                        "id": "features_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Traits & Features",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "features_section_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "features_section_add_feat",
                        "type": "selectResources",
                        "stat": "feats",
                        "resource_id": "feat",
                        "view_type": "icon",
                        "should_append": true,
                        "should_save_on_selection": true
                    }
                ],
                "content": [
                    {
                        "id": "class_features_subsection",
                        "type": "resourceArray",
                        "resource_id": "class_details",
                        "stat": "classes",
                        "view_type": "display",
                        "hide_line": true
                    },
                    {
                        "id": "traits_subsection",
                        "type": "section",
                        "header": [
                            {
                                "id": "traits_label",
                                "type": "text",
                                "margin_left": 24,
                                "text": {
                                    "type": "constant",
                                    "value": "Racial traits",
                                    "value_type": "string"
                                },
                                "style": "section"
                            }
                        ],
                        "content": [
                            {
                                "id": "traits_list",
                                "type": "resourceSection",
                                "resource_stat": "race_traits",
                                "read_only": true,
                                "resource_id": "feat"
                            }
                        ],
                        "show_divider": false,
                        "content_item_min_width": 1,
                        "collapsible": true,
                        "start_collapsed": true,
                        "always_show_collapse_icon": true
                    },
                    {
                        "id": "background_subsection",
                        "type": "section",
                        "header": [
                            {
                                "id": "background_label",
                                "type": "text",
                                "margin_left": 24,
                                "text": {
                                    "type": "constant",
                                    "value": "Background",
                                    "value_type": "string"
                                },
                                "style": "section"
                            }
                        ],
                        "content": [
                            {
                                "id": "background_list",
                                "type": "resourceSection",
                                "resource_stat": "background_features",
                                "read_only": true,
                                "resource_id": "feat"
                            }
                        ],
                        "show_divider": false,
                        "content_item_min_width": 1,
                        "collapsible": true,
                        "start_collapsed": true,
                        "always_show_collapse_icon": true
                    },
                    {
                        "id": "feat_list",
                        "type": "resourceSection",
                        "resource_stat": "feats",
                        "read_only": false,
                        "resource_id": "feat"
                    },
                    {
                        "id": "selected_selectable_feat_list",
                        "type": "resourceSection",
                        "resource_stat": "selected_selectable_feats",
                        "read_only": true,
                        "resource_id": "feat"
                    }
                ]
            }
        },
        {
            "id": "armors",
            "view": {
                "id": "armors_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "armors_section_icon",
                        "type": "icon",
                        "name": "ic_armor",
                        "size": "medium",
                        "margin_left": 16
                    },
                    {
                        "id": "armors_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Armor",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "armors_section_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "armors_section_add_armor",
                        "type": "selectResources",
                        "stat": "armors",
                        "resource_id": "armor",
                        "view_type": "icon",
                        "should_append": true,
                        "should_save_on_selection": true
                    }
                ],
                "content": [
                    {
                        "id": "armors_list",
                        "type": "resourceSection",
                        "resource_stat": "armors",
                        "resource_id": "armor"
                    }
                ]
            }
        },
        {
            "id": "weapons",
            "view": {
                "id": "weapons_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "weapons_section_icon",
                        "type": "icon",
                        "name": "ic_weapon",
                        "size": "medium",
                        "margin_left": 16
                    },
                    {
                        "id": "weapons_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Weapons",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "weapons_section_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "weapons_section_add_weapon",
                        "type": "selectResources",
                        "stat": "weapons",
                        "resource_id": "weapon",
                        "view_type": "icon",
                        "should_append": true,
                        "should_save_on_selection": true
                    }
                ],
                "content": [
                    {
                        "id": "weapons_list",
                        "type": "resourceSection",
                        "resource_stat": "all_weapons",
                        "resource_set_stat": "weapons",
                        "resource_id": "weapon",
                        "header_view": {
                            "id": "weapons_list_attacks_per_action_composite",
                            "type": "composite",
                            "margin_left": 16,
                            "margin_bottom": 16,
                            "subviews": [
                                {
                                    "id": "weapons_list_attacks_per_action_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Attacks per action: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                {
                                    "id": "weapons_list_attacks_per_action",
                                    "type": "text",
                                    "text": {
                                        "type": "stat",
                                        "stat": "attacks_per_action"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            ]
                        }
                    }
                ]
            }
        },
        {
            "id": "equipment",
            "view": {
                "id": "equipment_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "equipment_section_icon",
                        "type": "icon",
                        "name": "ic_backpack",
                        "size": "medium",
                        "margin_left": 16
                    },
                    {
                        "id": "equipment_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Equipment",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "equipment_section_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "equipment_section_add_equipment",
                        "type": "selectResources",
                        "stat": "equipment",
                        "resource_id": "item",
                        "view_type": "icon",
                        "should_append": true,
                        "should_save_on_selection": true
                    }
                ],
                "content": [
                    {
                        "id": "equipment_currency",
                        "type": "section",
                        "header": [],
                        "content": [
                            {
                                "id": "equipment_currency_cp",
                                "type": "stat",
                                "stat": "copper_pieces",
                                "min_value_allowed": 0,
                                "edit_bottom_sheet_title": {
                                    "type": "constant",
                                    "value": "Copper",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "equipment_currency_sp",
                                "type": "stat",
                                "stat": "silver_pieces",
                                "min_value_allowed": 0,
                                "edit_bottom_sheet_title": {
                                    "type": "constant",
                                    "value": "Silver",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "equipment_currency_ep",
                                "type": "stat",
                                "stat": "electrum_pieces",
                                "min_value_allowed": 0,
                                "edit_bottom_sheet_title": {
                                    "type": "constant",
                                    "value": "Electrum",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "equipment_currency_gp",
                                "type": "stat",
                                "stat": "gold_pieces",
                                "min_value_allowed": 0,
                                "edit_bottom_sheet_title": {
                                    "type": "constant",
                                    "value": "Gold",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "equipment_currency_pp",
                                "type": "stat",
                                "stat": "platinum_pieces",
                                "min_value_allowed": 0,
                                "edit_bottom_sheet_title": {
                                    "type": "constant",
                                    "value": "Platinum",
                                    "value_type": "string"
                                }
                            }
                        ],
                        "show_divider": false,
                        "content_item_min_width": 75,
                        "alignment": "center"
                    },
                    {
                        "id": "equipment_list",
                        "type": "resourceSection",
                        "resource_stat": "equipment",
                        "resource_id": "item",
                        "max_items_in_preview": 5
                    }
                ]
            }
        },
        {
            "id": "attuned_items",
            "view": {
                "id": "attuned_items_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "is_visible": {
                    "type": "not",
                    "components": {
                        "type": "isEmpty",
                        "components": {
                            "type": "stat",
                            "stat": "attuned_resources"
                        }
                    }
                },
                "header": [
                    {
                        "id": "attuned_items_section_icon",
                        "type": "icon",
                        "name": "ic_stars",
                        "color": "#7b1fa2",
                        "size": "medium",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "attuned_items_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Attuned items",
                            "value_type": "string"
                        },
                        "style": "title"
                    }
                ],
                "content": [
                    {
                        "id": "attuned_items_count",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "attuned_resources_count_message"
                        },
                        "style": "text",
                        "margin_top": 4,
                        "margin_bottom": 4,
                        "margin_left": 16
                    },
                    {
                        "id": "attuned_armors_list",
                        "type": "resourceSection",
                        "resource_stat": "attuned_armors",
                        "resource_id": "armor",
                        "max_items_in_preview": 5,
                        "read_only": true
                    },
                    {
                        "id": "attuned_weapons_list",
                        "type": "resourceSection",
                        "resource_stat": "attuned_weapons",
                        "resource_id": "weapon",
                        "max_items_in_preview": 5,
                        "read_only": true
                    },
                    {
                        "id": "attuned_items_list",
                        "type": "resourceSection",
                        "resource_stat": "attuned_items",
                        "resource_id": "item",
                        "max_items_in_preview": 5,
                        "read_only": true
                    }
                ]
            }
        },
        {
            "id": "spell_slots",
            "view": {
                "id": "spell_slots_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 75,
                "collapsible": true,
                "header": [
                    {
                        "id": "spell_slots_section_icon",
                        "type": "icon",
                        "name": "ic_whatshot",
                        "color": "#7b1fa2",
                        "size": "medium",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "spell_slots_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Spell Slots",
                            "value_type": "string"
                        },
                        "style": "title"
                    }
                ],
                "content": [
                    {
                        "id": "spell_slots_1",
                        "type": "stat",
                        "stat": "spell_slots_1",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_2",
                        "type": "stat",
                        "stat": "spell_slots_2",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_3",
                        "type": "stat",
                        "stat": "spell_slots_3",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_4",
                        "type": "stat",
                        "stat": "spell_slots_4",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_5",
                        "type": "stat",
                        "stat": "spell_slots_5",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_6",
                        "type": "stat",
                        "stat": "spell_slots_6",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_7",
                        "type": "stat",
                        "stat": "spell_slots_7",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_8",
                        "type": "stat",
                        "stat": "spell_slots_8",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    },
                    {
                        "id": "spell_slots_9",
                        "type": "stat",
                        "stat": "spell_slots_9",
                        "min_value_allowed": 0,
                        "max_value_allowed": 99
                    }
                ]
            }
        },
        {
            "id": "spells",
            "view": {
                "id": "spells_section",
                "type": "section",
                "show_divider": true,
                "content_item_min_width": 1,
                "collapsible": true,
                "header": [
                    {
                        "id": "spells_section_icon",
                        "type": "icon",
                        "name": "ic_whatshot",
                        "color": "#7b1fa2",
                        "size": "medium",
                        "margin_top": 8,
                        "margin_right": 8,
                        "margin_left": 16
                    },
                    {
                        "id": "spells_section_title",
                        "type": "text",
                        "margin_right": 16,
                        "margin_left": 16,
                        "text": {
                            "type": "constant",
                            "value": "Spells",
                            "value_type": "string"
                        },
                        "style": "title"
                    },
                    {
                        "id": "spells_section_header_spacer",
                        "type": "spacer"
                    },
                    {
                        "id": "spells_section_add_spell",
                        "type": "selectResources",
                        "stat": "spells",
                        "resource_id": "spell",
                        "view_type": "icon",
                        "should_append": true,
                        "should_save_on_selection": true,
                        "filters": {
                            "classes": {
                                "type": "map",
                                "map_value_key": "$class",
                                "components": {
                                    "type": "stat",
                                    "stat": "classes"
                                },
                                "mapper": {
                                    "type": "stat",
                                    "stat": "$class.class.name"
                                }
                            }
                        }
                    }
                ],
                "content": [
                    {
                        "id": "spellcasting_abilities_list",
                        "type": "resourceSection",
                        "resource_stat": "classes",
                        "resource_id": "class_details",
                        "read_only": true,
                        "tap_displays_resource": false
                    },
                    {
                        "id": "cantrips_list",
                        "type": "resourceSection",
                        "resource_stat": "cantrips",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "cantrips_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Cantrips",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "cantrips"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_1_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_1_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_1_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 1",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_1_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_2_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_2_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_2_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 2",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_2_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_3_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_3_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_3_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 3",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_3_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_4_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_4_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_4_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 4",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_4_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_5_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_5_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_5_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 5",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_5_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_6_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_6_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_6_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 6",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_6_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_7_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_7_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_7_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 7",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_7_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_8_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_8_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_8_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 8",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_8_spells"
                                    }
                                }
                            }
                        }
                    },
                    {
                        "id": "level_9_spells_list",
                        "type": "resourceSection",
                        "resource_stat": "level_9_spells",
                        "resource_set_stat": "spells",
                        "resource_id": "spell",
                        "header_view": {
                            "id": "level_9_title",
                            "type": "text",
                            "margin_left": 12,
                            "text": {
                                "type": "constant",
                                "value": "Level 9",
                                "value_type": "string"
                            },
                            "style": "subhead",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "level_9_spells"
                                    }
                                }
                            }
                        }
                    }
                ]
            }
        }
    ],
    "progression_systems": {
        "experience_levelling_system": {
            "level_up_view_title": {
                "type": "concat",
                "components": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": "Level Up to ",
                            "value_type": "string"
                        },
                        {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 1,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        }
                    ]
                }
            },
            "level_up_button_text": "Level Up",
            "level_up_icon": "ic_progression",
            "level_up_icon_color": "#FFB300",
            "level_up_view": {
                "id": "level_up",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "level_up_as_comp",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "level_up_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Level up as a ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "level_up_select_class",
                                "type": "select",
                                "stat": "temp_level_up_class",
                                "resource_options": {
                                    "type": "map",
                                    "components": {
                                        "type": "stat",
                                        "stat": "classes"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.class"
                                    }
                                },
                                "options_display_stat": "name"
                            },
                            {
                                "id": "level_up_select_archetype",
                                "type": "select",
                                "stat": "temp_level_up_archetype",
                                "resource_options": {
                                    "type": "stat",
                                    "stat": "level_up_available_archetypes"
                                },
                                "options_display_stat": "name",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "level_up_has_to_select_archetype"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$view?.level_up_multiclass_check?"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "level_up_multiclass_check",
                        "type": "checkbox",
                        "stat": "temp_level_up_multiclass",
                        "label": {
                            "type": "constant",
                            "value": "I want to multiclass instead",
                            "value_type": "string"
                        },
                        "label_alignment": "right",
                        "style": "checkbox"
                    },
                    {
                        "id": "level_up_new_class",
                        "type": "resource",
                        "view_type": "edit",
                        "resource_id": "class_details",
                        "stat": "temp_level_up_new_class",
                        "create_if_empty": true,
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$view?.level_up_multiclass_check?"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isNull",
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$view?.level_up_new_class?"
                                            },
                                            "default_components": {
                                                "type": "constant",
                                                "value": false,
                                                "value_type": "bool"
                                            }
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "It looks like you're trying to multiclass but haven't selected a new class to multiclass into",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "contains",
                                        "haystack": {
                                            "type": "map",
                                            "components": {
                                                "type": "stat",
                                                "stat": "classes"
                                            },
                                            "mapper": {
                                                "type": "stat",
                                                "stat": "$mapValue.class.name"
                                            }
                                        },
                                        "needle": {
                                            "type": "stat",
                                            "stat": "$view?.level_up_new_class?.$view?.class_details_edit_class_select?.name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You seem to be trying to multiclass but you selected a class you already have levels in. You might want to uncheck the 'multiclass' box or select another class",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "on_level_up_confirm": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "setStat",
                        "stat": "currently_levelling_up",
                        "new_value": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view.level_up_multiclass_check"
                                    }
                                },
                                "effect": {
                                    "type": "setStat",
                                    "stat": "temp_last_level_up_class_id",
                                    "new_value": {
                                        "type": "stat",
                                        "stat": "level_up_selected_class_details.class.id"
                                    },
                                    "aggregation_type": "set"
                                }
                            }
                        ]
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view.level_up_multiclass_check"
                                    }
                                },
                                "effect": {
                                    "type": "forEach",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "level_up_selected_class_details"
                                            }
                                        ]
                                    },
                                    "apply": {
                                        "type": "sequence",
                                        "effects": [
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "stat",
                                                            "stat": "level_up_has_to_select_archetype"
                                                        },
                                                        "effect": {
                                                            "type": "setStat",
                                                            "stat": "$class_details.archetype_id",
                                                            "new_value": {
                                                                "type": "stat",
                                                                "stat": "$view.level_up_select_archetype"
                                                            },
                                                            "aggregation_type": "set"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "addToStat",
                                                "stat": "$class_details.class_level",
                                                "value": {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                },
                                                "aggregation_type": "set"
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "roll",
                                                                        "value_type": "string"
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "hit_point_mode"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "effect": {
                                                            "type": "addToStat",
                                                            "stat": "base_hp",
                                                            "value": {
                                                                "type": "roll",
                                                                "formula": {
                                                                    "type": "concat",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "constant",
                                                                                "value": "1",
                                                                                "value_type": "string"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class_details.class.actual_hit_die"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            },
                                                            "aggregation_type": "set"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "average",
                                                                        "value_type": "string"
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "hit_point_mode"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "effect": {
                                                            "type": "addToStat",
                                                            "stat": "base_hp",
                                                            "value": {
                                                                "type": "stat",
                                                                "stat": "$class_details.hit_die_average"
                                                            },
                                                            "aggregation_type": "set"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "max",
                                                                        "value_type": "string"
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "hit_point_mode"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "effect": {
                                                            "type": "addToStat",
                                                            "stat": "base_hp",
                                                            "value": {
                                                                "type": "stat",
                                                                "stat": "$class_details.hit_die_max"
                                                            },
                                                            "aggregation_type": "set"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    "for_each_value_key": "$class_details"
                                }
                            },
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "$view.level_up_multiclass_check"
                                },
                                "effect": {
                                    "type": "sequence",
                                    "effects": [
                                        {
                                            "type": "forEach",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "$view.level_up_new_class"
                                                    }
                                                ]
                                            },
                                            "apply": {
                                                "type": "sequence",
                                                "effects": [
                                                    {
                                                        "type": "addToStat",
                                                        "stat": "classes",
                                                        "value": {
                                                            "type": "stat",
                                                            "stat": "$forEachValue"
                                                        },
                                                        "aggregation_type": "set"
                                                    },
                                                    {
                                                        "type": "setStat",
                                                        "stat": "temp_last_level_up_class_id",
                                                        "new_value": {
                                                            "type": "stat",
                                                            "stat": "$forEachValue.class.id"
                                                        },
                                                        "aggregation_type": "set"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "type": "when",
                                            "clauses": [
                                                {
                                                    "condition": {
                                                        "type": "equals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "roll",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "hit_point_mode"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "effect": {
                                                        "type": "addToStat",
                                                        "stat": "base_hp",
                                                        "value": {
                                                            "type": "roll",
                                                            "formula": {
                                                                "type": "concat",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "constant",
                                                                            "value": "1",
                                                                            "value_type": "string"
                                                                        },
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "last_level_up_class_details.class.actual_hit_die"
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        },
                                                        "aggregation_type": "set"
                                                    }
                                                },
                                                {
                                                    "condition": {
                                                        "type": "equals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "average",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "hit_point_mode"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "effect": {
                                                        "type": "addToStat",
                                                        "stat": "base_hp",
                                                        "value": {
                                                            "type": "stat",
                                                            "stat": "last_level_up_class_details.hit_die_average"
                                                        },
                                                        "aggregation_type": "set"
                                                    }
                                                },
                                                {
                                                    "condition": {
                                                        "type": "equals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "max",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "hit_point_mode"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "effect": {
                                                        "type": "addToStat",
                                                        "stat": "base_hp",
                                                        "value": {
                                                            "type": "stat",
                                                            "stat": "last_level_up_class_details.hit_die_max"
                                                        },
                                                        "aggregation_type": "set"
                                                    }
                                                }
                                            ]
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "type": "setStat",
                        "stat": "temp_level_up_class",
                        "new_value": {
                            "type": "constant",
                            "value": null,
                            "value_type": "string"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "temp_level_up_archetype",
                        "new_value": {
                            "type": "constant",
                            "value": null,
                            "value_type": "string"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "temp_level_up_multiclass",
                        "new_value": {
                            "type": "constant",
                            "value": null,
                            "value_type": "bool"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "temp_level_up_new_class",
                        "new_value": {
                            "type": "constant",
                            "value": null,
                            "value_type": "resource"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "not",
                                    "components": {
                                        "type": "and",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "level_up_language_proficiency_choices"
                                                    }
                                                },
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "level_up_skill_proficiency_choices"
                                                    }
                                                },
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "level_up_armor_proficiency_choices"
                                                    }
                                                },
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "level_up_weapon_proficiency_choices"
                                                    }
                                                },
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "level_up_tool_proficiency_choices"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                },
                                "effect": {
                                    "type": "showPopUp",
                                    "pop_up_view": {
                                        "id": "level_up_select_proficiencies",
                                        "type": "list",
                                        "alignment": "start",
                                        "subviews": [
                                            {
                                                "id": "level_up_select_proficiencies_languages",
                                                "type": "resourceArray",
                                                "resource_id": "levelled_choice_text",
                                                "stat": "level_up_language_proficiency_choices",
                                                "view_type": "display",
                                                "left_view": {
                                                    "id": "level_up_select_proficiencies_languages_label",
                                                    "type": "text",
                                                    "text": {
                                                        "type": "constant",
                                                        "value": "Languages proficiencies:",
                                                        "value_type": "string"
                                                    },
                                                    "style": "text",
                                                    "bold": true
                                                },
                                                "is_visible": {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "isEmpty",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "level_up_language_proficiency_choices"
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "id": "level_up_select_proficiencies_skills",
                                                "type": "resourceArray",
                                                "resource_id": "levelled_skill_proficiency",
                                                "stat": "level_up_skill_proficiency_choices",
                                                "view_type": "display",
                                                "left_view": {
                                                    "id": "level_up_select_proficiencies_skills_label",
                                                    "type": "text",
                                                    "text": {
                                                        "type": "constant",
                                                        "value": "Skill proficiencies:",
                                                        "value_type": "string"
                                                    },
                                                    "style": "text",
                                                    "bold": true
                                                },
                                                "is_visible":  {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "isEmpty",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "level_up_skill_proficiency_choices"
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "id": "level_up_select_proficiencies_armors",
                                                "type": "resourceArray",
                                                "resource_id": "levelled_armor_proficiency",
                                                "stat": "level_up_armor_proficiency_choices",
                                                "view_type": "display",
                                                "left_view": {
                                                    "id": "level_up_select_proficiencies_armors_label",
                                                    "type": "text",
                                                    "text": {
                                                        "type": "constant",
                                                        "value": "Armor proficiencies:",
                                                        "value_type": "string"
                                                    },
                                                    "style": "text",
                                                    "bold": true
                                                },
                                                "is_visible": {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "isEmpty",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "level_up_armor_proficiency_choices"
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "id": "level_up_select_proficiencies_weapons",
                                                "type": "resourceArray",
                                                "resource_id": "levelled_choice_text",
                                                "stat": "level_up_weapon_proficiency_choices",
                                                "view_type": "display",
                                                "left_view": {
                                                    "id": "level_up_select_proficiencies_weapons_label",
                                                    "type": "text",
                                                    "text": {
                                                        "type": "constant",
                                                        "value": "Weapon proficiencies:",
                                                        "value_type": "string"
                                                    },
                                                    "style": "text",
                                                    "bold": true
                                                },
                                                "is_visible": {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "isEmpty",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "level_up_weapon_proficiency_choices"
                                                        }
                                                    }
                                                }
                                            },
                                            {
                                                "id": "level_up_select_proficiencies_tools",
                                                "type": "resourceArray",
                                                "resource_id": "levelled_choice_text",
                                                "stat": "level_up_tool_proficiency_choices",
                                                "view_type": "display",
                                                "left_view": {
                                                    "id": "level_up_select_proficiencies_tools_label",
                                                    "type": "text",
                                                    "text": {
                                                        "type": "constant",
                                                        "value": "Tool proficiencies:",
                                                        "value_type": "string"
                                                    },
                                                    "style": "text",
                                                    "bold": true
                                                },
                                                "is_visible": {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "isEmpty",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "level_up_tool_proficiency_choices"
                                                        }
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    "pop_up_title": {
                                        "type": "constant",
                                        "value": "Select additional proficiencies",
                                        "value_type": "string"
                                    },
                                    "pop_up_type": "alert",
                                    "dismissible": false,
                                    "display_cancel_button": false,
                                    "display_save_button": false,
                                    "should_persist_on_save": false,
                                    "extra_buttons": [
                                        {
                                            "text": {
                                                "type": "constant",
                                                "value": "SAVE",
                                                "value_type": "string"
                                            }, 
                                            "event": {
                                                "name": "level_up_set_proficiencies",
                                                "value": "level_up_set_proficiencies"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "should_show_asi"
                                },
                                "effect": {
                                    "type": "showPopUp",
                                    "pop_up_view": {
                                        "id": "asi_list",
                                        "type": "list",
                                        "subviews": [
                                            {
                                                "id": "asi_feat_selection_comp",
                                                "type": "composite",
                                                "subviews": [
                                                    {
                                                        "id": "asi_feat_label",
                                                        "type": "text",
                                                        "text": {
                                                            "type": "constant",
                                                            "value": "Feat: ",
                                                            "value_type": "string"
                                                        },
                                                        "style": "text"
                                                    },
                                                    {
                                                        "id": "asi_feat_selection",
                                                        "type": "selectResources",
                                                        "stat": "temp_asi_feat_selection",
                                                        "resource_id": "feat",
                                                        "filters": {
                                                            "type": {
                                                                "type": "when",
                                                                "clauses": [
                                                                    {
                                                                        "condition": {
                                                                            "type": "greaterThanEquals",
                                                                            "components": {
                                                                                "type": "list",
                                                                                "components": [
                                                                                    {
                                                                                        "type": "stat",
                                                                                        "stat": "level"
                                                                                    },
                                                                                    {
                                                                                        "type": "constant",
                                                                                        "value": 19,
                                                                                        "value_type": "integer"
                                                                                    }
                                                                                ]
                                                                            }
                                                                        },
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "epic_boon",
                                                                                    "value_type": "string"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "general",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    {
                                                                        "condition": {
                                                                            "type": "constant",
                                                                            "value": true,
                                                                            "value_type": "bool"
                                                                        },
                                                                        "components": {
                                                                            "type": "constant",
                                                                            "value": "general",
                                                                            "value_type": "string"
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    },
                                    "pop_up_type": "alert",
                                    "dismissible": false,
                                    "pop_up_title": {
                                        "type": "constant",
                                        "value": "Ability score increase",
                                        "value_type": "string"
                                    },
                                    "display_cancel_button": false,
                                    "should_persist_on_save": false,
                                    "extra_buttons": [
                                        {
                                            "text": {
                                                "type": "constant",
                                                "value": "SAVE",
                                                "value_type": "string"
                                            }, 
                                            "event": {
                                                "name": "level_up_asi",
                                                "value": "level_up_asi"
                                            }
                                        }
                                    ],
                                    "in_edit_mode": true
                                }
                            }
                        ]
                    },
                    {
                        "type": "forEach",
                        "components": {
                            "type": "stat",
                            "stat": "features_with_new_descriptions_in_new_level"
                        },
                        "apply": {
                            "type": "showPopUp",
                            "pop_up_view": {
                                "id": "level_up_feature_diff_text",
                                "type": "diffText",
                                "margin_top": 8,
                                "original_text": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$feat.previous_level_levelled_description?.description?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "",
                                        "value_type": "string"
                                    }
                                },
                                "new_text": {
                                    "type": "stat",
                                    "stat": "$feat.current_level_levelled_description.description"
                                }
                            },
                            "pop_up_type": "alert",
                            "pop_up_title": {
                                "type": "stat",
                                "stat": "$feat.name"
                            },
                            "cancel_text": {
                                "type": "constant",
                                "value": "OK",
                                "value_type": "string"
                            }
                        },
                        "for_each_value_key": "$feat"
                    },
                    {
                        "type": "forEach",
                        "components": {
                            "type": "stat",
                            "stat": "selectable_features_with_new_amounts_in_new_level"
                        },
                        "apply": {
                            "type": "showResource",
                            "resource": {
                                "type": "stat",
                                "stat": "$feat"
                            }
                        },
                        "for_each_value_key": "$feat"
                    },
                    {
                        "type": "setStat",
                        "stat": "currently_levelling_up",
                        "new_value": {
                            "type": "constant",
                            "value": false,
                            "value_type": "bool"
                        },
                        "aggregation_type": "set"
                    }
                ]
            },
            "experience_name": "experience",
            "experience_abbreviation": "exp",
            "level_stat_name": "level",
            "milestones_system_name": "Milestones",
            "tables": [
                {
                    "id": "default",
                    "name": "Default",
                    "experience_to_level_table": {
                        "0": 1,
                        "300": 2,
                        "900": 3,
                        "2700": 4,
                        "6500": 5,
                        "14000": 6,
                        "23000": 7,
                        "34000": 8,
                        "48000": 9,
                        "64000": 10,
                        "85000": 11,
                        "100000": 12,
                        "120000": 13,
                        "140000": 14,
                        "165000": 15,
                        "195000": 16,
                        "225000": 17,
                        "265000": 18,
                        "305000": 19,
                        "355000": 20
                    }
                }
            ]
        }
    },
    "mechanics": [
        {
            "id": "roll_stat",
            "event_names": "rollStat",
            "effects": {
                "type": "roll",
                "rolls": {
                    "type": "list",
                    "components": [
                        {
                            "type": "rollable",
                            "formulas": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "contains",
                                            "haystack": {
                                                "type": "stat",
                                                "stat": "advantages"
                                            },
                                            "needle": {
                                                "type": "stat",
                                                "stat": "$event.stat"
                                            }
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "concat",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "constant",
                                                                "value": "max(2d20) + ",
                                                                "value_type": "string"
                                                            },
                                                            {
                                                                "type": "metaStat",
                                                                "meta_stat": {
                                                                    "type": "stat",
                                                                    "stat": "$event.stat"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "contains",
                                            "haystack": {
                                                "type": "stat",
                                                "stat": "all_disadvantages"
                                            },
                                            "needle": {
                                                "type": "stat",
                                                "stat": "$event.stat"
                                            }
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "concat",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "constant",
                                                                "value": "min(2d20) + ",
                                                                "value_type": "string"
                                                            },
                                                            {
                                                                "type": "metaStat",
                                                                "meta_stat": {
                                                                    "type": "stat",
                                                                    "stat": "$event.stat"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "concat",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "constant",
                                                                "value": "1d20 + ",
                                                                "value_type": "string"
                                                            },
                                                            {
                                                                "type": "metaStat",
                                                                "meta_stat": {
                                                                    "type": "stat",
                                                                    "stat": "$event.stat"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            "text": {
                                "type": "stat",
                                "stat": "$event.statName"
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "remove_empty_items",
            "event_names": "remove_empty_items",
            "effects": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "equipment"
                                    },
                                    "filter": {
                                        "type": "lessThanEquals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.quantity"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        },
                        "effect": {
                            "type": "setStat",
                            "stat": "equipment",
                            "new_value": {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "equipment"
                                },
                                "filter": {
                                    "type": "greaterThan",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.quantity"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 0,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                }
                            },
                            "aggregation_type": "set"
                        }
                    }
                ]
            }
        },
        {
            "id": "skill_tap",
            "event_names": "skillTap",
            "effects": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "stat",
                            "stat": "$edit_mode"
                        },
                        "effect": {
                            "type": "forwardEvent",
                            "new_event_names": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "editSkillProficiency",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "condition": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "$edit_mode"
                            }
                        },
                        "effect": {
                            "type": "forwardEvent",
                            "new_event_names": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "rollStat",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "edit_skill_proficiency",
            "event_names": "editSkillProficiency",
            "effects": {
                "type": "showPopUp",
                "pop_up_view": {
                    "id": "edit_skill_proficiency_select",
                    "type": "select",
                    "meta_stat": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$show_pop_up_event?.stat?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": "_proficiency",
                                    "value_type": "string"
                                }
                            ]
                        }
                    },
                    "options": "skill_proficiency_types",
                    "style": "list"
                },
                "pop_up_title": {
                    "type": "defaultIfNull",
                    "components": {
                        "type": "stat",
                        "stat": "$show_pop_up_event?.statName?"
                    },
                    "default_components": {
                        "type": "constant",
                        "value": "",
                        "value_type": "string"
                    }
                },
                "display_cancel_button": true,
                "display_save_button": true,
                "should_persist_on_save": true
            }
        },
        {
            "id": "change_skill_sort_to_name",
            "event_names": "sort_by_ability",
            "effects": {
                "type": "setStat",
                "stat": "sort_skills_by_name",
                "new_value": {
                    "type": "constant",
                    "value": false,
                    "value_type": "bool"
                },
                "aggregation_type": "set"
            }
        },
        {
            "id": "change_skill_sort_to_ability",
            "event_names": "sort_by_name",
            "effects": {
                "type": "setStat",
                "stat": "sort_skills_by_name",
                "new_value": {
                    "type": "constant",
                    "value": true,
                    "value_type": "bool"
                },
                "aggregation_type": "set"
            }
        },
        {
            "id": "remove_condition",
            "event_names": "remove_condition",
            "effects": {
                "type": "setStat",
                "meta_stat": {
                    "type": "stat",
                    "stat": "$event.condition"
                },
                "new_value": {
                    "type": "constant",
                    "value": false,
                    "value_type": "bool"
                },
                "aggregation_type": "set"
            }
        },
        {
            "id": "show_information",
            "event_names": "show_information",
            "effects": {
                "type": "showPopUp",
                "pop_up_view": {
                    "id": "information_bottom_sheet",
                    "type": "list",
                    "padding": 16,
                    "subviews": [
                        {
                            "id": "information_background_comp",
                            "type": "composite",
                            "subviews": [
                                {
                                    "id": "information_background_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Background: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                {
                                    "id": "information_background",
                                    "type": "text",
                                    "text": {
                                        "type": "stat",
                                        "stat": "background.name"
                                    },
                                    "style": "text"
                                }
                            ]
                        },
                        {
                            "id": "information_alignment_comp",
                            "type": "composite",
                            "margin_top": 4,
                            "subviews": [
                                {
                                    "id": "information_alignment_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Alignment: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                {
                                    "id": "information_alignment",
                                    "type": "text",
                                    "text": {
                                        "type": "enumeratedName",
                                        "enumerated_type": "alignments",
                                        "id": {
                                            "type": "stat",
                                            "stat": "alignment"
                                        }
                                    },
                                    "style": "text"
                                }
                            ]
                        },
                        {
                            "id": "information_personality_traits",
                            "type": "text",
                            "margin_top": 16,
                            "text": {
                                "type": "stat",
                                "stat": "personality_traits"
                            },
                            "style": "text",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "personality_traits"
                                    }
                                }
                            }
                        },
                        {
                            "id": "information_ideals",
                            "type": "text",
                            "margin_top": 5,
                            "text": {
                                "type": "stat",
                                "stat": "ideals"
                            },
                            "style": "text",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "ideals"
                                    }
                                }
                            }
                        },
                        {
                            "id": "information_bonds",
                            "type": "text",
                            "margin_top": 5,
                            "text": {
                                "type": "stat",
                                "stat": "bonds"
                            },
                            "style": "text",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "bonds"
                                    }
                                }
                            }
                        },
                        {
                            "id": "information_flaws",
                            "type": "text",
                            "margin_top": 5,
                            "text": {
                                "type": "stat",
                                "stat": "flaws"
                            },
                            "style": "text",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "flaws"
                                    }
                                }
                            }
                        },
                        {
                            "id": "information_about",
                            "type": "text",
                            "margin_top": 5,
                            "text": {
                                "type": "stat",
                                "stat": "about"
                            },
                            "style": "text",
                            "is_visible": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "about"
                                    }
                                }
                            }
                        },
                        {
                            "id": "information_language_proficiencies_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Languages:",
                                "value_type": "string"
                            },
                            "margin_top": 16,
                            "style": "text",
                            "bold": true
                        },
                        {
                            "id": "information_language_proficiencies",
                            "type": "text",
                            "text": {
                                "type": "joinToString",
                                "separator": ", ",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                }
                            },
                            "style": "text"
                        },
                        {
                            "id": "information_armor_proficiencies_label",
                            "type": "text",
                            "margin_top": 16,
                            "text": {
                                "type": "constant",
                                "value": "Armor proficiencies:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        {
                            "id": "information_armor_proficiencies",
                            "type": "text",
                            "text": {
                                "type": "joinToString",
                                "separator": ", ",
                                "components": {
                                    "type": "map",
                                    "components": {
                                        "type": "stat",
                                        "stat": "armor_proficiencies"
                                    },
                                    "mapper": {
                                        "type": "enumeratedName",
                                        "enumerated_type": "armor_types",
                                        "id": {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    }
                                }
                            },
                            "style": "text"
                        },
                        {
                            "id": "information_weapon_proficiencies_label",
                            "type": "text",
                            "margin_top": 16,
                            "text": {
                                "type": "constant",
                                "value": "Weapon proficiencies:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        {
                            "id": "information_weapon_proficiencies",
                            "type": "text",
                            "text": {
                                "type": "joinToString",
                                "separator": ", ",
                                "components": {
                                    "type": "map",
                                    "components": {
                                        "type": "stat",
                                        "stat": "weapon_proficiencies"
                                    },
                                    "mapper": {
                                        "type": "enumeratedName",
                                        "enumerated_type": "weapon_types_plus_all_types",
                                        "id": {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    }
                                }
                            },
                            "style": "text"
                        },
                        {
                            "id": "information_tool_proficiencies_label",
                            "type": "text",
                            "margin_top": 16,
                            "text": {
                                "type": "constant",
                                "value": "Tools:",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        {
                            "id": "information_tool_proficiencies",
                            "type": "text",
                            "text": {
                                "type": "joinToString",
                                "separator": ", ",
                                "components": {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                }
                            },
                            "style": "text"
                        }
                    ]
                },
                "pop_up_title": {
                    "type": "concat",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "constant",
                                "value": "About ",
                                "value_type": "string"
                            },
                            {
                                "type": "stat",
                                "stat": "name"
                            }
                        ]
                    }
                },
                "display_cancel_button": false
            }
        },
        {
            "id": "on_dusk",
            "event_names": "dusk",
            "effects": {
                "type": "showMessage",
                "message": {
                    "type": "constant",
                    "value": "The day has faded into dusk...",
                    "value_type": "string"
                },
                "message_type": "info"
            }
        },
        {
            "id": "on_dawn",
            "event_names": "dawn",
            "effects": {
                "type": "showMessage",
                "message": {
                    "type": "constant",
                    "value": "Night yields to the light of day...",
                    "value_type": "string"
                },
                "message_type": "info"
            }
        },
        {
            "id": "on_long_rest",
            "event_names": "long_rest",
            "effects": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "showMessage",
                        "message": {
                            "type": "constant",
                            "value": "You're feeling well rested. Your HP, spell slots and appropriate hit dice have been restored.",
                            "value_type": "string"
                        },
                        "message_type": "info"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_hp",
                        "new_value": {
                            "type": "stat",
                            "stat": "max_hp"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d4_hit_dice",
                        "new_value": {
                            "type": "stat",
                            "stat": "max_d4_hit_dice"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d6_hit_dice",
                        "new_value": {
                            "type": "stat",
                            "stat": "max_d6_hit_dice"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d8_hit_dice",
                        "new_value": {
                            "type": "stat",
                            "stat": "max_d8_hit_dice"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d10_hit_dice",
                        "new_value": {
                            "type": "stat",
                            "stat": "max_d10_hit_dice"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d12_hit_dice",
                        "new_value": {
                            "type": "stat",
                            "stat": "max_d12_hit_dice"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d20_hit_dice",
                        "new_value": {
                            "type": "stat",
                            "stat": "max_d20_hit_dice"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_1",
                        "new_value": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "is_single_third_level_caster"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "lessThanEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 2,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 3,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 2,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "lessThanEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 6,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 3,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 4,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_1_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_1_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 0,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 1,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 2,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 2,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 3,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 4,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_1_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_1_bonus"
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_2",
                        "new_value": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "is_single_third_level_caster"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "lessThanEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 6,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "lessThanEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 9,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 2,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 3,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_2_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_2_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "lessThan",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 3,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 3,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 2,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 3,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_2_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_2_bonus"
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_3",
                        "new_value": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "is_single_third_level_caster"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "lessThanEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 12,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "lessThanEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 15,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 2,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 3,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_3_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_3_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "lessThan",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 5,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 5,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 2,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 3,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_3_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_3_bonus"
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_4",
                        "new_value": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "is_single_third_level_caster"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "lessThanEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "first_third_level_caster_class.class_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 18,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 1,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_4_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_4_bonus"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "add",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "lessThan",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 7,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 7,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 1,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "spellcaster_level"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 8,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 2,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "constant",
                                                                "value": 3,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    ]
                                                },
                                                {
                                                    "type": "add",
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "map",
                                                            "map_value_key": "$class",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "custom_spell_slot_classes"
                                                            },
                                                            "mapper": {
                                                                "type": "findFirst",
                                                                "components": {
                                                                    "type": "sortBy",
                                                                    "order": "desc",
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$class.class.actual_spell_slots_level_4_per_level"
                                                                    },
                                                                    "sort_by_selector": {
                                                                        "type": "stat",
                                                                        "stat": "$sortByValue.level"
                                                                    }
                                                                },
                                                                "filter": {
                                                                    "type": "lessThanEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$findFirstValue.level"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$class.class_level"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        },
                                                        "mapper": {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$mapValue?.amount"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "max_spell_slots_4_bonus"
                                                }
                                            ]
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_5",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 9,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 9,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 18,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 3,
                                                    "value_type": "integer"
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "custom_spell_slot_classes"
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_5_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "max_spell_slots_5_bonus"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_6",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 11,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 19,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "custom_spell_slot_classes"
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_6_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "max_spell_slots_6_bonus"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_7",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 13,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 20,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 2,
                                                    "value_type": "integer"
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "custom_spell_slot_classes"
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_7_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "max_spell_slots_7_bonus"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_8",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 15,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "custom_spell_slot_classes"
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_8_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "max_spell_slots_8_bonus"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_9",
                        "new_value": {
                            "type": "add",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "lessThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "spellcaster_level"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 17,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "custom_spell_slot_classes"
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_9_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "max_spell_slots_9_bonus"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    }
                ]
            }
        },
        {
            "id": "on_short_rest",
            "event_names": "short_rest",
            "effects": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "showMessage",
                        "message": {
                            "type": "constant",
                            "value": "You've rested for a bit. Your HP and Hit Dice have been updated accordingly",
                            "value_type": "string"
                        },
                        "message_type": "info"
                    },
                    {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.short_rest_hit_dice_d4_stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.short_rest_hit_dice_d6_stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.short_rest_hit_dice_d8_stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.short_rest_hit_dice_d10_stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.short_rest_hit_dice_d12_stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.short_rest_hit_dice_d20_stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "roll",
                                    "rolls": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "rollable",
                                                "formulas": {
                                                    "type": "flatAppend",
                                                    "components": [
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "$view.short_rest_hit_dice_d4_stat"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": 0,
                                                                                    "value_type": "integer"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "concat",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.short_rest_hit_dice_d4_stat"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "d4",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": []
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "$view.short_rest_hit_dice_d6_stat"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": 0,
                                                                                    "value_type": "integer"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "concat",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.short_rest_hit_dice_d6_stat"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "d6",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": []
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "$view.short_rest_hit_dice_d8_stat"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": 0,
                                                                                    "value_type": "integer"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "concat",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.short_rest_hit_dice_d8_stat"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "d8",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": []
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "$view.short_rest_hit_dice_d10_stat"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": 0,
                                                                                    "value_type": "integer"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "concat",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.short_rest_hit_dice_d10_stat"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "d10",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": []
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "$view.short_rest_hit_dice_d12_stat"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": 0,
                                                                                    "value_type": "integer"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "concat",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.short_rest_hit_dice_d12_stat"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "d12",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": []
                                                                    }
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "$view.short_rest_hit_dice_d20_stat"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": 0,
                                                                                    "value_type": "integer"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "concat",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.short_rest_hit_dice_d20_stat"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "d20",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": []
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                "text": {
                                                    "type": "constant",
                                                    "value": "hit dice rolls",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    },
                                    "on_result_effect": {
                                        "type": "setStat",
                                        "stat": "current_hp",
                                        "new_value": {
                                            "type": "min",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "max_hp"
                                                    },
                                                    {
                                                        "type": "add",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$event.result"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "current_hp"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        "aggregation_type": "set"
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d4_hit_dice",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "subtract",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "current_d4_hit_dice"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.short_rest_hit_dice_d4_stat"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d6_hit_dice",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "subtract",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "current_d6_hit_dice"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.short_rest_hit_dice_d6_stat"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d8_hit_dice",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "subtract",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "current_d8_hit_dice"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.short_rest_hit_dice_d8_stat"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d10_hit_dice",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "subtract",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "current_d10_hit_dice"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.short_rest_hit_dice_d10_stat"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d12_hit_dice",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "subtract",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "current_d12_hit_dice"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.short_rest_hit_dice_d12_stat"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "current_d20_hit_dice",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "subtract",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "current_d20_hit_dice"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.short_rest_hit_dice_d20_stat"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_1",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_1"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_1_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_2",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_2"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_2_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_3",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_3"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_3_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_4",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_4"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_4_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_5",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_5"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_5_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_6",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_6"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_6_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_7",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_7"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_7_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_8",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_8"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_8_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "spell_slots_9",
                        "new_value": {
                            "type": "max",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "spell_slots_9"
                                    },
                                    {
                                        "type": "add",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "map",
                                                "map_value_key": "$class",
                                                "components": {
                                                    "type": "filter",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "custom_spell_slot_classes"
                                                    },
                                                    "filter": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.class.actual_recharge_slots_on_short_rest"
                                                    }
                                                },
                                                "mapper": {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "order": "desc",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$class.class.actual_spell_slots_level_9_per_level"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        }
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$class.class_level"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            },
                                            "mapper": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue?.amount"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            }
                                        }
                                    }
                                ]
                            }
                        },
                        "aggregation_type": "set"
                    }
                ]
            }
        },
        {
            "id": "trigger_long_rest",
            "event_names": "trigger_long_rest",
            "effects": {
                "type": "showPopUp",
                "pop_up_view": {
                    "id": "long_rest_bottom_sheet",
                    "type": "list",
                    "padding": 32,
                    "subviews": [
                        {
                            "id": "bottom_sheet_long_rest_label",
                            "type": "text",
                            "margin_top": 16,
                            "text": {
                                "type": "constant",
                                "value": "Does your DM approve?",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    ]
                },
                "pop_up_title": {
                    "type": "constant",
                    "value": "Long Rest",
                    "value_type": "string"
                },
                "display_cancel_button": true,
                "extra_buttons": [
                    {
                        "text": {
                            "type": "constant",
                            "value": "REST",
                            "value_type": "string"
                        },
                        "event": {
                            "name": "long_rest",
                            "payload": {}
                        }
                    }
                ]
            }
        },
        {
            "id": "trigger_short_rest",
            "event_names": "trigger_short_rest",
            "effects": {
                "type": "showPopUp",
                "pop_up_view": {
                    "id": "short_rest_bottom_sheet",
                    "type": "list",
                    "padding": 16,
                    "subviews": [
                        {
                            "id": "bottom_sheet_short_rest_label",
                            "type": "text",
                            "margin_top": 16,
                            "text": {
                                "type": "constant",
                                "value": "Select how many Hit Dice you want to spend",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        {
                            "id": "short_rest_hit_dice_section",
                            "type": "section",
                            "header": [],
                            "show_divider": false,
                            "content_item_min_width": 100,
                            "collapsible": false,
                            "content": [
                                {
                                    "id": "short_rest_hit_dice_d4_stat",
                                    "type": "stat",
                                    "stat": "temp_short_rest_hit_dice_d4",
                                    "change_amount": 1,
                                    "min_value_allowed": 0,
                                    "calculated_max_value_allowed": {
                                        "type": "stat",
                                        "stat": "current_d4_hit_dice"
                                    }
                                },
                                {
                                    "id": "short_rest_hit_dice_d6_stat",
                                    "type": "stat",
                                    "stat": "temp_short_rest_hit_dice_d6",
                                    "change_amount": 1,
                                    "min_value_allowed": 0,
                                    "calculated_max_value_allowed": {
                                        "type": "stat",
                                        "stat": "current_d6_hit_dice"
                                    }
                                },
                                {
                                    "id": "short_rest_hit_dice_d8_stat",
                                    "type": "stat",
                                    "stat": "temp_short_rest_hit_dice_d8",
                                    "change_amount": 1,
                                    "min_value_allowed": 0,
                                    "calculated_max_value_allowed": {
                                        "type": "stat",
                                        "stat": "current_d8_hit_dice"
                                    }
                                },
                                {
                                    "id": "short_rest_hit_dice_d10_stat",
                                    "type": "stat",
                                    "stat": "temp_short_rest_hit_dice_d10",
                                    "change_amount": 1,
                                    "min_value_allowed": 0,
                                    "calculated_max_value_allowed": {
                                        "type": "stat",
                                        "stat": "current_d10_hit_dice"
                                    }
                                },
                                {
                                    "id": "short_rest_hit_dice_d12_stat",
                                    "type": "stat",
                                    "stat": "temp_short_rest_hit_dice_d12",
                                    "change_amount": 1,
                                    "min_value_allowed": 0,
                                    "calculated_max_value_allowed": {
                                        "type": "stat",
                                        "stat": "current_d12_hit_dice"
                                    }
                                },
                                {
                                    "id": "short_rest_hit_dice_d20_stat",
                                    "type": "stat",
                                    "stat": "temp_short_rest_hit_dice_d20",
                                    "change_amount": 1,
                                    "min_value_allowed": 0,
                                    "calculated_max_value_allowed": {
                                        "type": "stat",
                                        "stat": "current_d20_hit_dice"
                                    }
                                }
                            ]
                        }
                    ]
                },
                "pop_up_title": {
                    "type": "constant",
                    "value": "Short Rest ",
                    "value_type": "string"
                },
                "display_cancel_button": true,
                "extra_buttons": [
                    {
                        "text": {
                            "type": "constant",
                            "value": "REST",
                            "value_type": "string"
                        },
                        "event": {
                            "name": "short_rest",
                            "payload": {}
                        }
                    }
                ],
                "in_edit_mode": true
            }
        },
        {
            "id": "saving_throws_stabilize",
            "event_names": "death_saves_stabilize",
            "effects": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "setStat",
                        "stat": "current_hp",
                        "new_value": {
                            "type": "constant",
                            "value": 1,
                            "value_type": "integer"
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "showMessage",
                        "message": {
                            "type": "constant",
                            "value": "Stabilized with 1 HP",
                            "value_type": "string"
                        },
                        "message_type": "info"
                    }
                ]
            }
        },
        {
            "id": "saving_throws",
            "event_names": "rpg_onUpdate",
            "effects": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "death_saving_throws_success_1"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "death_saving_throws_success_2"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "death_saving_throws_success_3"
                                    }
                                ]
                            }
                        },
                        "effect": {
                            "type": "fireEvent",
                            "event": {
                                "name": "death_saves_stabilize",
                                "payload": {}
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "saving_throws_roll",
            "event_names": "death_saves_roll",
            "effects": {
                "type": "roll",
                "rolls": {
                    "type": "list",
                    "components": [
                        {
                            "type": "rollable",
                            "formulas": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "1d20",
                                        "value_type": "string"
                                    }
                                ]
                            },
                            "text": {
                                "type": "constant",
                                "value": "death save",
                                "value_type": "string"
                            }
                        }
                    ]
                },
                "on_result_effect": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "equals",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$event.result"
                                        },
                                        {
                                            "type": "constant",
                                            "value": 20,
                                            "value_type": "integer"
                                        }
                                    ]
                                }
                            },
                            "effect": {
                                "type": "fireEvent",
                                "event": {
                                    "name": "death_saves_stabilize",
                                    "payload": {}
                                }
                            }
                        },
                        {
                            "condition": {
                                "type": "equals",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$event.result"
                                        },
                                        {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    ]
                                }
                            },
                            "effect": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_failure_1"
                                            }
                                        },
                                        "effect": {
                                            "type": "sequence",
                                            "effects": [
                                                {
                                                    "type": "setStat",
                                                    "stat": "death_saving_throws_failure_1",
                                                    "new_value": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "aggregation_type": "set"
                                                },
                                                {
                                                    "type": "setStat",
                                                    "stat": "death_saving_throws_failure_2",
                                                    "new_value": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "aggregation_type": "set"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_failure_2"
                                            }
                                        },
                                        "effect": {
                                            "type": "sequence",
                                            "effects": [
                                                {
                                                    "type": "setStat",
                                                    "stat": "death_saving_throws_failure_2",
                                                    "new_value": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "aggregation_type": "set"
                                                },
                                                {
                                                    "type": "setStat",
                                                    "stat": "death_saving_throws_failure_3",
                                                    "new_value": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "aggregation_type": "set"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_failure_3"
                                            }
                                        },
                                        "effect": {
                                            "type": "sequence",
                                            "effects": [
                                                {
                                                    "type": "setStat",
                                                    "stat": "death_saving_throws_failure_3",
                                                    "new_value": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "aggregation_type": "set"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "condition": {
                                "type": "greaterThanEquals",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$event.result"
                                        },
                                        {
                                            "type": "constant",
                                            "value": 10,
                                            "value_type": "integer"
                                        }
                                    ]
                                }
                            },
                            "effect": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_success_1"
                                            }
                                        },
                                        "effect": {
                                            "type": "setStat",
                                            "stat": "death_saving_throws_success_1",
                                            "new_value": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "aggregation_type": "set"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_success_2"
                                            }
                                        },
                                        "effect": {
                                            "type": "setStat",
                                            "stat": "death_saving_throws_success_2",
                                            "new_value": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "aggregation_type": "set"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_success_3"
                                            }
                                        },
                                        "effect": {
                                            "type": "sequence",
                                            "effects": [
                                                {
                                                    "type": "setStat",
                                                    "stat": "death_saving_throws_success_3",
                                                    "new_value": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "aggregation_type": "set"
                                                },
                                                {
                                                    "type": "fireEvent",
                                                    "event": {
                                                        "name": "death_saves_stabilize",
                                                        "payload": {}
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "condition": {
                                "type": "lessThan",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$event.result"
                                        },
                                        {
                                            "type": "constant",
                                            "value": 10,
                                            "value_type": "integer"
                                        }
                                    ]
                                }
                            },
                            "effect": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_failure_1"
                                            }
                                        },
                                        "effect": {
                                            "type": "setStat",
                                            "stat": "death_saving_throws_failure_1",
                                            "new_value": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "aggregation_type": "set"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_failure_2"
                                            }
                                        },
                                        "effect": {
                                            "type": "setStat",
                                            "stat": "death_saving_throws_failure_2",
                                            "new_value": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "aggregation_type": "set"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "death_saving_throws_failure_3"
                                            }
                                        },
                                        "effect":{
                                            "type": "setStat",
                                            "stat": "death_saving_throws_failure_3",
                                            "new_value": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "aggregation_type": "set"
                                        }
                                    }
                                ]
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "reset_saving_throws",
            "event_names": "set_current_hp",
            "effects": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "current_hp"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "effect": {
                            "type": "sequence",
                            "effects": [
                                {
                                    "type": "setStat",
                                    "stat": "death_saving_throws_success_1",
                                    "new_value": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "aggregation_type": "set"
                                },
                                {
                                    "type": "setStat",
                                    "stat": "death_saving_throws_success_2",
                                    "new_value": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "aggregation_type": "set"
                                },
                                {
                                    "type": "setStat",
                                    "stat": "death_saving_throws_success_3",
                                    "new_value": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "aggregation_type": "set"
                                },
                                {
                                    "type": "setStat",
                                    "stat": "death_saving_throws_failure_1",
                                    "new_value": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "aggregation_type": "set"
                                },
                                {
                                    "type": "setStat",
                                    "stat": "death_saving_throws_failure_2",
                                    "new_value": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "aggregation_type": "set"
                                },
                                {
                                    "type": "setStat",
                                    "stat": "death_saving_throws_failure_3",
                                    "new_value": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "aggregation_type": "set"
                                }
                            ]
                        }
                    }
                ]
            }
        },
        {
            "id": "level_up_set_proficiencies",
            "event_names": "level_up_set_proficiencies",
            "effects": {
                "type": "sequence",
                "effects": [
                    {
                        "type": "setStat",
                        "stat": "language_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "flatMap",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.level_up_select_proficiencies_languages"
                                        },
                                        "mapper": {
                                            "type": "split",
                                            "separator": "\\\\s*,\\\\s*",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$mapValue.$view.levelled_choice_text_display_in_character"
                                            }
                                        }
                                    },
                                    "mapper": {
                                        "type": "trim",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "armor_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view.level_up_select_proficiencies_armors"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.$view.levelled_armor_proficiency_display_in_character"
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "forEach",
                        "components": {
                            "type": "stat",
                            "stat": "$view.level_up_select_proficiencies_skills"
                        },
                        "apply": {
                            "type": "setStat",
                            "meta_stat": {
                                "type": "concat",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$forEachValue.$view.levelled_skill_proficiency_display_in_character"
                                        },
                                        {
                                            "type": "constant",
                                            "value": "_proficiency",
                                            "value_type": "string"
                                        }
                                    ]
                                }
                            },
                            "new_value": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "stat",
                                            "stat": "$forEachValue.is_expertise"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "expert",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "proficient",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            },
                            "aggregation_type": "set"
                        }
                    },
                    {
                        "type": "setStat",
                        "stat": "weapon_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view.level_up_select_proficiencies_weapons"
                                    },
                                    "mapper": {
                                        "type": "stat",
                                        "stat": "$mapValue.$view.levelled_weapon_proficiency_display_in_character"
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    },
                    {
                        "type": "setStat",
                        "stat": "tool_proficiencies",
                        "new_value": {
                            "type": "flatAppend",
                            "treat_as_set": true,
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                },
                                {
                                    "type": "map",
                                    "components": {
                                        "type": "flatMap",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.level_up_select_proficiencies_tools"
                                        },
                                        "mapper": {
                                            "type": "split",
                                            "separator": "\\\\s*,\\\\s*",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$mapValue.$view.levelled_choice_text_display_in_character"
                                            }
                                        }
                                    },
                                    "mapper": {
                                        "type": "trim",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    }
                                }
                            ]
                        },
                        "aggregation_type": "set"
                    }
                ]
            }
        },
        {
            "id": "level_up_asi",
            "event_names": "level_up_asi",
            "effects": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "notNull",
                            "components": {
                                "type": "stat",
                                "stat": "$view.asi_feat_selection"
                            }
                        },
                        "effect": {
                            "type": "addToStat",
                            "stat": "feats",
                            "value": {
                                "type": "stat",
                                "stat": "$view.asi_feat_selection"
                            },
                            "aggregation_type": "set"
                        }
                    }
                ]
            }
        },
        {
            "id": "long_rest_when_new",
            "event_names": "characterLoaded",
            "effects": {
                "type": "when",
                "clauses": [
                    {
                        "condition": {
                            "type": "stat",
                            "stat": "is_new_and_should_long_rest"
                        },
                        "effect": {
                            "type": "sequence",
                            "effects": [
                                {
                                    "type": "fireEvent",
                                    "event": {
                                        "name": "long_rest",
                                        "payload": {}
                                    }
                                },
                                {
                                    "type": "setStat",
                                    "stat": "is_new_and_should_long_rest",
                                    "new_value": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "aggregation_type": "set"
                                }
                            ]
                        }
                    }
                ]
            }
        }
    ],
    "enumerated_types": [
        {
            "id": "hair_colors",
            "name": "Hair colors",
            "types": [
                {
                    "id": "black_hair",
                    "name": "Black Hair"
                },
                {
                    "id": "brown_hair",
                    "name": "Brown Hair"
                },
                {
                    "id": "blonde_hair",
                    "name": "Blonde Hair"
                },
                {
                    "id": "brunette_hair",
                    "name": "Brunette Hair"
                },
                {
                    "id": "gray_hair",
                    "name": "Gray Hair"
                },
                {
                    "id": "white_hair",
                    "name": "White Hair"
                },
                {
                    "id": "red_hair",
                    "name": "Red Hair"
                },
                {
                    "id": "platinum_blonde_hair",
                    "name": "Platinum Blonde Hair"
                },
                {
                    "id": "auburn_hair",
                    "name": "Auburn Hair"
                },
                {
                    "id": "silver_hair",
                    "name": "Silver Hair"
                },
                {
                    "id": "golden_brown_hair",
                    "name": "Golden Brown Hair"
                },
                {
                    "id": "ash_blonde_hair",
                    "name": "Ash Blonde Hair"
                },
                {
                    "id": "blue_hair",
                    "name": "Blue Hair"
                },
                {
                    "id": "green_hair",
                    "name": "Green Hair"
                },
                {
                    "id": "purple_hair",
                    "name": "Purple Hair"
                },
                {
                    "id": "pink_hair",
                    "name": "Pink Hair"
                },
                {
                    "id": "teal_hair",
                    "name": "Teal Hair"
                },
                {
                    "id": "turquoise_hair",
                    "name": "Turquoise Hair"
                },
                {
                    "id": "lavender_hair",
                    "name": "Lavender Hair"
                },
                {
                    "id": "mint_green hair",
                    "name": "Mint Green Hair"
                },
                {
                    "id": "magenta_hair",
                    "name": "Magenta Hair"
                },
                {
                    "id": "indigo_hair",
                    "name": "Indigo Hair"
                },
                {
                    "id": "neon_green_hair",
                    "name": "Neon Green Hair"
                }
            ]
        },
        {
            "id": "eye_colors",
            "name": "Eye colors",
            "types": [
                {
                    "id": "white_eyes",
                    "name": "White Eyes"
                },
                {
                    "id": "black_eyes",
                    "name": "Black Eyes"
                },
                {
                    "id": "green_eyes",
                    "name": "Green Eyes"
                },
                {
                    "id": "orange_eyes",
                    "name": "Orange Eyes"
                },
                {
                    "id": "yellow_eyes",
                    "name": "Yellow Eyes"
                },
                {
                    "id": "red_eyes",
                    "name": "Red Eyes"
                },
                {
                    "id": "blue_eyes",
                    "name": "Blue Eyes"
                },
                {
                    "id": "turquoise_eyes",
                    "name": "Turquoise Eyes"
                },
                {
                    "id": "violet_eyes",
                    "name": "Violet Eyes"
                },
                {
                    "id": "hazel_eyes",
                    "name": "Hazel Eyes"
                },
                {
                    "id": "brown_eyes",
                    "name": "Brown Eyes"
                },
                {
                    "id": "amber_eyes",
                    "name": "Amber Eyes"
                },
                {
                    "id": "gray_eyes",
                    "name": "Gray Eyes"
                },
                {
                    "id": "teal_eyes",
                    "name": "Teal Eyes"
                },
                {
                    "id": "gold_eyes",
                    "name": "Gold Eyes"
                },
                {
                    "id": "silver_eyes",
                    "name": "Silver Eyes"
                },
                {
                    "id": "copper_eyes",
                    "name": "Copper Eyes"
                },
                {
                    "id": "maroon_eyes",
                    "name": "Maroon Eyes"
                }
            ]
        },
        {
            "id": "outfits",
            "name": "Outfits",
            "types": [
                {
                    "id": "wizard",
                    "name": "Wizard"
                },
                {
                    "id": "sorcerer",
                    "name": "Sorcerer"
                },
                {
                    "id": "heavy_armor",
                    "name": "Heavy Armor"
                },
                {
                    "id": "light_armor",
                    "name": "Light Armor"
                },
                {
                    "id": "cloak",
                    "name": "Cloak"
                },
                {
                    "id": "casual_wear",
                    "name": "Casual Wear"
                },
                {
                    "id": "formal_wear",
                    "name": "Formal Wear"
                },
                {
                    "id": "robe",
                    "name": "Robe"
                }
            ]
        },
        {
            "id": "appearance_weapons",
            "name": "Appearance weapons",
            "types": [
                {
                    "id": "battle-axe",
                    "name": "Battle-Axe"
                },
                {
                    "id": "war-hammer",
                    "name": "War-Hammer"
                },
                {
                    "id": "dagger",
                    "name": "Dagger"
                },
                {
                    "id": "sword",
                    "name": "Sword"
                },
                {
                    "id": "long_sword",
                    "name": "Long Sword"
                },
                {
                    "id": "claymore",
                    "name": "Claymore"
                },
                {
                    "id": "long_bow",
                    "name": "LongBow"
                },
                {
                    "id": "crossbow",
                    "name": "Crossbow"
                },
                {
                    "id": "mage_wand",
                    "name": "Wand"
                },
                {
                    "id": "lute",
                    "name": "Lute"
                },
                {
                    "id": "shield",
                    "name": "Shield"
                },
                {
                    "id": "javelin",
                    "name": "Javelin"
                },
                {
                    "id": "mace",
                    "name": "Mace"
                },
                {
                    "id": "spear",
                    "name": "Spear"
                },
                {
                    "id": "sickle",
                    "name": "Sickle"
                },
                {
                    "id": "shortbow",
                    "name": "Shortbow"
                },
                {
                    "id": "sling",
                    "name": "Sling"
                },
                {
                    "id": "flail",
                    "name": "Flail"
                },
                {
                    "id": "glaive",
                    "name": "Glaive"
                },
                {
                    "id": "halberd",
                    "name": "Halberd"
                },
                {
                    "id": "maul",
                    "name": "Maul"
                },
                {
                    "id": "morningstar",
                    "name": "Morningstar"
                },
                {
                    "id": "scimitar",
                    "name": "Scimitar"
                },
                {
                    "id": "trident",
                    "name": "Trident"
                },
                {
                    "id": "whip",
                    "name": "Whip"
                },
                {
                    "id": "blunderbuss",
                    "name": "Blunderbuss"
                },
                {
                    "id": "heavy_crossbow",
                    "name": "Heavy Crossbow"
                },
                {
                    "id": "musket",
                    "name": "Musket"
                },
                {
                    "id": "hand_mortar",
                    "name": "Hand Mortar"
                },
                {
                    "id": "pistol",
                    "name": "Pistol"
                }
            ]
        },
        {
            "id": "sexes",
            "name": "Sexes",
            "types": [
                {
                    "id": "female",
                    "name": "Female"
                },
                {
                    "id": "male",
                    "name": "Male"
                }
            ]
        },
        {
            "id": "death_saves_menu",
            "name": "Death saves menu",
            "types": [
                {
                    "id": "death_saves_stabilize",
                    "name": "Stabilize"
                },
                {
                    "id": "death_saves_roll",
                    "name": "Roll"
                }
            ]
        },
        {
            "id": "spell_level",
            "name": "Spell Level",
            "plural": "Spell Levels",
            "abbreviation": "Spell lvl",
            "types": [
                {
                    "id": "spell_level_0",
                    "name": "Cantrip",
                    "plural": "Cantrips",
                    "abbreviation": "Lvl 0"
                },
                {
                    "id": "spell_level_1",
                    "name": "Level 1",
                    "plural": "Level 1",
                    "abbreviation": "Lvl 1"
                },
                {
                    "id": "spell_level_2",
                    "name": "Level 2",
                    "plural": "Level 2",
                    "abbreviation": "Lvl 2"
                },
                {
                    "id": "spell_level_3",
                    "name": "Level 3",
                    "plural": "Level 3",
                    "abbreviation": "Lvl 3"
                },
                {
                    "id": "spell_level_4",
                    "name": "Level 4",
                    "plural": "Level 4",
                    "abbreviation": "Lvl 4"
                },
                {
                    "id": "spell_level_5",
                    "name": "Level 5",
                    "plural": "Level 5",
                    "abbreviation": "Lvl 5"
                },
                {
                    "id": "spell_level_6",
                    "name": "Level 6",
                    "plural": "Level 6",
                    "abbreviation": "Lvl 6"
                },
                {
                    "id": "spell_level_7",
                    "name": "Level 7",
                    "plural": "Level 7",
                    "abbreviation": "Lvl 7"
                },
                {
                    "id": "spell_level_8",
                    "name": "Level 8",
                    "plural": "Level 8",
                    "abbreviation": "Lvl 8"
                },
                {
                    "id": "spell_level_9",
                    "name": "Level 9",
                    "plural": "Level 9",
                    "abbreviation": "Lvl 9"
                }
            ]
        },
        {
            "id": "alignments",
            "name": "Alignments",
            "types": [
                {
                    "id": "lawful_good",
                    "name": "Lawful Good"
                },
                {
                    "id": "neutral_good",
                    "name": "Neutral Good"
                },
                {
                    "id": "chaotic_good",
                    "name": "Chaotic Good"
                },
                {
                    "id": "lawful_neutral",
                    "name": "Lawful Neutral"
                },
                {
                    "id": "true_neutral",
                    "name": "True Neutral"
                },
                {
                    "id": "chaotic_neutral",
                    "name": "Chaotic Neutral"
                },
                {
                    "id": "lawful_evil",
                    "name": "Lawful Evil"
                },
                {
                    "id": "neutral_evil",
                    "name": "Neutral Evil"
                },
                {
                    "id": "chaotic_evil",
                    "name": "Chaotic Evil"
                }
            ]
        },
        {
            "id": "spell_school",
            "name": "School",
            "plural": "Schools",
            "types": [
                {
                    "id": "spell_school_abjuration",
                    "name": "Abjuration",
                    "abbreviation": "Abj."
                },
                {
                    "id": "spell_school_conjuration",
                    "name": "Conjuration",
                    "abbreviation": "Conj."
                },
                {
                    "id": "spell_school_divination",
                    "name": "Divination",
                    "abbreviation": "Div."
                },
                {
                    "id": "spell_school_enchantment",
                    "name": "Enchantment",
                    "abbreviation": "Enc."
                },
                {
                    "id": "spell_school_evocation",
                    "name": "Evocation",
                    "abbreviation": "Evoc."
                },
                {
                    "id": "spell_school_illusion",
                    "name": "Illusion",
                    "abbreviation": "Ill."
                },
                {
                    "id": "spell_school_necromancy",
                    "name": "Necromancy",
                    "abbreviation": "Nec."
                },
                {
                    "id": "spell_school_transmutation",
                    "name": "Transmutation",
                    "abbreviation": "Tran."
                }
            ]
        },
        {
            "id": "dice",
            "name": "Dice",
            "types": [
                {
                    "id": "d4",
                    "name": "d4"
                },
                {
                    "id": "d6",
                    "name": "d6"
                },
                {
                    "id": "d8",
                    "name": "d8"
                },
                {
                    "id": "d10",
                    "name": "d10"
                },
                {
                    "id": "d12",
                    "name": "d12"
                },
                {
                    "id": "d20",
                    "name": "d20"
                }
            ]
        },
        {
            "id": "ability",
            "name": "Ability",
            "types": [
                {
                    "id": "strength",
                    "name": "Strength",
                    "abbreviation": "STR"
                },
                {
                    "id": "dexterity",
                    "name": "Dexterity",
                    "abbreviation": "DEX"
                },
                {
                    "id": "constitution",
                    "name": "Constitution",
                    "abbreviation": "CON"
                },
                {
                    "id": "intelligence",
                    "name": "Intelligence",
                    "abbreviation": "INT"
                },
                {
                    "id": "wisdom",
                    "name": "Wisdom",
                    "abbreviation": "WIS"
                },
                {
                    "id": "charisma",
                    "name": "Charisma",
                    "abbreviation": "CHA"
                }
            ]
        },
        {
            "id": "ability_plus_none",
            "name": "Ability types",
            "types": [
                {
                    "id": "none",
                    "name": "None"
                },
                {
                    "id": "strength",
                    "name": "Strength"
                },
                {
                    "id": "dexterity",
                    "name": "Dexterity"
                },
                {
                    "id": "constitution",
                    "name": "Constitution"
                },
                {
                    "id": "intelligence",
                    "name": "Intelligence"
                },
                {
                    "id": "wisdom",
                    "name": "Wisdom"
                },
                {
                    "id": "charisma",
                    "name": "Charisma"
                }
            ]
        },
        {
            "id": "hit_point_modes",
            "name": "Hit point modes",
            "types": [
                {
                    "id": "roll",
                    "name": "Roll"
                },
                {
                    "id": "average",
                    "name": "Average"
                },
                {
                    "id": "max",
                    "name": "Max"
                }
            ]
        },
        {
            "id": "ability_score_modes",
            "name": "Ability score modes",
            "types": [
                {
                    "id": "custom",
                    "name": "Custom"
                },
                {
                    "id": "point_buy",
                    "name": "Point buy"
                }
            ]
        },
        {
            "id": "sort_skill_proficiencies_menu",
            "name": "Sort skill proficiencies",
            "types": [
                {
                    "id": "sort_by_name",
                    "name": "Sort by name"
                },
                {
                    "id": "sort_by_ability",
                    "name": "Sort by ability"
                }
            ]
        },
        {
            "id": "skill_proficiency_types",
            "name": "Skill proficiency types",
            "types": [
                {
                    "id": "none",
                    "name": "None"
                },
                {
                    "id": "proficient",
                    "name": "Proficient"
                },
                {
                    "id": "expert",
                    "name": "Expert"
                }
            ]
        },
        {
            "id": "skill_types",
            "name": "Skill types",
            "types": [
                {
                    "id": "acrobatics",
                    "name": "Acrobatics"
                },
                {
                    "id": "animal_handling",
                    "name": "Animal Handling"
                },
                {
                    "id": "arcana",
                    "name": "Arcana"
                },
                {
                    "id": "athletics",
                    "name": "Athletics"
                },
                {
                    "id": "deception",
                    "name": "Deception"
                },
                {
                    "id": "history",
                    "name": "History"
                },
                {
                    "id": "insight",
                    "name": "Insight"
                },
                {
                    "id": "intimidation",
                    "name": "Intimidation"
                },
                {
                    "id": "investigation",
                    "name": "Investigation"
                },
                {
                    "id": "medicine",
                    "name": "Medicine"
                },
                {
                    "id": "nature",
                    "name": "Nature"
                },
                {
                    "id": "perception",
                    "name": "Perception"
                },
                {
                    "id": "performance",
                    "name": "Performance"
                },
                {
                    "id": "persuasion",
                    "name": "Persuasion"
                },
                {
                    "id": "religion",
                    "name": "Religion"
                },
                {
                    "id": "sleight_of_hand",
                    "name": "Sleight of Hand"
                },
                {
                    "id": "stealth",
                    "name": "Stealth"
                },
                {
                    "id": "survival",
                    "name": "Survival"
                }
            ]
        },
        {
            "id": "damage_types",
            "name": "Damage type",
            "plural": "Damage types",
            "types": [
                {
                    "id": "bludgeoning",
                    "name": "Bludgeoning"
                },
                {
                    "id": "piercing",
                    "name": "Piercing"
                },
                {
                    "id": "slashing",
                    "name": "Slashing"
                },
                {
                    "id": "acid",
                    "name": "Acid"
                },
                {
                    "id": "cold",
                    "name": "Cold"
                },
                {
                    "id": "fire",
                    "name": "Fire"
                },
                {
                    "id": "force",
                    "name": "Force"
                },
                {
                    "id": "lightning",
                    "name": "Lightning"
                },
                {
                    "id": "necrotic",
                    "name": "Necrotic"
                },
                {
                    "id": "poison",
                    "name": "Poison"
                },
                {
                    "id": "psychic",
                    "name": "Psychic"
                },
                {
                    "id": "radiant",
                    "name": "Radiant"
                },
                {
                    "id": "thunder",
                    "name": "Thunder"
                },
                {
                    "id": "magic",
                    "name": "Magic"
                }
            ]
        },
        {
            "id": "effect_types",
            "name": "Effect types",
            "types": [
                {
                    "id": "none",
                    "name": "No effect"
                },
                {
                    "id": "add_to_stat",
                    "name": "Add to stat"
                },
                {
                    "id": "set_stat",
                    "name": "Set stat"
                },
                {
                    "id": "disadvantage",
                    "name": "Disadvantage"
                },
                {
                    "id": "advantage",
                    "name": "Advantage"
                },
                {
                    "id": "add_spell",
                    "name": "Add spell"
                },
                {
                    "id": "use_spell",
                    "name": "Use spell"
                }
            ]
        },
        {
            "id": "effect_trigger_types",
            "name": "Effect trigger types",
            "types": [
                {
                    "id": "passive",
                    "name": "Passive"
                },
                {
                    "id": "event",
                    "name": "Event"
                },
                {
                    "id": "active",
                    "name": "Active"
                }
            ]
        },
        {
            "id": "lifecycle_events",
            "name": "Lifecycle events",
            "types": [
                {
                    "id": "long_rest",
                    "name": "long-rest"
                },
                {
                    "id": "short_rest",
                    "name": "short-rest"
                },
                {
                    "id": "dusk",
                    "name": "dusk"
                },
                {
                    "id": "dawn",
                    "name": "dawn"
                },
                {
                    "id": "manual",
                    "name": "manual"
                }
            ]
        },
        {
            "id": "lifecycle_events_menu",
            "name": "Lifecycle events menu",
            "types": [
                {
                    "id": "trigger_long_rest",
                    "name": "Long rest"
                },
                {
                    "id": "trigger_short_rest",
                    "name": "Short rest"
                },
                {
                    "id": "dusk",
                    "name": "Set time to dusk"
                },
                {
                    "id": "dawn",
                    "name": "Set time to dawn"
                }
            ]
        },
        {
            "id": "effect_character_stats",
            "name": "Effect stats",
            "types": [
                {
                    "id": "$character.strength_score",
                    "name": "STR score"
                },
                {
                    "id": "$character.strength_saving_throw",
                    "name": "STR saving throw"
                },
                {
                    "id": "$character.dexterity_score",
                    "name": "DEX score"
                },
                {
                    "id": "$character.dexterity_saving_throw",
                    "name": "DEX saving throw"
                },
                {
                    "id": "$character.constitution_score",
                    "name": "CON score"
                },
                {
                    "id": "$character.constitution_saving_throw",
                    "name": "CON saving throw"
                },
                {
                    "id": "$character.wisdom_score",
                    "name": "WIS score"
                },
                {
                    "id": "$character.wisdom_saving_throw",
                    "name": "WIS saving throw"
                },
                {
                    "id": "$character.intelligence_score",
                    "name": "INT score"
                },
                {
                    "id": "$character.intelligence_saving_throw",
                    "name": "INT saving throw"
                },
                {
                    "id": "$character.charisma_score",
                    "name": "CHA score"
                },
                {
                    "id": "$character.charisma_saving_throw",
                    "name": "CHA saving throw"
                },
                {
                    "id": "$character.armor_class",
                    "name": "AC"
                },
                {
                    "id": "$character.passive_perception",
                    "name": "PP"
                },
                {
                    "id": "$character.current_hp",
                    "name": "HP"
                },
                {
                    "id": "$character.max_hp",
                    "name": "Max HP"
                },
                {
                    "id": "$character.initiative",
                    "name": "Initiative"
                },
                {
                    "id": "$character.speed",
                    "name": "Speed"
                },
                {
                    "id": "$character.burrow_speed",
                    "name": "Burrow"
                },
                {
                    "id": "$character.climb_speed",
                    "name": "Climb"
                },
                {
                    "id": "$character.swim_speed",
                    "name": "Swim"
                },
                {
                    "id": "$character.fly_speed",
                    "name": "Fly"
                },
                {
                    "id": "$character.proficiency_bonus",
                    "name": "Prof. Bonus"
                }, 
                {
                    "id": "$character.level",
                    "name": "Level"
                },
                {
                    "id": "$character.spell_attack_extra_bonus",
                    "name": "Spell atk extra bonus"
                },
                {
                    "id": "$character.spell_dc_extra_bonus",
                    "name": "Spell DC extra bonus"
                },
                {
                    "id": "$character.acrobatics",
                    "name": "Acrobatics"
                },
                {
                    "id": "$character.animal_handling",
                    "name": "Animal handling"
                },
                {
                    "id": "$character.arcana",
                    "name": "Arcana"
                },
                {
                    "id": "$character.athletics",
                    "name": "Athletics"
                },
                {
                    "id": "$character.deception",
                    "name": "Deception"
                },
                {
                    "id": "$character.history",
                    "name": "History"
                },
                {
                    "id": "$character.insight",
                    "name": "Insight"
                },
                {
                    "id": "$character.intimidation",
                    "name": "Intimidation"
                },
                {
                    "id": "$character.investigation",
                    "name": "Investigation"
                },
                {
                    "id": "$character.medicine",
                    "name": "Medicine"
                },
                {
                    "id": "$character.nature",
                    "name": "Nature"
                },
                {
                    "id": "$character.perception",
                    "name": "Perception"
                },
                {
                    "id": "$character.performance",
                    "name": "Performance"
                },
                {
                    "id": "$character.persuasion",
                    "name": "Persuasion"
                },
                {
                    "id": "$character.religion",
                    "name": "Religion"
                },
                {
                    "id": "$character.sleight_of_hand",
                    "name": "Sleight of hand"
                },
                {
                    "id": "$character.stealth",
                    "name": "Stealth"
                },
                {
                    "id": "$character.survival",
                    "name": "Survival"
                },
                {
                    "id": "$character.spell_slots_1",
                    "name": "Lvl 1 spell slots"
                },
                {
                    "id": "$character.spell_slots_2",
                    "name": "Lvl 2 spell slots"
                },
                {
                    "id": "$character.spell_slots_3",
                    "name": "Lvl 3 spell slots"
                },
                {
                    "id": "$character.spell_slots_4",
                    "name": "Lvl 4 spell slots"
                },
                {
                    "id": "$character.spell_slots_5",
                    "name": "Lvl 5 spell slots"
                },
                {
                    "id": "$character.spell_slots_6",
                    "name": "Lvl 6 spell slots"
                },
                {
                    "id": "$character.spell_slots_7",
                    "name": "Lvl 7 spell slots"
                },
                {
                    "id": "$character.spell_slots_8",
                    "name": "Lvl 8 spell slots"
                },
                {
                    "id": "$character.spell_slots_9",
                    "name": "Lvl 9 spell slots"
                },
                {
                    "id": "$character.max_spell_slots_1_bonus",
                    "name": "Max lvl 1 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_2_bonus",
                    "name": "Max lvl 2 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_3_bonus",
                    "name": "Max lvl 3 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_4_bonus",
                    "name": "Max lvl 4 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_5_bonus",
                    "name": "Max lvl 5 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_6_bonus",
                    "name": "Max lvl 6 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_7_bonus",
                    "name": "Max lvl 7 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_8_bonus",
                    "name": "Max lvl 8 spell slots bonus"
                },
                {
                    "id": "$character.max_spell_slots_9_bonus",
                    "name": "Max lvl 9 spell slots bonus"
                }
            ]
        },
        {
            "id": "effect_character_stats_plus_mods_and_constant",
            "name": "Effect stats",
            "extends_type": "effect_character_stats",
            "types": [
                {
                    "id": "$character.strength_modifier",
                    "name": "STR modifier"
                },
                {
                    "id": "$character.dexterity_modifier",
                    "name": "DEX modifier"
                },
                {
                    "id": "$character.constitution_modifier",
                    "name": "CON modifier"
                },
                {
                    "id": "$character.wisdom_modifier",
                    "name": "WIS modifier"
                },
                {
                    "id": "$character.intelligence_modifier",
                    "name": "INT modifier"
                },
                {
                    "id": "$character.charisma_modifier",
                    "name": "CHA modifier"
                },
                {
                    "id": "constant",
                    "name": "Constant"
                }
            ]
        },
        {
            "id": "plus_minus",
            "name": "Plus / minus",
            "types": [
                {
                    "id": "plus",
                    "name": "+"
                },
                {
                    "id": "minus",
                    "name": "-"
                }
            ]
        },
        {
            "id": "min_max_of",
            "name": "Min of / Max of",
            "types": [
                {
                    "id": "min",
                    "name": "Min of"
                },
                {
                    "id": "max",
                    "name": "Max of"
                }
            ]
        },
        {
            "id": "charge_types",
            "name": "Charge types",
            "types": [
                {
                    "id": "constant",
                    "name": "Constant"
                },
                {
                    "id": "calculated",
                    "name": "Calculated"
                }
            ]
        },
        {
            "id": "recharge_types",
            "name": "Recharge types",
            "types": [
                {
                    "id": "all",
                    "name": "All"
                },
                {
                    "id": "formula",
                    "name": "Formula"
                }
            ]
        },
        {
            "id": "effect_advantage_character_stats",
            "name": "Effect advantage character stats",
            "types": [
                {
                    "id": "$character.strength_modifier",
                    "name": "STR"
                },
                {
                    "id": "$character.strength_saving_throw",
                    "name": "STR saving throw"
                },
                {
                    "id": "$character.dexterity_modifier",
                    "name": "DEX"
                },
                {
                    "id": "$character.dexterity_saving_throw",
                    "name": "DEX saving throw"
                },
                {
                    "id": "$character.constitution_modifier",
                    "name": "CON"
                },
                {
                    "id": "$character.constitution_saving_throw",
                    "name": "CON saving throw"
                },
                {
                    "id": "$character.wisdom_modifier",
                    "name": "WIS"
                },
                {
                    "id": "$character.wisdom_saving_throw",
                    "name": "WIS saving throw"
                },
                {
                    "id": "$character.intelligence_modifier",
                    "name": "INT"
                },
                {
                    "id": "$character.intelligence_saving_throw",
                    "name": "INT saving throw"
                },
                {
                    "id": "$character.charisma_modifier",
                    "name": "CHA"
                },
                {
                    "id": "$character.charisma_saving_throw",
                    "name": "CHA saving throw"
                },
                {
                    "id": "$character.initiative",
                    "name": "Initiative"
                },
                {
                    "id": "$character.acrobatics",
                    "name": "Acrobatics"
                },
                {
                    "id": "$character.animal_handling",
                    "name": "Animal handling"
                },
                {
                    "id": "$character.arcana",
                    "name": "Arcana"
                },
                {
                    "id": "$character.athletics",
                    "name": "Athletics"
                },
                {
                    "id": "$character.deception",
                    "name": "Deception"
                },
                {
                    "id": "$character.history",
                    "name": "History"
                },
                {
                    "id": "$character.insight",
                    "name": "Insight"
                },
                {
                    "id": "$character.intimidation",
                    "name": "Intimidation"
                },
                {
                    "id": "$character.investigation",
                    "name": "Investigation"
                },
                {
                    "id": "$character.medicine",
                    "name": "Medicine"
                },
                {
                    "id": "$character.nature",
                    "name": "Nature"
                },
                {
                    "id": "$character.perception",
                    "name": "Perception"
                },
                {
                    "id": "$character.performance",
                    "name": "Performance"
                },
                {
                    "id": "$character.persuasion",
                    "name": "Persuasion"
                },
                {
                    "id": "$character.religion",
                    "name": "Religion"
                },
                {
                    "id": "$character.sleight_of_hand",
                    "name": "Sleight of hand"
                },
                {
                    "id": "$character.stealth",
                    "name": "Stealth"
                },
                {
                    "id": "$character.survival",
                    "name": "Survival"
                }
            ]
        },
        {
            "id": "conditions",
            "name": "Conditions",
            "types": [
                {
                    "id": "lower_than",
                    "name": "<"
                },
                {
                    "id": "lower_than_equal",
                    "name": ""
                },
                {
                    "id": "equal",
                    "name": "="
                },
                {
                    "id": "not_equal",
                    "name": ""
                },
                {
                    "id": "higher_than",
                    "name": ">"
                },
                {
                    "id": "higher_than_equal",
                    "name": ""
                }
            ]
        },
        {
            "id": "effect_aggregation_types",
            "name": "Effect aggregation types",
            "types": [
                {
                    "id": "min",
                    "name": "Pick min."
                },
                {
                    "id": "max",
                    "name": "Pick max."
                },
                {
                    "id": "sum",
                    "name": "Sum"
                },
                {
                    "id": "none",
                    "name": "Prompt"
                },
                {
                    "id": "set",
                    "name": "Set"
                }
            ]
        },
        {
            "id": "weapon_types",
            "name": "Weapon types",
            "types": [
                {
                    "id": "club",
                    "name": "Club"
                },
                {
                    "id": "dagger",
                    "name": "Dagger"
                },
                {
                    "id": "greatclub",
                    "name": "Greatclub"
                },
                {
                    "id": "handaxe",
                    "name": "Handaxe"
                },
                {
                    "id": "javelin",
                    "name": "Javelin"
                },
                {
                    "id": "light_hammer",
                    "name": "Light hammer"
                },
                {
                    "id": "mace",
                    "name": "Mace"
                },
                {
                    "id": "quarterstaff",
                    "name": "Quarterstaff"
                },
                {
                    "id": "sickle",
                    "name": "Sickle"
                },
                {
                    "id": "spear",
                    "name": "Spear"
                },
                {
                    "id": "firearm",
                    "name": "Firearm"
                },
                {
                    "id": "crossbow_light",
                    "name": "Crossbow, light"
                },
                {
                    "id": "dart",
                    "name": "Dart"
                },
                {
                    "id": "shortbow",
                    "name": "Shortbow"
                },
                {
                    "id": "sling",
                    "name": "Sling"
                },
                {
                    "id": "battleaxe",
                    "name": "Battleaxe"
                },
                {
                    "id": "flail",
                    "name": "Flail"
                },
                {
                    "id": "glaive",
                    "name": "Glaive"
                },
                {
                    "id": "greataxe",
                    "name": "Greataxe"
                },
                {
                    "id": "greatsword",
                    "name": "Greatsword"
                },
                {
                    "id": "halberd",
                    "name": "Halberd"
                },
                {
                    "id": "lance",
                    "name": "Lance"
                },
                {
                    "id": "longsword",
                    "name": "Longsword"
                },
                {
                    "id": "maul",
                    "name": "Maul"
                },
                {
                    "id": "morningstar",
                    "name": "Morningstar"
                },
                {
                    "id": "pike",
                    "name": "Pike"
                },
                {
                    "id": "rapier",
                    "name": "Rapier"
                },
                {
                    "id": "scimitar",
                    "name": "Scimitar"
                },
                {
                    "id": "shortsword",
                    "name": "Shortsword"
                },
                {
                    "id": "trident",
                    "name": "Trident"
                },
                {
                    "id": "war_pick",
                    "name": "War, pick"
                },
                {
                    "id": "warhammer",
                    "name": "Warhammer"
                },
                {
                    "id": "whip",
                    "name": "Whip"
                },
                {
                    "id": "blowgun",
                    "name": "Blowgun"
                },
                {
                    "id": "crossbow_hand",
                    "name": "Crossbow, hand"
                },
                {
                    "id": "crossbow_heavy",
                    "name": "Crossbow, heavy"
                },
                {
                    "id": "longbow",
                    "name": "Longbow"
                },
                {
                    "id": "musket",
                    "name": "Musket"
                },
                {
                    "id": "pistol",
                    "name": "Pistol"
                },
                {
                    "id": "net",
                    "name": "Net"
                },
                {
                    "id": "unarmed_strike",
                    "name": "Unarmed strike"
                }
            ]
        },
        {
            "id": "weapon_types_plus_all_types",
            "name": "Weapon types plus 'all' types",
            "extends_type": "weapon_types",
            "types": [
                {
                    "id": "all_martial",
                    "name": "All martial"
                },
                {
                    "id": "all_simple",
                    "name": "All simple"
                }
            ]
        },
        {
            "id": "item_rarity",
            "name": "Rarity",
            "types": [
                {
                    "id": "none",
                    "name": "None"
                },
                {
                    "id": "unknown",
                    "name": "Unknown"
                },
                {
                    "id": "varies",
                    "name": "Varies"
                },
                {
                    "id": "common",
                    "name": "Common"
                },
                {
                    "id": "uncommon",
                    "name": "Uncommon"
                },
                {
                    "id": "rare",
                    "name": "Rare"
                },
                {
                    "id": "very_rare",
                    "name": "Very rare"
                },
                {
                    "id": "legendary",
                    "name": "Legendary"
                },
                {
                    "id": "unique",
                    "name": "Unique"
                },
                {
                    "id": "artifact",
                    "name": "Artifact"
                }
            ]
        },
        {
            "id": "item_types",
            "name": "Item types",
            "types": [
                {
                    "id": "adventuring_gear",
                    "name": "Adventuring Gear"
                },
                {
                    "id": "ammunition",
                    "name": "Ammunition"
                },
                {
                    "id": "armor",
                    "name": "Armor"
                },
                {
                    "id": "artisans_tools",
                    "name": "Artisan's Tools"
                },
                {
                    "id": "food_and_drink",
                    "name": "Food & Drink"
                },
                {
                    "id": "explosive",
                    "name": "Explosive"
                },
                {
                    "id": "gaming_set",
                    "name": "Gaming Set"
                },
                {
                    "id": "instrument",
                    "name": "Instrument"
                },
                {
                    "id": "mount",
                    "name": "Mount"
                },
                {
                    "id": "other",
                    "name": "Other"
                },
                {
                    "id": "poison",
                    "name": "Poison"
                },
                {
                    "id": "potion",
                    "name": "Potion"
                },
                {
                    "id": "ring",
                    "name": "Ring"
                },
                {
                    "id": "rod",
                    "name": "Rod"
                },
                {
                    "id": "rune",
                    "name": "Rune"
                },
                {
                    "id": "scroll",
                    "name": "Scroll"
                },
                {
                    "id": "spellcasting_focus",
                    "name": "Spellcasting Focus"
                },
                {
                    "id": "staff",
                    "name": "Staff"
                },
                {
                    "id": "tack_and_harness",
                    "name": "Tack & Harness"
                },
                {
                    "id": "tool",
                    "name": "Tool"
                },
                {
                    "id": "trade_good",
                    "name": "Trade Good"
                },
                {
                    "id": "treasure_art_object",
                    "name": "Treasure (Art Object)"
                },
                {
                    "id": "treasure_gemstone",
                    "name": "Treasure (Gemstone)"
                },
                {
                    "id": "vehicle_air",
                    "name": "Vehicle (Air)"
                },
                {
                    "id": "vehicle_land",
                    "name": "Vehicle (Land)"
                },
                {
                    "id": "vehicle_space",
                    "name": "Vehicle (Space)"
                },
                {
                    "id": "vehicle_water",
                    "name": "Vechicle (Water)"
                },
                {
                    "id": "wand",
                    "name": "Wand"
                },
                {
                    "id": "weapon",
                    "name": "Weapon"
                },
                {
                    "id": "wondrous",
                    "name": "Wondrous"
                }
            ]
        },
        {
            "id": "ammunition_types",
            "name": "Ammunition",
            "types": [
                {
                    "id": "none",
                    "name": "None"
                },
                {
                    "id": "arrow",
                    "name": "Arrow"
                },
                {
                    "id": "bolt",
                    "name": "Bolt"
                },
                {
                    "id": "bullet",
                    "name": "Sling Bullet"
                },
                {
                    "id": "needle",
                    "name": "Blowgun Needle"
                },
                {
                    "id": "firearm",
                    "name": "Firearm Ammunition"
                }
            ]
        },
        {
            "id": "advantage_status",
            "name": "Advantage status",
            "types": [
                {
                    "id": "none",
                    "name": "Regular use"
                },
                {
                    "id": "advantage",
                    "name": "Advantage"
                },
                {
                    "id": "disadvantage",
                    "name": "Disadvantage"
                }
            ]
        },
        {
            "id": "armor_types",
            "name": "Armor types",
            "types": [
                {
                    "id": "light",
                    "name": "Light"
                },
                {
                    "id": "medium",
                    "name": "Medium"
                },
                {
                    "id": "heavy",
                    "name": "Heavy"
                },
                {
                    "id": "shield",
                    "name": "Shield"
                }
            ]
        },
        {
            "id": "weight_units",
            "name": "Weight units",
            "types": [
                {
                    "id": "pounds",
                    "name": "lb."
                },
                {
                    "id": "ounces",
                    "name": "oz."
                }
            ]
        },
        {
            "id": "currencies",
            "name": "Currencies",
            "types": [
                {
                    "id": "copper",
                    "name": "cp"
                },
                {
                    "id": "silver",
                    "name": "sp"
                },
                {
                    "id": "electrum",
                    "name": "ep"
                },
                {
                    "id": "gold",
                    "name": "gp"
                },
                {
                    "id": "platinum",
                    "name": "pp"
                }
            ]
        },
        {
            "id": "effective_caster_level_types",
            "name": "Effective caster level types",
            "types": [
                {
                    "id": "zero",
                    "name": "Zero (0)"
                },
                {
                    "id": "third",
                    "name": "Third (1/3)"
                },
                {
                    "id": "half",
                    "name": "Half (1/2)"
                },
                {
                    "id": "full",
                    "name": "Full (1)"
                },
                {
                    "id": "custom",
                    "name": "Custom"
                }
            ]
        },
        {
            "id": "weapon_general_types",
            "name": "Weapon general types",
            "types": [
                {
                    "id": "simple_melee",
                    "name": "Simple Melee"
                },
                {
                    "id": "simple_ranged",
                    "name": "Simple Ranged"
                },
                {
                    "id": "martial_melee",
                    "name": "Martial Melee"
                },
                {
                    "id": "martial_ranged",
                    "name": "Martial Ranged"
                }
            ]
        },
        {
            "id": "weapon_masteries",
            "name": "Weapon masteries",
            "types": [
                {
                    "id": "none",
                    "name": "None"
                },
                {
                    "id": "cleave",
                    "name": "Cleave"
                },
                {
                    "id": "graze",
                    "name": "Graze"
                },
                {
                    "id": "nick",
                    "name": "Nick"
                },
                {
                    "id": "push",
                    "name": "Push"
                },
                {
                    "id": "sap",
                    "name": "Sap"
                },
                {
                    "id": "slow",
                    "name": "Slow"
                },
                {
                    "id": "topple",
                    "name": "Topple"
                },
                {
                    "id": "vex",
                    "name": "Vex"
                },
                {
                    "id": "custom",
                    "name": "Custom (see description)"
                }
            ]
        },
        {
            "id": "feat_types",
            "name": "Feat types",
            "types": [
                {
                    "id": "origin",
                    "name": "Origin"
                },
                {
                    "id": "general",
                    "name": "General"
                },
                {
                    "id": "epic_boon",
                    "name": "Epic Boon"
                },
                {
                    "id": "fighting_style",
                    "name": "Fighting Style"
                }
            ]
        },
        {
            "id": "monster_action_types",
            "name": "Monster action types",
            "types": [
                {
                    "id": "none",
                    "name": "None"
                },
                {
                    "id": "melee",
                    "name": "Melee"
                },
                {
                    "id": "ranged",
                    "name": "Ranged"
                },
                {
                    "id": "melee_or_ranged",
                    "name": "Melee or Ranged"
                }
            ]
        },
        {
            "id": "monster_treasure_themes",
            "name": "Monster treasure themes",
            "types": [
                {
                    "id": "arcana",
                    "name": "Arcana"
                },
                {
                    "id": "armaments",
                    "name": "Armaments"
                },
                {
                    "id": "implements",
                    "name": "Implements"
                },
                {
                    "id": "individual",
                    "name": "Individual"
                },
                {
                    "id": "relics",
                    "name": "Relics"
                }
            ]
        },
        {
            "id": "monster_types",
            "name": "Monster types",
            "types": [
                {
                    "id": "aberration",
                    "name": "Aberration"
                },
                {
                    "id": "beast",
                    "name": "Beast"
                },
                {
                    "id": "celestial",
                    "name": "Celestial"
                },
                {
                    "id": "construct",
                    "name": "Construct"
                },
                {
                    "id": "dragon",
                    "name": "Dragon"
                },
                {
                    "id": "elemental",
                    "name": "Elemental"
                },
                {
                    "id": "fey",
                    "name": "Fey"
                },
                {
                    "id": "fiend",
                    "name": "Fiend"
                },
                {
                    "id": "giant",
                    "name": "Giant"
                },
                {
                    "id": "humanoid",
                    "name": "Humanoid"
                },
                {
                    "id": "monstrosity",
                    "name": "Monstrosity"
                },
                {
                    "id": "ooze",
                    "name": "Ooze"
                },
                {
                    "id": "plant",
                    "name": "Plant"
                },
                {
                    "id": "undead",
                    "name": "Undead"
                }
            ]
        },
        {
            "id": "monster_habitats",
            "name": "Monster habitats",
            "types": [
                {
                    "id": "arctic",
                    "name": "Arctic"
                },
                {
                    "id": "coastal",
                    "name": "Coastal"
                },
                {
                    "id": "desert",
                    "name": "Desert"
                },
                {
                    "id": "forest",
                    "name": "Forest"
                },
                {
                    "id": "grassland",
                    "name": "Grassland"
                },
                {
                    "id": "hill",
                    "name": "Hill"
                },
                {
                    "id": "mountain",
                    "name": "Mountain"
                },
                {
                    "id": "swamp",
                    "name": "Swamp"
                },
                {
                    "id": "underdark",
                    "name": "Underdark"
                },
                {
                    "id": "underwater",
                    "name": "Underwater"
                },
                {
                    "id": "urban",
                    "name": "Urban"
                },
                {
                    "id": "planar_abyss",
                    "name": "Abyss"
                },
                {
                    "id": "planar_acheron",
                    "name": "Acheron"
                },
                {
                    "id": "planar_air",
                    "name": "Elemental Plane of Air"
                },
                {
                    "id": "planar_arborea",
                    "name": "Arborea"
                },
                {
                    "id": "planar_arcadia",
                    "name": "Arcadia"
                },
                {
                    "id": "planar_astral",
                    "name": "Astral Plane"
                },
                {
                    "id": "planar_beastlands",
                    "name": "Beastlands"
                },
                {
                    "id": "planar_bytopia",
                    "name": "Bytopia"
                },
                {
                    "id": "planar_carceri",
                    "name": "Carceri"
                },
                {
                    "id": "planar_earth",
                    "name": "Elemental Plane of Earth"
                },
                {
                    "id": "planar_elemental",
                    "name": "Elemental Planes"
                },
                {
                    "id": "planar_elemental_chaos",
                    "name": "Elemental Chaos"
                },
                {
                    "id": "planar_elysium",
                    "name": "Elysium"
                },
                {
                    "id": "planar_ethereal",
                    "name": "Ethereal Plane"
                },
                {
                    "id": "planar_feywild",
                    "name": "Feywild"
                },
                {
                    "id": "planar_fire",
                    "name": "Elemental Plane of Fire"
                },
                {
                    "id": "planar_gehenna",
                    "name": "Gehenna"
                },
                {
                    "id": "planar_hades",
                    "name": "Hades"
                },
                {
                    "id": "planar_limbo",
                    "name": "Limbo"
                },
                {
                    "id": "planar_lower",
                    "name": "Lower Planes"
                },
                {
                    "id": "planar_mechanus",
                    "name": "Mechanus"
                },
                {
                    "id": "planar_celestia",
                    "name": "Mount Celestia"
                },
                {
                    "id": "planar_nine_hells",
                    "name": "Nine Hells"
                },
                {
                    "id": "planar_pandemonium",
                    "name": "Pandemonium"
                },
                {
                    "id": "planar_shadowfell",
                    "name": "Shadowfell"
                },
                {
                    "id": "planar_water",
                    "name": "Elemental Plane of Water"
                },
                {
                    "id": "planar_upper",
                    "name": "Upper Planes"
                },
                {
                    "id": "planar_ysgard",
                    "name": "Ysgard"
                }
            ]
        },
        {
            "id": "monster_sizes",
            "name": "Monster sizes",
            "types": [
                {
                    "id": "tiny",
                    "name": "Tiny"
                },
                {
                    "id": "small",
                    "name": "Small"
                },
                {
                    "id": "medium",
                    "name": "Medium"
                },
                {
                    "id": "large",
                    "name": "Large"
                },
                {
                    "id": "huge",
                    "name": "Huge"
                },
                {
                    "id": "gargantuan",
                    "name": "Gargantuan"
                }
            ]
        },
        {
            "id": "monster_alignments",
            "name": "Monster alignments",
            "extends_type": "alignments",
            "types": [
                {
                    "id": "unaligned",
                    "name": "Unaligned"
                }
            ]
        },
        {
            "id": "monster_cr_types",
            "name": "Monster CRs",
            "types": [
                {
                    "id": "cr_0",
                    "name": "CR 0"
                },
                {
                    "id": "cr_1_8",
                    "name": "CR 1/8"
                },
                {
                    "id": "cr_1_4",
                    "name": "CR 1/4"
                },
                {
                    "id": "cr_1_2",
                    "name": "CR 1/2"
                },
                {
                    "id": "cr_1",
                    "name": "CR 1"
                },
                {
                    "id": "cr_2",
                    "name": "CR 2"
                },
                {
                    "id": "cr_3",
                    "name": "CR 3"
                },
                {
                    "id": "cr_4",
                    "name": "CR 4"
                },
                {
                    "id": "cr_5",
                    "name": "CR 5"
                },
                {
                    "id": "cr_6",
                    "name": "CR 6"
                },
                {
                    "id": "cr_7",
                    "name": "CR 7"
                },
                {
                    "id": "cr_8",
                    "name": "CR 8"
                },
                {
                    "id": "cr_9",
                    "name": "CR 9"
                },
                {
                    "id": "cr_10",
                    "name": "CR 10"
                },
                {
                    "id": "cr_11",
                    "name": "CR 11"
                },
                {
                    "id": "cr_12",
                    "name": "CR 12"
                },
                {
                    "id": "cr_13",
                    "name": "CR 13"
                },
                {
                    "id": "cr_14",
                    "name": "CR 14"
                },
                {
                    "id": "cr_15",
                    "name": "CR 15"
                },
                {
                    "id": "cr_16",
                    "name": "CR 16"
                },
                {
                    "id": "cr_17",
                    "name": "CR 17"
                },
                {
                    "id": "cr_18",
                    "name": "CR 18"
                },
                {
                    "id": "cr_19",
                    "name": "CR 19"
                },
                {
                    "id": "cr_20",
                    "name": "CR 20"
                },
                {
                    "id": "cr_21",
                    "name": "CR 21"
                },
                {
                    "id": "cr_22",
                    "name": "CR 22"
                },
                {
                    "id": "cr_23",
                    "name": "CR 23"
                },
                {
                    "id": "cr_24",
                    "name": "CR 24"
                },
                {
                    "id": "cr_25",
                    "name": "CR 25"
                },
                {
                    "id": "cr_26",
                    "name": "CR 26"
                },
                {
                    "id": "cr_27",
                    "name": "CR 27"
                },
                {
                    "id": "cr_28",
                    "name": "CR 28"
                },
                {
                    "id": "cr_29",
                    "name": "CR 29"
                },
                {
                    "id": "cr_30",
                    "name": "CR 30"
                }
            ]
        }
    ],
    "resources": [
        {
            "id": "visual_trait_option",
            "name": "Visual trait option",
            "stats": [
                {
                    "id": "text",
                    "name": "Text",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                }
            ],
            "edit_view": {
                "id": "visual_trait_option_edit",
                "type": "text",
                "edit_stat": "text",
                "style": "text",
                "max_length": 80,
                "hint": {
                    "type": "constant",
                    "value": "Option (no parenthesis). e.g: Blue Eyes",
                    "value_type": "string"
                },
                "validation_message": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "$view.visual_trait_option_edit"
                                }
                            },
                            "components": {
                                "type": "constant",
                                "value": "You have empty trait options. Please fill them or remove them.",
                                "value_type": "string"
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": null,
                                "value_type": "string"
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "visual_trait",
            "name": "Visual trait",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "visual_trait_option",
                    "default_value": []
                },
                {
                    "id": "importance",
                    "name": "Importance",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "selected_option",
                    "name": "Selected option",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "name_for_select",
                    "name": "Name for select",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "name"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_text",
                    "name": "Display text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "- ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "name_for_select"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.text"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "visual_trait_edit",
                "type": "list",
                "padding": 16,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "visual_trait_edit_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "text",
                        "max_length": 80,
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.visual_trait_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please give a name to your visual trait",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "visual_trait_edit_importance_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "visual_trait_edit_importance_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Importance",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "visual_trait_edit_importance",
                                "type": "text",
                                "edit_stat": "importance",
                                "style": "text",
                                "max_length": 1,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "visual_trait_edit_options",
                        "type": "resourceArray",
                        "resource_id": "visual_trait_option",
                        "stat": "options",
                        "view_type": "edit",
                        "left_view": {
                            "id": "visual_trait_edit_options_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Options: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.visual_trait_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please make sure to add at least one option",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "visual_trait_display",
                "type": "list",
                "alignment": "start",
                "subviews": [
                    {
                        "id": "visual_trait_display_in_character_edit",
                        "type": "composite",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character.$is_new"
                        },
                        "subviews": [
                            {
                                "id": "visual_trait_display_in_character_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "name_for_select"
                                },
                                "style": "text"
                            },
                            {
                                "id": "visual_trait_display_in_character_option_select",
                                "type": "select",
                                "stat": "selected_option",
                                "resource_options": {
                                    "type": "stat",
                                    "stat": "options"
                                },
                                "options_display_stat": "text"
                            }
                        ]
                    },
                    {
                        "id": "visual_trait_display_out_of_character",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defined",
                                "stat": "$character.$is_new"
                            }
                        },
                        "subviews": [
                            {
                                "id": "visual_trait_display_out_of_character_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "display_text",
                                    "value_type": "string"
                                },
                                "style": "text"
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "dice_roll",
            "name": "Dice roll",
            "stats": [
                {
                    "id": "dice_amount",
                    "name": "Dice amount",
                    "abbreviation": "Amnt.",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "dice_type",
                    "name": "Dice type",
                    "abbreviation": "Dice",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "d4"
                },
                {
                    "id": "constant",
                    "name": "Constant",
                    "abbreviation": "Const",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "formula",
                    "name": "Formula",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "trim",
                        "components": {
                            "type": "concat",
                            "components": {
                                "type": "flatAppend",
                                "components": [
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "notEquals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "dice_amount"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "dice_amount"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "dice_type"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "list",
                                                    "components": []
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "lessThanEquals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "constant"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": " ",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": " + ",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    },
                                    {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "or",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "notEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "constant"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 0,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            {
                                                                "type": "equals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "dice_amount"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 0,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "constant"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "list",
                                                    "components": []
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "average",
                    "name": "Average",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "add",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "divide",
                                    "rounding_method": "down",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "multiply",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "dice_amount"
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "equals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "dice_type"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "d4",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": 2.5,
                                                                        "value_type": "integer"
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "equals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "dice_type"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "d6",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": 3.5,
                                                                        "value_type": "integer"
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "equals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "dice_type"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "d8",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": 4.5,
                                                                        "value_type": "integer"
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "equals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "dice_type"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "d10",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": 5.5,
                                                                        "value_type": "integer"
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "equals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "dice_type"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "d12",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": 6.5,
                                                                        "value_type": "integer"
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "equals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "dice_type"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "d20",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": 10.5,
                                                                        "value_type": "integer"
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": 1,
                                                                        "value_type": "integer"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "constant"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "type": "composite",
                "id": "dice_roll_edit",
                "subviews": [
                    {
                        "id": "dice_roll_amount",
                        "type": "text",
                        "edit_stat": "dice_amount",
                        "style": "text",
                        "max_length": 3,
                        "signed": false
                    },
                    {
                        "id": "dice_roll_type",
                        "type": "select",
                        "stat": "dice_type",
                        "options": "dice"
                    },
                    {
                        "id": "dice_roll_linker",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": " + ",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "dice_roll_constant",
                        "type": "text",
                        "edit_stat": "constant",
                        "style": "text",
                        "max_length": 4,
                        "signed": true
                    }
                ]
            }
        },
        {
            "id": "damage_dice",
            "name": "Damage dice",
            "stats": [
                {
                    "id": "dices",
                    "name": "Dices",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "dice_roll",
                    "default_value": []
                },
                {
                    "id": "damage_type",
                    "name": "Damage type",
                    "abbreviation": "Dmg.",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "acid"
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "dices"
                                        }
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "joinToString",
                                                "separator": " + ",
                                                "components": {
                                                    "type": "map",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "dices"
                                                    },
                                                    "mapper": {
                                                        "type": "stat",
                                                        "stat": "$mapValue.formula"
                                                    }
                                                }
                                            },
                                            {
                                                "type": "constant",
                                                "value": " ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "enumeratedName",
                                                "enumerated_type": "damage_types",
                                                "id": {
                                                    "type": "stat",
                                                    "stat": "damage_type"
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "No damage",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "damage_dice_edit",
                "type": "resourceArray",
                "resource_id": "dice_roll",
                "stat": "dices",
                "view_type": "edit",
                "left_view": {
                    "id": "damage_dice_damage_type",
                    "type": "select",
                    "stat": "damage_type",
                    "options": "damage_types"
                },
                "validation_message": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "$view.damage_dice_edit"
                                }
                            },
                            "components": {
                                "type": "concat",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": "It seems like you left the list of dice for ",
                                            "value_type": "string"
                                        },
                                        {
                                            "type": "enumeratedName",
                                            "enumerated_type": "damage_types",
                                            "id": {
                                                "type": "stat",
                                                "stat": "damage_type"
                                            }
                                        },
                                        {
                                            "type": "constant",
                                            "value": " damage empty. Please remove it if you don't need it",
                                            "value_type": "string"
                                        }
                                    ]
                                }
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": null,
                                "value_type": "string"
                            }
                        }
                    ]
                }
            },
            "display_view": {
                "id": "damage_dice_display",
                "type": "text",
                "text": {
                    "type": "stat",
                    "stat": "display_description"
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_damage_dice",
            "name": "Levelled damage dice",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "damage_dice",
                    "name": "Damage dice",
                    "abbreviation": "Dmg Dice",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "damage_dice",
                    "default_value": []
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": " + ",
                        "components": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "damage_dice"
                                            }
                                        }
                                    },
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "damage_dice"
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.display_description"
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "No damage",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_execute",
                    "name": "Can execute",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "and",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "defined",
                                                            "stat": "$parent.level"
                                                        },
                                                        {
                                                            "type": "not",
                                                            "components": {
                                                                "type": "defined",
                                                                "stat": "$parent.school"
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_damage_dice_edit",
                "type": "resourceArray",
                "resource_id": "damage_dice",
                "stat": "damage_dice",
                "view_type": "edit",
                "pop_up_type": "bottomSheet",
                "pop_up_button_text": {
                    "type": "stat",
                    "stat": "display_description"
                },
                "left_view": {
                    "id": "levelled_damage_dice_level",
                    "type": "text",
                    "edit_stat": "level",
                    "style": "text",
                    "hint": {
                        "type": "constant",
                        "value": "Lvl",
                        "value_type": "string"
                    },
                    "max_length": 3
                }
            },
            "display_view": {
                "id": "levelled_damage_dice_display",
                "type": "text",
                "text": {
                    "type": "concat",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "constant",
                                "value": "  Lvl. ",
                                "value_type": "string"
                            },
                            {
                                "type": "stat",
                                "stat": "level"
                            },
                            {
                                "type": "constant",
                                "value": ": ",
                                "value_type": "string"
                            },
                            {
                                "type": "stat",
                                "stat": "description"
                            }
                        ]
                    }
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_description",
            "name": "Levelled description",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "description"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_be_used",
                    "name": "Can execute",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_description_edit",
                "type": "composite",
                "row_only": true,
                "subviews": [
                    {
                        "id": "levelled_description_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_description_edit_description",
                        "type": "text",
                        "edit_stat": "description",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Description",
                            "value_type": "string"
                        }
                    }
                ]
            },
            "display_view": {
                "id": "levelled_description_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "display_description"
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_amount",
            "name": "Levelled amount",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "amount",
                    "name": "Description",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_be_used",
                    "name": "Can execute",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_amount_edit",
                "type": "composite",
                "row_only": true,
                "subviews": [
                    {
                        "id": "levelled_amount_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_amount_edit_amount",
                        "type": "text",
                        "edit_stat": "amount",
                        "style": "text",
                        "margin_left": 4,
                        "hint": {
                            "type": "constant",
                            "value": "Amount",
                            "value_type": "string"
                        },
                        "max_length": 6
                    }
                ]
            },
            "display_view": {
                "id": "levelled_amount_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "display_description"
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_weapon",
            "name": "Levelled weapon",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "weapon",
                    "name": "Weapon",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "weapon",
                    "default_value": null
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "weapon"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Lvl. ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": ": ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "weapon.damage_dice_display_description"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Empty",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_execute",
                    "name": "Can execute",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_weapon_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "levelled_weapon_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_weapon_edit_weapon_button",
                        "type": "popUpButton",
                        "text": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "weapon?.damage_dice_display_description"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": "No weapon",
                                "value_type": "string"
                            }
                        },
                        "pop_up_view": {
                            "id": "levelled_weapon_edit_weapon",
                            "type": "resource",
                            "view_type": "edit",
                            "resource_id": "weapon",
                            "stat": "weapon",
                            "create_if_empty": true
                        },
                        "pop_up_title": {
                            "type": "constant",
                            "value": "Edit weapon",
                            "value_type": "string"
                        },
                        "display_cancel_button": true,
                        "display_save_button": true,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "weapon"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have an empty levelled weapon. Please add a weapon to it or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "levelled_weapon_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_spell",
            "name": "Levelled spell",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "spell",
                    "name": "Spell",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "spell",
                    "default_value": null
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_execute",
                    "name": "Can execute",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "spell"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Lvl. ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": ": ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "spell.name"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Empty",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_spell_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "levelled_spell_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_spell_edit_spell_select",
                        "type": "selectResources",
                        "stat": "spell",
                        "resource_id": "spell",
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "not",
                                        "components": {
                                            "type": "notNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$view.levelled_spell_edit_spell_select"
                                            }
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "There's an empty levelled spell. Please select a spell or remove it",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "list_view": {
                "id": "levelled_spell_list",
                "type": "popUpButton",
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "pop_up_view": {
                    "id": "levelled_spell_view",
                    "type": "resource",
                    "view_type": "display",
                    "resource_id": "spell",
                    "stat": "spell"
                },
                "pop_up_type": "bottomSheet",
                "pop_up_title": {
                    "type": "stat",
                    "stat": "spell.name"
                }
            },
            "display_view": {
                "id": "levelled_spell_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_effect",
            "name": "Levelled effect",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "effect",
                    "name": "Effect",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "effect",
                    "default_value": null
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "current_level",
                    "name": "Current level for character / resource this is attached to",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$parent.level"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character.level"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$character.level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 1,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "execution_level",
                    "name": "Min level for execution",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.is_feat?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "max",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$parent.min_level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "can_execute",
                    "name": "Can execute",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "current_level"
                                },
                                {
                                    "type": "stat",
                                    "stat": "execution_level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.should_load_effects?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "effect"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Lvl. ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            },
                                            {
                                                "type": "constant",
                                                "value": ": ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "effect.edit_display_name"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "No effect",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "effect_only_description",
                    "name": "Effect display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "effect"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "effect.edit_display_name"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "No effect",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_effect_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "levelled_effect_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_effect_edit_effect_bottom_sheet",
                        "type": "popUpButton",
                        "text": {
                            "type": "stat",
                            "stat": "effect_only_description"
                        },
                        "pop_up_view": {
                            "id": "levelled_effect_edit_effect",
                            "type": "resource",
                            "view_type": "edit",
                            "resource_id": "effect",
                            "stat": "effect",
                            "create_if_empty": true
                        },
                        "pop_up_title": {
                            "type": "constant",
                            "value": "Effect",
                            "value_type": "string"
                        },
                        "display_cancel_button": true,
                        "display_save_button": true,
                        "should_persist_on_save": false
                    }
                ]
            },
            "display_view": {
                "id": "levelled_effect_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_choice_text",
            "name": "Levelled choice text",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "selected_options",
                    "name": "Selected options",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "stat",
                        "stat": "options"
                    }
                },
                {
                    "id": "can_be_used",
                    "name": "Can be_used",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "options"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_choice_text_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "levelled_choice_text_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_choice_text_edit_options",
                        "type": "text",
                        "edit_stat": "options",
                        "style": "text",
                        "max_length": 140,
                        "hint": {
                            "type": "constant",
                            "value": "Separate by , (e.g: option1, option2)",
                            "value_type": "string"
                        },
                        "label": {
                            "type": "constant",
                            "value": "Options",
                            "value_type": "string"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.levelled_choice_text_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have an empty levelled options box. Please complete it or remove it",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "levelled_choice_text_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "levelled_choice_text_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.should_show_controls_for_choices"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "levelled_choice_text_display_in_character",
                        "type": "text",
                        "edit_stat": "selected_options",
                        "style": "text",
                        "max_length": 140,
                        "label": {
                            "type": "constant",
                            "value": "Options",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.should_show_controls_for_choices"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "levelled_armor_proficiency",
            "name": "Levelled armor proficiency",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "selected_option",
                    "name": "Selected option",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_be_used",
                    "name": "Can be used",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "mapper": {
                                            "type": "enumeratedName",
                                            "enumerated_type": "armor_types",
                                            "id": {
                                                "type": "stat",
                                                "stat": "$mapValue"
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_armor_proficiency_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "levelled_armor_proficiency_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_armor_proficiency_edit_options",
                        "type": "select",
                        "stat": "options",
                        "options": "armor_types",
                        "multi_select": true,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.levelled_armor_proficiency_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have a box with empty armor proficiency options. Please add options to it or remove it",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "levelled_armor_proficiency_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "levelled_armor_proficiency_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.should_show_controls_for_choices"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "levelled_armor_proficiency_display_in_character",
                        "type": "select",
                        "stat": "selected_option",
                        "options": "armor_types",
                        "allowed_options": {
                            "type": "stat",
                            "stat": "options"
                        },
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.should_show_controls_for_choices"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "levelled_weapon_proficiency",
            "name": "Levelled weapon proficiency",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "selected_option",
                    "name": "Selected option",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_be_used",
                    "name": "Can be used",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "mapper": {
                                            "type": "enumeratedName",
                                            "enumerated_type": "weapon_types_plus_all_types",
                                            "id": {
                                                "type": "stat",
                                                "stat": "$mapValue"
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_weapon_proficiency_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "levelled_weapon_proficiency_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_weapon_proficiency_edit_options",
                        "type": "select",
                        "stat": "options",
                        "options": "weapon_types_plus_all_types",
                        "multi_select": true,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.levelled_weapon_proficiency_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have a box with empty weapon proficiency options. Please add options to it or remove it",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "levelled_weapon_proficiency_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "levelled_weapon_proficiency_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.should_show_controls_for_choices"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "levelled_weapon_proficiency_display_in_character",
                        "type": "select",
                        "stat": "selected_option",
                        "options": "weapon_types_plus_all_types",
                        "allowed_options": {
                            "type": "stat",
                            "stat": "options"
                        },
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.should_show_controls_for_choices"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "levelled_skill_proficiency",
            "name": "Levelled skill proficiency",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "abbreviation": "Lvl",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "selected_option",
                    "name": "Selected option",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "is_expertise",
                    "name": "Is expertise",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "can_be_used",
                    "name": "Can be used",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$parent.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character.level"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_expertise"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "(expert) ",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "mapper": {
                                            "type": "enumeratedName",
                                            "enumerated_type": "skill_types",
                                            "id": {
                                                "type": "stat",
                                                "stat": "$mapValue"
                                            }
                                        }
                                    }
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_skill_proficiency_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "levelled_skill_proficiency_edit_level",
                        "type": "text",
                        "edit_stat": "level",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "max_length": 3
                    },
                    {
                        "id": "levelled_skill_proficiency_edit_options",
                        "type": "select",
                        "stat": "options",
                        "options": "skill_types",
                        "multi_select": true,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.levelled_skill_proficiency_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have a box with empty skill proficiency options. Please add options to it or remove it",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "levelled_skill_proficiency_is_expertise",
                        "type": "checkbox",
                        "stat": "is_expertise",
                        "label": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "$view.levelled_skill_proficiency_is_expertise"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Expert",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Regular",
                                        "value_type": "string"
                                    }
                                }
                            ]
                        },
                        "label_alignment": "right",
                        "style": "switcher"
                    }
                ]
            },
            "display_view": {
                "id": "levelled_skill_proficiency_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "levelled_skill_proficiency_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.should_show_controls_for_choices"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "levelled_skill_proficiency_display_in_character",
                        "type": "select",
                        "stat": "selected_option",
                        "options": "skill_types",
                        "allowed_options": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character?.currently_levelling_up?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": false,
                                            "value_type": "bool"
                                        }
                                    },
                                    "components": {
                                        "type": "filter",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "filter":  {
                                            "type": "equals",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "metaStat",
                                                        "potential_stat_values": [
                                                            "$character.acrobatics_proficiency",
                                                            "$character.animal_handling_proficiency",
                                                            "$character.arcana_proficiency",
                                                            "$character.athletics_proficiency",
                                                            "$character.deception_proficiency",
                                                            "$character.history_proficiency",
                                                            "$character.insight_proficiency",
                                                            "$character.intimidation_proficiency",
                                                            "$character.investigation_proficiency",
                                                            "$character.medicine_proficiency",
                                                            "$character.nature_proficiency",
                                                            "$character.perception_proficiency",
                                                            "$character.performance_proficiency",
                                                            "$character.persuasion_proficiency",
                                                            "$character.religion_proficiency",
                                                            "$character.sleight_of_hand_proficiency",
                                                            "$character.stealth_proficiency",
                                                            "$character.survival_proficiency"
                                                        ],
                                                        "meta_stat": {
                                                            "type": "concat",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "$character.",
                                                                        "value_type": "string"
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "$filterValue"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "_proficiency",
                                                                        "value_type": "string"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "type": "constant",
                                                        "value": "none",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "options"
                                    }
                                }
                            ]
                        },
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.should_show_controls_for_choices"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "operand",
            "name": "Operand",
            "stats": [
                {
                    "id": "stat",
                    "name": "Stat",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "constant"
                },
                {
                    "id": "constant",
                    "name": "Constant",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "operator",
                    "name": "Operator",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "plus"
                },
                {
                    "id": "absolute_calculated_value",
                    "name": "Absolute calculated value (not accounting operator)",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "constant",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "constant"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "multiply",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "constant"
                                                        },
                                                        {
                                                            "type": "metaStat",
                                                            "stat_enumerated_type": "effect_character_stats_plus_mods_and_constant",
                                                            "meta_stat": {
                                                                "type": "stat",
                                                                "stat": "stat"
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 0,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "calculated_value",
                    "name": "Calculated value",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "multiply",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "absolute_calculated_value"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "operator"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "plus",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": -1,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "enumeratedName",
                                    "enumerated_type": "plus_minus",
                                    "id": {
                                        "type": "stat",
                                        "stat": "operator"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": " ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "stat"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "constant",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "constant"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "enumeratedName",
                                                            "enumerated_type": "effect_character_stats_plus_mods_and_constant",
                                                            "id": {
                                                                "type": "stat",
                                                                "stat": "stat"
                                                            }
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "constant"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": 1,
                                                                                    "value_type": "integer"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    "components": {
                                                                        "type": "concat",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": " x ",
                                                                                    "value_type": "string"
                                                                                },
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "constant"
                                                                                }
                                                                            ]
                                                                        }
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": "",
                                                                        "value_type": "string"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "operand_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "operand_edit_operator",
                        "type": "select",
                        "stat": "operator",
                        "options": "plus_minus"
                    },
                    {
                        "id": "operand_edit_stat",
                        "type": "select",
                        "stat": "stat",
                        "options": "effect_character_stats_plus_mods_and_constant"
                    },
                    {
                        "id": "operand_edit_linker",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": " x ",
                            "value_type": "string"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "notEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.operand_edit_stat"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "constant",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "operand_edit_constant",
                        "type": "text",
                        "edit_stat": "constant",
                        "style": "text",
                        "max_length": 3,
                        "hint": {
                            "type": "constant",
                            "value": "1",
                            "value_type": "string"
                        }
                    }
                ]
            },
            "display_view": {
                "id": "operand_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "value_calculator",
            "name": "Value calculator",
            "stats": [
                {
                    "id": "operands",
                    "name": "Operands",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "operand",
                    "default_value": []
                },
                {
                    "id": "calculated_value",
                    "name": "Calculated value",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "add",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "operands"
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.calculated_value"
                                        }
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 0,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "map",
                            "components": {
                                "type": "stat",
                                "stat": "operands"
                            },
                            "mapper": {
                                "type": "stat",
                                "stat": "$mapValue.description"
                            }
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "value_calculator_edit",
                "type": "resourceArray",
                "resource_id": "operand",
                "stat": "operands",
                "view_type": "edit",
                "left_view": {
                    "id": "value_calculator_edit_label",
                    "type": "text",
                    "text": {
                        "type": "constant",
                        "value": "Operands: ",
                        "value_type": "string"
                    },
                    "style": "text"
                },
                "validation_message": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "$view.value_calculator_edit"
                                }
                            },
                            "components": {
                                "type": "constant",
                                "value": "You have a calculator with empty operands. Please add operands to it or remove it.",
                                "value_type": "string"
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": null,
                                "value_type": "string"
                            }
                        }
                    ]
                }
            },
            "display_view": {
                "id": "value_calculator_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "levelled_value_calculator",
            "name": "Levelled value calculator",
            "stats": [
                {
                    "id": "level",
                    "name": "Level",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "calculators",
                    "name": "Calculators",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "value_calculator",
                    "default_value": []
                },
                {
                    "id": "aggregation_type",
                    "name": "Aggregation type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "max"
                },
                {
                    "id": "is_levelled",
                    "name": "Is levelled",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "calculators_as_values",
                    "name": "Calculators as values",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "integer",
                    "components": {
                        "type": "map",
                        "components": {
                            "type": "stat",
                            "stat": "calculators"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.calculated_value"
                        }
                    }
                },
                {
                    "id": "calculated_value",
                    "name": "Calculated value",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "aggregation_type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "max",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "max",
                                    "components": {
                                        "type": "stat",
                                        "stat": "calculators_as_values"
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "aggregation_type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "min",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "min",
                                    "components": {
                                        "type": "stat",
                                        "stat": "calculators_as_values"
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 0,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "aggregation_type"
                                },
                                {
                                    "type": "constant",
                                    "value": "(",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "calculators"
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.description"
                                        }
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "levelled_value_calculator_edit",
                "type": "resourceArray",
                "resource_id": "value_calculator",
                "stat": "calculators",
                "view_type": "edit",
                "left_view": {
                    "id": "levelled_value_calculator_edit_composite",
                    "type": "composite",
                    "subviews": [
                        {
                            "id": "levelled_value_calculator_edit_level",
                            "type": "text",
                            "edit_stat": "level",
                            "style": "text",
                            "hint": {
                                "type": "constant",
                                "value": "From lvl",
                                "value_type": "string"
                            },
                            "max_length": 6
                        },
                        {
                            "id": "levelled_value_calculator_edit_aggregation_type",
                            "type": "select",
                            "stat": "aggregation_type",
                            "options": "min_max_of"
                        }
                    ]
                },
                "pop_up_type": "bottomSheet",
                "pop_up_button_text": {
                    "type": "stat",
                    "stat": "description"
                },
                "validation_message": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "$view.levelled_value_calculator_edit"
                                }
                            },
                            "components": {
                                "type": "constant",
                                "value": "You have an empty levelled calculator. Please add calculators to it or remove it.",
                                "value_type": "string"
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": null,
                                "value_type": "string"
                            }
                        }
                    ]
                }
            },
            "display_view": {
                "id": "levelled_value_calculator_display",
                "type": "text",
                "margin_left": 4,
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "item_with_amount",
            "name": "Item with amount",
            "stats": [
                {
                    "id": "amount",
                    "name": "Amount",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "item",
                    "name": "Item",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "item",
                    "default_value": null
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": " ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "item?.name"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "nothing",
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected",
                    "name": "Is selected",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "can_toggle_selection",
                    "name": "Can toggle selection",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.can_select_more"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view?.item_with_amount_display_in_character"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                }
            ],
            "edit_view": {
                "id": "item_with_amount_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "item_with_amount_edit_amount",
                        "type": "text",
                        "edit_stat": "amount",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Amnt.",
                            "value_type": "string"
                        },
                        "max_length": 6
                    },
                    {
                        "id": "item_with_amount_edit_item",
                        "type": "selectResources",
                        "stat": "item",
                        "resource_id": "item",
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "not",
                                        "components": {
                                            "type": "notNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$view.item_with_amount_edit_item"
                                            }
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have an empty item. Please select an item or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "item_with_amount_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "item_with_amount_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defined",
                                "stat": "$character"
                            }
                        }
                    },
                    {
                        "id": "item_with_amount_display_in_character",
                        "type": "checkbox",
                        "stat": "selected",
                        "label": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "enabled": {
                            "type": "stat",
                            "stat": "can_toggle_selection"
                        },
                        "label_alignment": "right",
                        "style": "checkbox",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        }
                    }
                ]
            }
        },
        {
            "id": "selectable_items",
            "name": "Selectable items",
            "stats": [
                {
                    "id": "amount",
                    "name": "Amount",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "item_with_amount",
                    "default_value": []
                },
                {
                    "id": "choose_label_text",
                    "name": "Choose label text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Choose ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Choose ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": " from ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.display_description"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected_options_string",
                    "name": "Selected options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "resource_type": "item_with_amount",
                    "default_value": []
                },
                {
                    "id": "selected_options",
                    "name": "Selected options",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "item_with_amount",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "options"
                        },
                        "filter": {
                            "type": "contains",
                            "haystack": {
                                "type": "stat",
                                "stat": "selected_options_string"
                            },
                            "needle": {
                                "type": "stat",
                                "stat": "$filterValue.id"
                            }
                        }
                    }
                },
                {
                    "id": "can_select_more",
                    "name": "Can select more",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "lessThan",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "length",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_options"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "selectable_items_edit",
                "type": "list",
                "subviews": [
                    {
                        "id": "selectable_items_edit_amount_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "selectable_items_edit_amount_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Amount to choose: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "selectable_items_edit_amount",
                                "type": "text",
                                "edit_stat": "amount",
                                "style": "text",
                                "hint": {
                                    "type": "constant",
                                    "value": "1",
                                    "value_type": "string"
                                },
                                "max_length": 2
                            }
                        ]
                    },
                    {
                        "id": "selectable_items_edit_options",
                        "type": "resourceArray",
                        "resource_id": "item_with_amount",
                        "stat": "options",
                        "view_type": "edit",
                        "left_view":  {
                            "id": "selectable_items_edit_options_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Options: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.selectable_items_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have empty item options. Please select some items or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "selectable_items_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "selectable_items_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.should_show_controls_for_choices"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "selectable_items_display_in_character",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "selectable_items_display_choose_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "choose_label_text"
                                },
                                "style": "text"
                            },
                            {
                                "id": "selectable_items_display_choose",
                                "type": "select",
                                "stat": "selected_options_string",
                                "resource_options": {
                                    "type": "stat",
                                    "stat": "options"
                                },
                                "max_selection_amount": {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                "options_display_stat": "display_description",
                                "multi_select": true
                            }
                        ],
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.should_show_controls_for_choices"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "armor_with_amount",
            "name": "Armor with amount",
            "stats": [
                {
                    "id": "amount",
                    "name": "Amount",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "armor",
                    "name": "Armor",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "armor",
                    "default_value": null
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": " ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "armor?.name"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "nothing",
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected",
                    "name": "Is selected",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "can_toggle_selection",
                    "name": "Can toggle selection",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.can_select_more"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "selected"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                }
            ],
            "edit_view": {
                "id": "armor_with_amount_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "armor_with_amount_edit_amount",
                        "type": "text",
                        "edit_stat": "amount",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Amnt.",
                            "value_type": "string"
                        },
                        "max_length": 6
                    },
                    {
                        "id": "armor_with_amount_edit_armor",
                        "type": "selectResources",
                        "stat": "armor",
                        "resource_id": "armor",
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "not",
                                        "components": {
                                            "type": "notNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$view.armor_with_amount_edit_armor"
                                            }
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have an empty armor. Please select an armor or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "armor_with_amount_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "armor_with_amount_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defined",
                                "stat": "$character"
                            }
                        }
                    },
                    {
                        "id": "armor_with_amount_display_in_character",
                        "type": "checkbox",
                        "stat": "selected",
                        "label": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "enabled": {
                            "type": "stat",
                            "stat": "can_toggle_selection"
                        },
                        "label_alignment": "right",
                        "style": "checkbox",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        }
                    }
                ]
            }
        },
        {
            "id": "selectable_armors",
            "name": "Selectable armors",
            "stats": [
                {
                    "id": "amount",
                    "name": "Amount",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "armor_with_amount",
                    "default_value": []
                },
                {
                    "id": "choose_label_text",
                    "name": "Choose label text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Choose ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Choose ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": " from ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.display_description"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected_options_string",
                    "name": "Selected options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "selected_options",
                    "name": "Selected options",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "armor_with_amount",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "options"
                        },
                        "filter": {
                            "type": "contains",
                            "haystack": {
                                "type": "stat",
                                "stat": "selected_options_string"
                            },
                            "needle": {
                                "type": "stat",
                                "stat": "$filterValue.id"
                            }
                        }
                    }
                },
                {
                    "id": "can_select_more",
                    "name": "Can select more",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "lessThan",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "length",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_options"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "selectable_armors_edit",
                "type": "list",
                "subviews": [
                    {
                        "id": "selectable_armors_edit_amount_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "selectable_armors_edit_amount_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Amount to choose: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "selectable_armors_edit_amount",
                                "type": "text",
                                "edit_stat": "amount",
                                "style": "text",
                                "hint": {
                                    "type": "constant",
                                    "value": "1",
                                    "value_type": "string"
                                },
                                "max_length": 2
                            }
                        ]
                    },
                    {
                        "id": "selectable_armors_edit_options",
                        "type": "resourceArray",
                        "resource_id": "armor_with_amount",
                        "stat": "options",
                        "view_type": "edit",
                        "left_view":  {
                            "id": "selectable_armors_edit_options_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Options: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.selectable_armors_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have empty armor options. Please select some armors or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "selectable_armors_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "selectable_armors_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.should_show_controls_for_choices"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "selectable_armors_display_in_character",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "selectable_armors_display_choose_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "choose_label_text"
                                },
                                "style": "text"
                            },
                            {
                                "id": "selectable_armors_display_choose",
                                "type": "select",
                                "stat": "selected_options_string",
                                "resource_options": {
                                    "type": "stat",
                                    "stat": "options"
                                },
                                "max_selection_amount": {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                "options_display_stat": "display_description",
                                "multi_select": true
                            }
                        ],
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.should_show_controls_for_choices"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "weapon_with_amount",
            "name": "Weapon with amount",
            "stats": [
                {
                    "id": "amount",
                    "name": "Amount",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "weapon",
                    "name": "Weapon",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "weapon",
                    "default_value": null
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": " ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "weapon?.name"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "nothing",
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected",
                    "name": "Is selected",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "can_toggle_selection",
                    "name": "Can toggle selection",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.can_select_more"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "selected"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                }
            ],
            "edit_view": {
                "id": "weapon_with_amount_edit",
                "type": "composite",
                "subviews": [
                    {
                        "id": "weapon_with_amount_edit_amount",
                        "type": "text",
                        "edit_stat": "amount",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Amnt.",
                            "value_type": "string"
                        },
                        "max_length": 6
                    },
                    {
                        "id": "weapon_with_amount_edit_weapon",
                        "type": "selectResources",
                        "stat": "weapon",
                        "resource_id": "weapon",
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "not",
                                        "components": {
                                            "type": "notNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "$view.weapon_with_amount_edit_weapon"
                                            }
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have an empty weapon. Please select an weapon or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "weapon_with_amount_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "weapon_with_amount_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defined",
                                "stat": "$character"
                            }
                        }
                    },
                    {
                        "id": "weapon_with_amount_display_in_character",
                        "type": "checkbox",
                        "stat": "selected",
                        "label": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "enabled": {
                            "type": "stat",
                            "stat": "can_toggle_selection"
                        },
                        "label_alignment": "right",
                        "style": "checkbox",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        }
                    }
                ]
            }
        },
        {
            "id": "selectable_weapons",
            "name": "Selectable weapons",
            "stats": [
                {
                    "id": "amount",
                    "name": "Amount",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "options",
                    "name": "Options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "weapon_with_amount",
                    "default_value": []
                },
                {
                    "id": "choose_label_text",
                    "name": "Choose label text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Choose ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Choose ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                {
                                    "type": "constant",
                                    "value": " from ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "stat",
                                            "stat": "options"
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.display_description"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected_options_string",
                    "name": "Selected options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "selected_options",
                    "name": "Selected options",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "weapon_with_amount",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "options"
                        },
                        "filter": {
                            "type": "contains",
                            "haystack": {
                                "type": "stat",
                                "stat": "selected_options_string"
                            },
                            "needle": {
                                "type": "stat",
                                "stat": "$filterValue.id"
                            }
                        }
                    }
                },
                {
                    "id": "can_select_more",
                    "name": "Can select more",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "lessThan",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "length",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_options"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "amount"
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "selectable_weapons_edit",
                "type": "list",
                "subviews": [
                    {
                        "id": "selectable_weapons_edit_amount_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "selectable_weapons_edit_amount_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Amount to choose: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "selectable_weapons_edit_amount",
                                "type": "text",
                                "edit_stat": "amount",
                                "style": "text",
                                "hint": {
                                    "type": "constant",
                                    "value": "1",
                                    "value_type": "string"
                                },
                                "max_length": 2
                            }
                        ]
                    },
                    {
                        "id": "selectable_weapons_edit_options",
                        "type": "resourceArray",
                        "resource_id": "weapon_with_amount",
                        "stat": "options",
                        "view_type": "edit",
                        "left_view":  {
                            "id": "selectable_weapons_edit_options_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Options: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.selectable_weapons_edit_options"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have empty weapon options. Please select some weapons or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "selectable_weapons_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "selectable_weapons_display_out_of_character",
                        "type": "text",
                        "margin_left": 4,
                        "text": {
                            "type": "stat",
                            "stat": "display_description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.should_show_controls_for_choices"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        }
                    },
                    {
                        "id": "selectable_weapons_display_in_character",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "selectable_weapons_display_choose_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "choose_label_text"
                                },
                                "style": "text"
                            },
                            {
                                "id": "selectable_weapons_display_choose",
                                "type": "select",
                                "stat": "selected_options_string",
                                "resource_options": {
                                    "type": "stat",
                                    "stat": "options"
                                },
                                "max_selection_amount": {
                                    "type": "stat",
                                    "stat": "amount"
                                },
                                "options_display_stat": "display_description",
                                "multi_select": true
                            }
                        ],
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.should_show_controls_for_choices"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "class_details",
            "name": "Class details",
            "stats": [
                {
                    "id": "class",
                    "name": "Class",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "archetype_id",
                    "name": "Archetype ID",
                    "type": "base",
                    "value_type": "string",
                    "default_value": null
                },
                {
                    "id": "class_level",
                    "name": "Class level",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "selected_selectable_feature_ids",
                    "name": "Selected selectable feature ids",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "last_selection_level",
                    "name": "Last level in which the player selected proficiencies",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "should_select_on_level_up",
                    "name": "Should select new stuff on this level up",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "$character.temp_last_level_up_class_id"
                                },
                                {
                                    "type": "stat",
                                    "stat": "class.id"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "class_name_with_archetype",
                    "name": "Class name with archetype",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "class.name"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "class.selected_archetype"
                                                }
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": " (",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "class.selected_archetype?.name"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ")",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "show_spellcasting_details",
                    "name": "Should show spellcasting details",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "notEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "class.actual_effective_caster_level"
                                },
                                {
                                    "type": "constant",
                                    "value": "zero",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "class_name_with_spellcasting_ability",
                    "name": "Class name with spellcasting ability",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "class.name"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "enumeratedAbbreviation",
                                    "enumerated_type": "ability",
                                    "id": {
                                        "type": "stat",
                                        "stat": "class.actual_spellcasting_ability"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "spell_attack_bonus",
                    "name": "Spell attack bonus",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "add",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "metaStat",
                                    "potential_stat_values": [
                                        "$character.strength_modifier",
                                        "$character.dexterity_modifier",
                                        "$character.constitution_modifier",
                                        "$character.intelligence_modifier",
                                        "$character.wisdom_modifier",
                                        "$character.charisma_modifier"
                                    ],
                                    "meta_stat": {
                                        "type": "concat",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "$character.",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "class.actual_spellcasting_ability"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "_modifier",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "$character.proficiency_bonus"
                                },
                                {
                                    "type": "stat",
                                    "stat": "$character.spell_attack_extra_bonus"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "spell_attack_bonus_text",
                    "name": "Spell attack bonus formatted",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "greaterThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "spell_attack_bonus"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 0,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "+",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "spell_attack_bonus"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_attack_bonus"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "spell_save_dc",
                    "name": "Spell save DC",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "add",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": 8,
                                    "value_type": "integer"
                                },
                                {
                                    "type": "metaStat",
                                    "potential_stat_values": [
                                        "$character.strength_modifier",
                                        "$character.dexterity_modifier",
                                        "$character.constitution_modifier",
                                        "$character.intelligence_modifier",
                                        "$character.wisdom_modifier",
                                        "$character.charisma_modifier"
                                    ],
                                    "meta_stat": {
                                        "type": "concat",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": "$character.",
                                                    "value_type": "string"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "class.actual_spellcasting_ability"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "_modifier",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "$character.proficiency_bonus"
                                },
                                {
                                    "type": "stat",
                                    "stat": "$character.spell_dc_extra_bonus"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "attacks_per_action",
                    "name": "Attacks per action",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "stat",
                        "stat": "class.attacks_per_action_number_for_current_level"
                    }
                },
                {
                    "id": "hit_die_max",
                    "name": "Hit die max",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "toNum",
                        "components": {
                            "type": "replace",
                            "string": {
                                "type": "stat",
                                "stat": "class.actual_hit_die"
                            },
                            "occurrence": {
                                "type": "constant",
                                "value": "d",
                                "value_type": "string"
                            },
                            "replace": {
                                "type": "constant",
                                "value": "",
                                "value_type": "string"
                            }
                        }
                    }
                },
                {
                    "id": "hit_die_average",
                    "name": "Hit die average",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "divide",
                        "rounding_method": "up",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "hit_die_max"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 2,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "should_show_level_up_disclaimer",
                    "name": "Should show level up disclaimer",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character?.$is_new?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        }
                                    }
                                },
                                {
                                    "type": "greaterThan",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view?.class_details_edit_class_level?"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "string"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "class_level"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "features",
                    "name": "Features",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "sortBy",
                        "components": {
                            "type": "stat",
                            "stat": "class.current_level_features"
                        },
                        "sort_by_selector": {
                            "type": "stat",
                            "stat": "$sortByValue.min_level"
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "class_details_edit",
                "type": "composite",
                "alignment": "end",
                "margin_bottom": 4,
                "subviews": [
                    {
                        "id": "edit_character_basics_see_class_button",
                        "type": "popUpButton",
                        "text": {
                            "type": "constant",
                            "value": "SEE DETAILS",
                            "value_type": "string"
                        },
                        "pop_up_view": {
                            "id": "edit_character_basics_see_class_bottom_sheet",
                            "type": "resource",
                            "view_type": "display",
                            "resource_id": "class",
                            "stat": "$view.class_details_edit_class_select"
                        },
                        "pop_up_title": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$view?.class_details_edit_class_select?.name"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": "Class",
                                "value_type": "string"
                            }
                        },
                        "display_cancel_button": true,
                        "cancel_text": {
                            "type": "constant",
                            "value": "OK",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "notNull",
                            "components": {
                                "type": "stat",
                                "stat": "$view?.class_details_edit_class_select?"
                            }
                        }
                    },
                    {
                        "id": "class_details_edit_class_select",
                        "type": "selectResources",
                        "stat": "class",
                        "resource_id": "class",
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.class_details_edit_class_select"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have an unselected class. Select a class or remove it.",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "class_details_edit_archetype_select",
                        "type": "select",
                        "stat": "archetype_id",
                        "margin_left": 4,
                        "resource_options": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$view.class_details_edit_class_select?.archetypes"
                            },
                            "default_components": {
                                "type": "list",
                                "components": []
                            }
                        },
                        "options_display_stat": "name",
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view.class_details_edit_class_select?.archetypes"
                                                },
                                                "default_components": {
                                                    "type": "list",
                                                    "components": []
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "type": "greaterThanEquals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view.class_details_edit_class_level?"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": 1,
                                                        "value_type": "integer"
                                                    }
                                                },
                                                {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view.class_details_edit_class_select?.archetype_selection_level"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": 0,
                                                        "value_type": "integer"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "class_details_edit_class_level",
                        "type": "text",
                        "edit_stat": "class_level",
                        "style": "text",
                        "margin_left": 4,
                        "max_length": 3,
                        "hint": {
                            "type": "constant",
                            "value": "Lvl",
                            "value_type": "string"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "should_show_level_up_disclaimer"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "To level up, please use the EXP / LEVEL UP button at the top-center of the character sheet",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        },
                        "is_visible": {
                            "type": "defined",
                            "stat": "$parent.$is_new"
                        }
                    },
                    {
                        "id": "class_details_edit_class_level_too_low_error_label",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "To level up, please use the EXP / LEVEL UP button at the top-center of the character sheet.",
                            "value_type": "string"
                        },
                        "style": "text",
                        "bold": true,
                        "color": {
                            "type": "constant",
                            "value": "#F44336",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "stat",
                            "stat": "should_show_level_up_disclaimer"
                        }
                    }
                ]
            },
            "list_view": {
                "id": "class_details_display",
                "type": "list",
                "padding_bottom": 16,
                "padding_left": 16,
                "alignment": "start",
                "is_visible": {
                    "type": "stat",
                    "stat": "show_spellcasting_details"
                },
                "subviews": [
                    {
                        "id": "class_details_display_name_spellcasting_ability",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "class_name_with_spellcasting_ability"
                        },
                        "style": "text",
                        "bold": true
                    },
                    {
                        "id": "class_details_display_spell_attack_bonus_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "class_details_display_spell_attack_bonus_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Spell attack bonus: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "class_details_display_spell_attack_bonus",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "spell_attack_bonus_text"
                                },
                                "style": "text",
                                "color": {
                                    "type": "constant",
                                    "value": "accent",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "class_details_display_spell_save_dc_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "class_details_display_spell_save_dc_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Spell save DC: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "class_details_display_spell_save_dc",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "spell_save_dc"
                                },
                                "style": "text",
                                "color": {
                                    "type": "constant",
                                    "value": "accent",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                ]
            },
            "display_view": {
                "id": "class_details_subsection",
                "type": "section",
                "header": [
                    {
                        "id": "class_details_label",
                        "type": "text",
                        "margin_left": 24,
                        "text": {
                            "type": "stat",
                            "stat": "class_name_with_archetype"
                        },
                        "style": "section"
                    }
                ],
                "content": [
                    {
                        "id": "class_details_list",
                        "type": "resourceSection",
                        "resource_stat": "features",
                        "read_only": true,
                        "resource_id": "feat"
                    }
                ],
                "show_divider": false,
                "content_item_min_width": 1,
                "collapsible": true,
                "start_collapsed": true,
                "always_show_collapse_icon": true
            }
        },
        {
            "id": "weight",
            "name": "Weight",
            "stats": [
                {
                    "id": "value",
                    "name": "Value",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "unit",
                    "name": "Unit",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "pounds"
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "value"
                                },
                                {
                                    "type": "constant",
                                    "value": " ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "enumeratedName",
                                    "enumerated_type": "weight_units",
                                    "id": {
                                        "type": "stat",
                                        "stat": "unit"
                                    }
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "edit_weight_composite",
                "type": "composite",
                "subviews": [
                    {
                        "id": "edit_weight_value",
                        "type": "text",
                        "edit_stat": "value",
                        "style": "text",
                        "max_length": 5,
                        "hint": {
                            "type": "constant",
                            "value": "0",
                            "value_type": "string"
                        }
                    },
                    {
                        "id": "edit_weight_unit_select",
                        "type": "select",
                        "stat": "unit",
                        "options": "weight_units"
                    }
                ]
            },
            "display_view": {
                "id": "weight_display",
                "type": "text",
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "cost",
            "name": "Cost",
            "stats": [
                {
                    "id": "value",
                    "name": "Value",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "unit",
                    "name": "Unit",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "copper"
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "value"
                                },
                                {
                                    "type": "constant",
                                    "value": " ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "enumeratedName",
                                    "enumerated_type": "currencies",
                                    "id": {
                                        "type": "stat",
                                        "stat": "unit"
                                    }
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "edit_cost_composite",
                "type": "composite",
                "subviews": [
                    {
                        "id": "edit_cost_value",
                        "type": "text",
                        "edit_stat": "value",
                        "style": "text",
                        "max_length": 5,
                        "hint": {
                            "type": "constant",
                            "value": "0",
                            "value_type": "string"
                        }
                    },
                    {
                        "id": "edit_cost_unit_select",
                        "type": "select",
                        "stat": "unit",
                        "options": "currencies"
                    }
                ]
            },
            "display_view": {
                "id": "cost_display",
                "type": "text",
                "text": {
                    "type": "stat",
                    "stat": "description"
                },
                "style": "text"
            }
        },
        {
            "id": "ability_score_increase",
            "name": "Ability Score Increase",
            "stats": [
                {
                    "id": "value",
                    "name": "Value",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "modifier_options",
                    "name": "Modifier options",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "modifier_options"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Nothing to assign",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Assign ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "value"
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "length",
                                                                        "components": {
                                                                            "type": "stat",
                                                                            "stat": "modifier_options"
                                                                        }
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": 1,
                                                                        "value_type": "integer"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "components": {
                                                            "type": "concat",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "constant",
                                                                        "value": " to ",
                                                                        "value_type": "string"
                                                                    },
                                                                    {
                                                                        "type": "findFirst",
                                                                        "components": {
                                                                            "type": "stat",
                                                                            "stat": "modifier_options"
                                                                        },
                                                                        "filter": {
                                                                            "type": "constant",
                                                                            "value": true,
                                                                            "value_type": "bool"
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "concat",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "constant",
                                                                        "value": " to one of ",
                                                                        "value_type": "string"
                                                                    },
                                                                    {
                                                                        "type": "joinToString",
                                                                        "separator": ", ",
                                                                        "components": {
                                                                            "type": "map",
                                                                            "components": {
                                                                                "type": "stat",
                                                                                "stat": "modifier_options"
                                                                            },
                                                                            "mapper": {
                                                                                "type": "enumeratedName",
                                                                                "enumerated_type": "ability",
                                                                                "id": {
                                                                                    "type": "stat",
                                                                                    "stat": "$mapValue"
                                                                                }
                                                                            }
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "assign_label_text",
                    "name": "Assign label text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Assign ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "value"
                                },
                                {
                                    "type": "constant",
                                    "value": " to: ",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "temp_selected_modifier",
                    "name": "Temporal variable to hold the selected modifier",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "strength"
                }
            ],
            "edit_view": {
                "id": "edit_ability_score_increase_composite",
                "type": "composite",
                "subviews": [
                    {
                        "id": "edit_ability_score_increase_value_label",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Assign ",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "edit_ability_score_increase_value",
                        "type": "text",
                        "edit_stat": "value",
                        "style": "text",
                        "max_length": 5,
                        "hint": {
                            "type": "constant",
                            "value": "1",
                            "value_type": "string"
                        }
                    },
                    {
                        "id": "edit_ability_score_increase_modifier_options_select_label",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": " to one of ",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "edit_ability_score_increase_modifier_options_select",
                        "type": "select",
                        "margin_left": 4,
                        "stat": "modifier_options",
                        "multi_select": true,
                        "options": "ability",
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.edit_ability_score_increase_modifier_options_select"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "You have empty ability score increase options. Please select at least one or remove it",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "ability_score_increase_display",
                "type": "list",
                "subviews": [
                    {
                        "id": "ability_score_increase_display_out_of_character",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defined",
                                "stat": "$character.$is_new"
                            }
                        }
                    },
                    {
                        "id": "ability_score_increase_display_in_character",
                        "type": "composite",
                        "margin_bottom": 4,
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character.$is_new"
                        },
                        "subviews": [
                            {
                                "id": "ability_score_increase_display_assign_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "assign_label_text"
                                },
                                "style": "text"
                            },
                            {
                                "id": "ability_score_increase_select",
                                "type": "select",
                                "stat": "temp_selected_modifier",
                                "options": "ability",
                                "allowed_options": {
                                    "type": "stat",
                                    "stat": "modifier_options"
                                }
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "trigger_condition_term",
            "name": "Trigger condition term",
            "stats": [
                {
                    "id": "stat",
                    "name": "Stat",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "$character.strength_score"
                },
                {
                    "id": "condition",
                    "name": "Condition",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "lower_than_equal"
                },
                {
                    "id": "value",
                    "name": "Value",
                    "type": "base",
                    "value_type": "decimal",
                    "default_value": 0
                },
                {
                    "id": "evaluated_value",
                    "name": "Evaluated",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "condition"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "lower_than",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "lessThan",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "metaStat",
                                                "stat_enumerated_type": "effect_character_stats",
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "value"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "condition"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "lower_than_equal",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "metaStat",
                                                "stat_enumerated_type": "effect_character_stats",
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "value"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "condition"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "equal",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "metaStat",
                                                "stat_enumerated_type": "effect_character_stats",
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "value"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "condition"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "not_equal",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "metaStat",
                                                "stat_enumerated_type": "effect_character_stats",
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "value"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "condition"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "higher_than",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "greaterThan",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "metaStat",
                                                "stat_enumerated_type": "effect_character_stats",
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "value"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "condition"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "higher_than_equal",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "greaterThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "metaStat",
                                                "stat_enumerated_type": "effect_character_stats",
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "value"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "edit_trigger_condition_term",
                "type": "composite",
                "subviews": [
                    {
                        "id": "edit_trigger_condition_term_stat",
                        "type": "select",
                        "options": "effect_character_stats",
                        "stat": "stat"
                    },
                    {
                        "id": "edit_trigger_condition_term_condition",
                        "type": "select",
                        "options": "conditions",
                        "stat": "condition"
                    },
                    {
                        "id": "edit_trigger_condition_term_value",
                        "type": "text",
                        "edit_stat": "value",
                        "style": "text",
                        "max_length": 4,
                        "signed": true,
                        "hint": {
                            "type": "constant",
                            "value": "0",
                            "value_type": "string"
                        }
                    }
                ],
                "resource_id": "trigger_condition_and",
                "left_view": {
                    "id": "edit_trigger_condition_label",
                    "type": "text",
                    "text": {
                        "type": "constant",
                        "value": "Trigger conditions (or)",
                        "value_type": "string"
                    },
                    "style": "text"
                },
                "stat": "terms"
            }
        },
        {
            "id": "trigger_condition_and",
            "name": "Trigger condition and",
            "stats": [
                {
                    "id": "terms",
                    "name": "Terms",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "trigger_condition_term",
                    "default_value": []
                },
                {
                    "id": "evaluated_value",
                    "name": "Evaluated",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "map",
                            "mapper": {
                                "type": "stat",
                                "stat": "$mapValue.evaluated_value"
                            },
                            "components": {
                                "type": "stat",
                                "stat": "terms"
                            }
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "edit_trigger_condition_and",
                "type": "resourceArray",
                "resource_id": "trigger_condition_term",
                "view_type": "edit",
                "left_view": {
                    "id": "edit_trigger_condition_label",
                    "type": "text",
                    "text": {
                        "type": "constant",
                        "value": "and",
                        "value_type": "string"
                    },
                    "style": "text"
                },
                "stat": "terms",
                "validation_message": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "$view.edit_trigger_condition_and"
                                }
                            },
                            "components": {
                                "type": "constant",
                                "value": "You have empty 'and' trigger condition terms. Please add at least one or remove the 'and' condition",
                                "value_type": "string"
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": null,
                                "value_type": "string"
                            }
                        }
                    ]
                }
            }
        },
        {
            "id": "trigger_condition_or",
            "name": "Trigger condition or",
            "stats": [
                {
                    "id": "terms",
                    "name": "Terms",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "trigger_condition_and",
                    "default_value": []
                },
                {
                    "id": "evaluated_value",
                    "name": "Evaluated",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "map",
                            "mapper": {
                                "type": "stat",
                                "stat": "$mapValue.evaluated_value"
                            },
                            "components": {
                                "type": "stat",
                                "stat": "terms"
                            }
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "edit_trigger_condition_or",
                "type": "resourceArray",
                "resource_id": "trigger_condition_and",
                "view_type": "edit",
                "left_view": {
                    "id": "edit_trigger_condition_label",
                    "type": "text",
                    "text": {
                        "type": "constant",
                        "value": "Trigger conditions (or)",
                        "value_type": "string"
                    },
                    "style": "text"
                },
                "stat": "terms"
            }
        },
        {
            "id": "effect",
            "name": "Effect",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_description",
                    "default_value": []
                },
                {
                    "id": "trigger_type",
                    "name": "Trigger type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "passive"
                },
                {
                    "id": "trigger_condition",
                    "name": "Trigger condition",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "trigger_condition_or",
                    "default_value": null
                },
                {
                    "id": "has_charges",
                    "name": "Has charges",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "charge_type",
                    "name": "Charge type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "constant"
                },
                {
                    "id": "recharge_type",
                    "name": "Recharge type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "all"
                },
                {
                    "id": "recharge_event",
                    "name": "Recharge event",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "long_rest"
                },
                {
                    "id": "max_charges_constant",
                    "name": "Max charges",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "max_charges_levelled_formulas",
                    "name": "Max charges levelled formulas",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_value_calculator",
                    "default_value": []
                },
                {
                    "id": "current_charges",
                    "name": "Charges",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "stat",
                        "stat": "max_charges_constant"
                    }
                },
                {
                    "id": "recharges",
                    "name": "Max charges",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "dice_roll",
                    "default_value": null
                },
                {
                    "id": "type",
                    "name": "Type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "none"
                },
                {
                    "id": "clear_on_remove",
                    "name": "Clear on remove",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "events",
                    "name": "Trigger events",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "revert_events",
                    "name": "Revert events",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "stat",
                    "name": "Stat",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "$character.strength_score"
                },
                {
                    "id": "advantage_stat",
                    "name": "(dis)advantage stat",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "$character.strength_modifier"
                },
                {
                    "id": "aggregation_type",
                    "name": "Aggregation type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "max"
                },
                {
                    "id": "dice_roll",
                    "name": "Dice",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "dice_roll",
                    "default_value": null
                },
                {
                    "id": "constant",
                    "name": "Constant",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "spell",
                    "name": "Spell",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "spell",
                    "default_value": null
                },
                {
                    "id": "edit_display_name",
                    "name": "Edit display name",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "name"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "display_subtitle"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "name"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "effect_description",
                    "name": "Effect description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "none",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "enumeratedName",
                                                "enumerated_type": "effect_types",
                                                "id": {
                                                    "type": "constant",
                                                    "value": "none",
                                                    "value_type": "string"
                                                }
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "add_to_stat",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Add ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "stat",
                                                            "stat": "is_passive"
                                                        },
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "constant"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "dice_roll.formula"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "constant",
                                                "value": " to ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "enumeratedName",
                                                "enumerated_type": "effect_character_stats",
                                                "id": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "set_stat",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Set ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "enumeratedName",
                                                "enumerated_type": "effect_character_stats",
                                                "id": {
                                                    "type": "stat",
                                                    "stat": "stat"
                                                }
                                            },
                                            {
                                                "type": "constant",
                                                "value": " to ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "stat",
                                                            "stat": "is_passive"
                                                        },
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "constant"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "dice_roll.formula"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "disadvantage",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Set disadv. on ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "enumeratedName",
                                                "enumerated_type": "effect_advantage_character_stats",
                                                "id": {
                                                    "type": "stat",
                                                    "stat": "advantage_stat"
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "advantage",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Set adv. on ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "enumeratedName",
                                                "enumerated_type": "effect_advantage_character_stats",
                                                "id": {
                                                    "type": "stat",
                                                    "stat": "advantage_stat"
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "add_spell",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Add ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "defined",
                                                            "stat": "spell.name"
                                                        },
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "spell.name"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "constant",
                                                            "value": "no spell",
                                                            "value_type": "string"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "constant",
                                                "value": " to known spells",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "use_spell",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "Use ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "defined",
                                                            "stat": "spell.name"
                                                        },
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "spell.name"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "constant",
                                                            "value": "no spell",
                                                            "value_type": "string"
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "recharges_amount_text",
                    "name": "Recharges amount text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Recharges ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "recharge_type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "all",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "all",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "recharges.formula"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_subtitle",
                    "name": "Display subtitle",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "effect_description"
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "effect_description"
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "and",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "active",
                                                                        "value_type": "string"
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "trigger_type"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            "type": "or",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "notEquals",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": "none",
                                                                                    "value_type": "string"
                                                                                },
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "type"
                                                                                }
                                                                            ]
                                                                        }
                                                                    },
                                                                    {
                                                                        "type": "and",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "has_charges"
                                                                                },
                                                                                {
                                                                                    "type": "notEquals",
                                                                                    "components": {
                                                                                        "type": "list",
                                                                                        "components": [
                                                                                            {
                                                                                                "type": "constant",
                                                                                                "value": "active",
                                                                                                "value_type": "string"
                                                                                            },
                                                                                            {
                                                                                                "type": "stat",
                                                                                                "stat": "trigger_type"
                                                                                            }
                                                                                        ]
                                                                                    }
                                                                                }
                                                                            ]
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "enumeratedName",
                                                        "enumerated_type": "effect_trigger_types",
                                                        "id": {
                                                            "type": "stat",
                                                            "stat": "trigger_type"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "has_charges"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "when",
                                                        "clauses": [
                                                            {
                                                                "condition": {
                                                                    "type": "notEquals",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "recharge_event"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": "manual",
                                                                                "value_type": "string"
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                "components": {
                                                                    "type": "concat",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "recharges_amount_text"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": " at ",
                                                                                "value_type": "string"
                                                                            },
                                                                            {
                                                                                "type": "enumeratedName",
                                                                                "enumerated_type": "lifecycle_events",
                                                                                "id": {
                                                                                    "type": "stat",
                                                                                    "stat": "recharge_event"
                                                                                }
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            },
                                                            {
                                                                "condition": {
                                                                    "type": "constant",
                                                                    "value": true,
                                                                    "value_type": "bool"
                                                                },
                                                                "components": {
                                                                    "type": "concat",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "recharges_amount_text"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": " manually",
                                                                                "value_type": "string"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_passive",
                    "name": "Is passive trigger_type",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "trigger_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value_type": "string",
                                                "value": "passive"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "use_spell",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_active",
                    "name": "Is active trigger_type",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "trigger_type"
                                },
                                {
                                    "type": "constant",
                                    "value_type": "string",
                                    "value": "active"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "recharge_event_names",
                    "name": "Recharge events",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "recharge_event"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "manual",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "eventName",
                                            "event_name": "recharge"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value_type": "bool",
                                    "value": true
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "recharge_event"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "trigger_events",
                    "name": "Trigger events",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_passive"
                                            },
                                            {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value_type": "string",
                                            "value": "rpg_onUpdate"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "trigger_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value_type": "string",
                                                "value": "event"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "events"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value_type": "bool",
                                    "value": true
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "eventName",
                                            "event_name": "use"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "trigger_revert_events",
                    "name": "Revert events",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "is_passive"
                                },
                                "components": {
                                    "type": "constant",
                                    "value_type": "array",
                                    "value": []
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "trigger_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value_type": "string",
                                                "value": "event"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "revert_events"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value_type": "bool",
                                    "value": true
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "eventName",
                                            "event_name": "revert"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "can_execute",
                    "name": "Trigger condition allows execution",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.should_load_effects?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.is_attuned"
                                            },
                                            "components": {
                                                "type": "or",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$parent.is_attuned"
                                                        },
                                                        {
                                                            "type": "not",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$parent.requires_attunement"
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.is_equipped"
                                            },
                                            "components": {
                                                "type": "or",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$parent.is_equipped"
                                                        },
                                                        {
                                                            "type": "not",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$parent.requires_equipping"
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$parent.is_levelled"
                                            },
                                            "components": {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "stat",
                                                            "stat": "$parent.is_levelled"
                                                        },
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$parent.can_execute"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "trigger_condition"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": null,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "trigger_condition.evaluated_value"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_add_to_stat",
                    "name": "Is add to stat",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "add_to_stat",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "$view?.edit_effect_type_select?"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_set_stat",
                    "name": "Is set stat",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "set_stat",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "$view?.edit_effect_type_select?"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_set_or_add_to_stat",
                    "name": "Is setStat or addToStat type",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "is_add_to_stat"
                                },
                                {
                                    "type": "stat",
                                    "stat": "is_set_stat"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_advantage",
                    "name": "Is advantage",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "advantage",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "$view?.edit_effect_type_select?"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_disadvantage",
                    "name": "Is disadvantage",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "disadvantage",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "$view?.edit_effect_type_select?"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_advantage_or_disadvantage_type",
                    "name": "Is setStat or addToStat type",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "is_advantage"
                                },
                                {
                                    "type": "stat",
                                    "stat": "is_disadvantage"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_spell_type",
                    "name": "Is addSpell or useSpell type",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "add_spell",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$view?.edit_effect_type_select?"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "use_spell",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$view?.edit_effect_type_select?"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "max_charges_display_text",
                    "name": "Max charges display text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "charge_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "constant",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "max_charges_constant"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " charges",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Special amnt of charges",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "max_charges",
                    "name": "Max charges",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "charge_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "constant",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "max_charges_constant"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "current_level_max_charges_formula?.calculated_value"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_level_max_charges_formula",
                    "name": "Max charges formula for the current level",
                    "type": "calculated",
                    "value_type": "resource",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "max_charges_levelled_formulas"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "current_level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "current_level",
                    "name": "Current level",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$parent.current_level"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.current_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character.level"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$character.level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 1,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_level_levelled_description",
                    "name": "Current level levelled_description",
                    "type": "calculated",
                    "value_type": "resource",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "description"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "current_level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "current_level_description",
                    "name": "Current level description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "current_level_levelled_description?.description"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": "",
                            "value_type": "string"
                        }
                    }
                }
            ],
            "mechanics": [
                {
                    "id": "do_execute_effect",
                    "event_names": "do_execute_effect",
                    "revert_event_names": "revert_effect_execution",
                    "calculated_revert_event_names": {
                        "type": "stat",
                        "stat": "trigger_revert_events"
                    },
                    "revert_on_remove": {
                        "type": "stat",
                        "stat": "clear_on_remove"
                    },
                    "effects": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "add_to_stat",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "addToStat",
                                    "meta_stat": {
                                        "type": "stat",
                                        "stat": "stat"
                                    },
                                    "value": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "stat",
                                                    "stat": "is_passive"
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "constant"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "roll",
                                                    "formula": {
                                                        "type": "stat",
                                                        "stat": "dice_roll.formula"
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    "calculated_aggregation_type": {
                                        "type": "stat",
                                        "stat": "aggregation_type"
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "set_stat",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "setStat",
                                    "meta_stat": {
                                        "type": "stat",
                                        "stat": "stat"
                                    },
                                    "new_value": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "stat",
                                                    "stat": "is_passive"
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "constant"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "roll",
                                                    "formula": {
                                                        "type": "stat",
                                                        "stat": "dice_roll.formula"
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    "calculated_aggregation_type": {
                                        "type": "stat",
                                        "stat": "aggregation_type"
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "advantage",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "disadvantage",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "addToStat",
                                    "meta_stat": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "type"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": "advantage",
                                                                "value_type": "string"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": "$character.advantages",
                                                    "value_type": "string"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "constant",
                                                    "value": "$character.disadvantages",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    },
                                    "value": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "replace",
                                                "string": {
                                                    "type": "stat",
                                                    "stat": "advantage_stat"
                                                },
                                                "occurrence": {
                                                    "type": "constant",
                                                    "value": "$character.",
                                                    "value_type": "string"
                                                },
                                                "replace": {
                                                    "type": "constant",
                                                    "value": "",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    },
                                    "aggregation_type": "sum"
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "add_spell",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "spell"
                                            },
                                            "effect": {
                                                "type": "setStat",
                                                "stat": "$character.spells",
                                                "new_value": {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "contains",
                                                                "needle": {
                                                                    "type": "stat",
                                                                    "stat": "spell.name"
                                                                },
                                                                "haystack": {
                                                                    "type": "map",
                                                                    "mapper": {
                                                                        "type": "stat",
                                                                        "stat": "$mapValue.name"
                                                                    },
                                                                    "components": {
                                                                        "type": "stat",
                                                                        "stat": "$character.spells"
                                                                    }
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$character.spells"
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "append",
                                                                "list": {
                                                                    "type": "stat",
                                                                    "stat": "$character.spells"
                                                                },
                                                                "item": {
                                                                    "type": "stat",
                                                                    "stat": "spell"
                                                                }
                                                            }
                                                        }
                                                    ]
                                                },
                                                "aggregation_type": "set"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "use_spell",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "spell"
                                            },
                                            "effect": {
                                                "type": "showResource",
                                                "resource": {
                                                    "type": "stat",
                                                    "stat": "spell"
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "execute_effect",
                    "calculated_event_names": {
                        "type": "stat",
                        "stat": "trigger_events"
                    },
                    "effects": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "can_execute"
                                },
                                "effect": {
                                    "type": "sequence",
                                    "effects": [
                                        {
                                            "type": "when",
                                            "clauses": [
                                                {
                                                    "condition": {
                                                        "type": "and",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "has_charges"
                                                                },
                                                                {
                                                                    "type": "greaterThan",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "current_charges"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": 0,
                                                                                "value_type": "integer"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    "effect": {
                                                        "type": "addToStat",
                                                        "stat": "current_charges",
                                                        "value": {
                                                            "type": "constant",
                                                            "value": -1,
                                                            "value_type": "integer" 
                                                        },
                                                        "aggregation_type": "set"
                                                    }
                                                }
                                            ]
                                        },
                                        {
                                            "type": "fireEvent",
                                            "event": {
                                                "name": "do_execute_effect",
                                                "payload": {}
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_passive"
                                            },
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$parent?.should_load_effects?"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                }
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "fireEvent",
                                    "event": {
                                        "name": "revert_effect_execution",
                                        "payload": {}
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "recharge",
                    "calculated_event_names": {
                        "type": "stat",
                        "stat": "recharge_event_names"
                    },
                    "effects": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "has_charges"
                                            }
                                        ]
                                    }
                                },
                                "effect": {
                                    "type": "setStat",
                                    "stat": "current_charges",
                                    "new_value": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "recharge_type"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": "all",
                                                                "value_type": "string"
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "max_charges"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "roll",
                                                    "formula": {
                                                        "type": "stat",
                                                        "stat": "recharges.formula"
                                                    }
                                                }
                                            }
                                        ]
                                    },
                                    "aggregation_type": "set"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "edit_effect",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "edit_effect_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "text",
                        "max_length": 80,
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "and",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view.edit_effect_name"
                                                    }
                                                },
                                                {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "$view?.edit_effect_type_select?"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": "none",
                                                                "value_type": "string"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your effect",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "edit_effect_levelled_descriptions",
                        "type": "resourceArray",
                        "resource_id": "levelled_description",
                        "stat": "description",
                        "view_type": "edit",
                        "left_view": {
                            "id": "edit_effect_levelled_descriptions_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Descriptions (per lvl): ",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    },
                    {
                        "id": "edit_effect_trigger_type_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "edit_effect_trigger_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Type: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "edit_effect_trigger_type_select",
                                "type": "select",
                                "stat": "trigger_type",
                                "options": "effect_trigger_types"
                            },
                            {
                                "id": "edit_effect_clear_on_remove",
                                "type": "checkbox",
                                "stat": "clear_on_remove",
                                "margin_left": 4,
                                "label": {
                                    "type": "constant",
                                    "value": "Clear on remove",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "edit_effect_events",
                        "type": "text",
                        "edit_stat": "events",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Separate by , (e.g: event1, event2)",
                            "value_type": "string"
                        },
                        "label": {
                            "type": "constant",
                            "value": "Triggering events",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_effect_trigger_type_select"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "event",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "edit_effect_revert_events",
                        "type": "text",
                        "edit_stat": "revert_events",
                        "style": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Separate by , (e.g: event1, event2)",
                            "value_type": "string"
                        },
                        "label": {
                            "type": "constant",
                            "value": "Revertion events",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_effect_trigger_type_select"
                                    },
                                    {
                                        "type": "constant",
                                        "value": "event",
                                        "value_type": "string"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "edit_effect_trigger_conditions",
                        "type": "resource",
                        "view_type": "edit",
                        "resource_id": "trigger_condition_or",
                        "stat": "trigger_condition",
                        "create_if_empty": true
                    },
                    {
                        "id": "edit_effect_has_charges_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "edit_effect_has_charges",
                                "type": "checkbox",
                                "stat": "has_charges",
                                "label": {
                                    "type": "constant",
                                    "value": "Has charges",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "edit_effect_charge_type",
                                "type": "select",
                                "stat": "charge_type",
                                "options": "charge_types",
                                "margin_left": 4,
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.edit_effect_has_charges"
                                }
                            },
                            {
                                "id": "edit_effect_max_charges_constant",
                                "type": "text",
                                "edit_stat": "max_charges_constant",
                                "style": "text",
                                "max_length": 4,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$view.edit_effect_has_charges"
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.edit_effect_charge_type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "constant",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "id": "edit_effect_charge_formulas",
                        "type": "resourceArray",
                        "resource_id": "levelled_value_calculator",
                        "stat": "max_charges_levelled_formulas",
                        "view_type": "edit",
                        "left_view": {
                            "id": "edit_effect_charge_formulas_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Charges (per lvl)",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$view.edit_effect_has_charges"
                                    },
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$view.edit_effect_charge_type"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "calculated",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "edit_effect_recharges_composite",
                        "type": "composite",
                        "is_visible": {
                            "type": "stat",
                            "stat": "$view.edit_effect_has_charges"
                        },
                        "margin_top": 4,
                        "margin_bottom": 4,
                        "subviews": [
                            {
                                "id": "edit_effect_recharges_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Recharges ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "edit_effect_recharge_type",
                                "type": "select",
                                "stat": "recharge_type",
                                "options": "recharge_types"
                            },
                            {
                                "id": "edit_effect_recharges_dice",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "dice_roll",
                                "stat": "recharges",
                                "create_if_empty": true,
                                "is_visible": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$view.edit_effect_recharge_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "formula",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "edit_effect_recharges_at_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": " at ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "edit_effect_recharges_event",
                                "type": "select",
                                "stat": "recharge_event",
                                "options": "lifecycle_events"
                            }
                        ]
                    },
                    {
                        "id": "edit_effect_type_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "edit_effect_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Effect: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "edit_effect_type_select",
                                "type": "select",
                                "stat": "type",
                                "options": "effect_types"
                            }
                        ]
                    },
                    {
                        "id": "edit_effect_effect_layout_composite",
                        "type": "composite",
                        "is_visible": {
                            "type": "notEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "constant",
                                        "value": "none",
                                        "value_type": "string"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$view?.edit_effect_type_select?"
                                    }
                                ]
                            }
                        },
                        "subviews": [
                            {
                                "id": "edit_effect_stat_select",
                                "type": "select",
                                "stat": "stat",
                                "options": "effect_character_stats",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_set_or_add_to_stat"
                                }
                            },
                            {
                                "id": "edit_effect_advantage_stat_select",
                                "type": "select",
                                "stat": "advantage_stat",
                                "options": "effect_advantage_character_stats",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_advantage_or_disadvantage_type"
                                }
                            },
                            {
                                "id": "edit_effect_stat_linker_add",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": " + ",
                                    "value_type": "string" 
                                },
                                "style": "text",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_add_to_stat"
                                }
                            },
                            {
                                "id": "edit_effect_stat_linker_set",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": " = ",
                                    "value_type": "string" 
                                },
                                "style": "text",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_set_stat"
                                }
                            },
                            {
                                "id": "edit_effect_dice_roll",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "dice_roll",
                                "stat": "dice_roll",
                                "create_if_empty": true,
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_set_or_add_to_stat"
                                            },
                                            {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.edit_effect_trigger_type_select"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "passive",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "edit_effect_constant",
                                "type": "text",
                                "style": "text",
                                "edit_stat": "constant",
                                "max_length": 4,
                                "signed": true,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_set_or_add_to_stat"
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$view.edit_effect_trigger_type_select"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "passive",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "edit_effect_aggregation_type",
                                "type": "select",
                                "stat": "aggregation_type",
                                "options": "effect_aggregation_types",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_set_or_add_to_stat"
                                }
                            }
                        ]
                    },
                    {
                        "id": "edit_effect_select_spells",
                        "type": "selectResources",
                        "stat": "spell",
                        "resource_id": "spell",
                        "is_visible": {
                            "type": "stat",
                            "stat": "is_spell_type"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "and",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "notNull",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.edit_effect_select_spells"
                                                        }
                                                    }
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "is_spell_type"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your effect",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "display_view": {
                "id": "display_effect",
                "type": "list",
                "padding_left": 8,
                "subviews": [
                    {
                        "id": "display_effect_row_1",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "display_effect_text_list",
                                "type": "list",
                                "subviews": [
                                    {
                                        "id": "display_effect_name",
                                        "type": "text",
                                        "text": {
                                            "type": "stat",
                                            "stat": "name"
                                        },
                                        "style": "subhead",
                                        "max_lines": 1,
                                        "is_visible": {
                                            "type": "not",
                                            "components": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "name"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "id": "display_effect_description",
                                        "type": "text",
                                        "text": {
                                            "type": "stat",
                                            "stat": "current_level_description"
                                        },
                                        "style": "caption",
                                        "is_visible": {
                                            "type": "not",
                                            "components": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "current_level_description"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "id": "display_effect_subtitle",
                                        "type": "text",
                                        "max_lines": 2,
                                        "text": {
                                            "type": "concat",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "- ",
                                                        "value_type": "string" 
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "display_subtitle"
                                                    }
                                                ]
                                            }
                                        },
                                        "style": "caption"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "display_effect_row_2",
                        "type": "composite",
                        "alignment": "end",
                        "subviews": [
                            {
                                "id": "display_effect_total_charges_unusuable",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "max_charges_display_text"
                                },
                                "style": "subhead",
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defined",
                                                    "stat": "$character"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "has_charges"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "display_effect_charges_ticker",
                                "type": "ticker",
                                "stat": "current_charges",
                                "style": "title",
                                "button_location": "right",
                                "button_look": "plusMinus",
                                "change_amount": 1,
                                "min_value_allowed": 0,
                                "should_auto_save": true,
                                "label": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "/ ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "max_charges"
                                            }
                                        ]
                                    }
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "has_charges"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "display_effect_recharge_button",
                                "type": "button",
                                "text": {
                                    "type": "constant",
                                    "value": "RECHARGE",
                                    "value_type": "string"
                                },
                                "event": {
                                    "name": "recharge"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "has_charges"
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "recharge_event"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "manual",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "display_effect_use_button",
                                "type": "button",
                                "text": {
                                    "type": "constant",
                                    "value": "REVERT",
                                    "value_type": "string"
                                },
                                "event": {
                                    "name": "revert"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "trigger_type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "active",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "display_effect_use_button",
                                "type": "button",
                                "text": {
                                    "type": "constant",
                                    "value": "USE",
                                    "value_type": "string"
                                },
                                "event": {
                                    "name": "use"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "trigger_type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "active",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "spell",
            "name": "Spell",
            "plural": "Spells",
            "core": true,
            "color": "#7b1fa2",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "level",
                    "name": "Level",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "spell_level_0"
                },
                {
                    "id": "school",
                    "name": "School",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "spell_school_abjuration"
                },
                {
                    "id": "ritual",
                    "name": "Ritual",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "casting_time",
                    "name": "Casting time",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "display_casting_time",
                    "name": "Display casting time",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "ritual"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "casting_time"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " or ritual",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "casting_time"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "range",
                    "name": "Range",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "duration",
                    "name": "Duration",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "verbal",
                    "name": "Verbal",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "somatic",
                    "name": "Somatic",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "material",
                    "name": "Material",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "components",
                    "name": "Components",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "higher_level_description",
                    "name": "Higher level description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "classes",
                    "name": "Classes",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "dice",
                    "name": "Dice",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_damage_dice",
                    "default_value": []
                },
                {
                    "id": "effects",
                    "name": "Effects",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "effect",
                    "default_value": []
                },
                {
                    "id": "prepared",
                    "name": "Prepared",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "cast_level",
                    "name": "Cast level",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "is_cantrip",
                    "name": "Is cantrip",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "constant",
                                    "value": "spell_level_0",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "num_level",
                    "name": "Numerical level",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "toNum",
                        "components": {
                            "type": "replace",
                            "string": {
                                "type": "stat",
                                "stat": "level"
                            },
                            "occurrence": {
                                "type": "constant",
                                "value": "spell_level_",
                                "value_type": "string"
                            },
                            "replace": {
                                "type": "constant",
                                "value": "",
                                "value_type": "string"
                            }
                        }
                    }
                },
                {
                    "id": "has_higher_level_description",
                    "name": "Has higher level description",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThan",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "length",
                                    "components": {
                                        "type": "stat",
                                        "stat": "higher_level_description"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 0,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_type",
                    "name": "Type",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "enumeratedName",
                                    "enumerated_type": "spell_level",
                                    "id": {
                                        "type": "stat",
                                        "stat": "level"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": " ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "enumeratedName",
                                    "enumerated_type": "spell_school",
                                    "id": {
                                        "type": "stat",
                                        "stat": "school"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "string_components",
                    "name": "Stringified components VSM",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "verbal"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "V",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "somatic"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "S",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "material"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "M",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "has_components",
                    "name": "Has components VSM",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "verbal"
                                },
                                {
                                    "type": "stat",
                                    "stat": "somatic"
                                },
                                {
                                    "type": "stat",
                                    "stat": "material"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_requirements",
                    "name": "Requirements",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "casting_time"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "has_components"
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": " (",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "string_components"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ")",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "full_components",
                    "name": "Full components",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "material"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "string_components"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " (",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "components"
                                            },
                                            {
                                                "type": "constant",
                                                "value": ")",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "string_components"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "character_spell_slots_defined",
                    "name": "Character and spell slots defined",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_1"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_2"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_3"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_4"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_5"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_6"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_7"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_8"
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.spell_slots_9"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "prepare_button_text",
                    "name": "Prepare button text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "prepared"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "UNPREPARE",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "PREPARE",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "available_slots_for_use",
                    "name": "Available slots for use",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "character_spell_slots_defined"
                                },
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": 1,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 2,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 3,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 4,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 5,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 6,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 7,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 8,
                                                "value_type": "integer"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 9,
                                                "value_type": "integer"
                                            }
                                        ]
                                    },
                                    "filter": {
                                        "type": "and",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "greaterThanEquals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "$filterValue"
                                                            },
                                                            {
                                                                "type": "stat",
                                                                "stat": "num_level"
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "type": "greaterThan",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "metaStat",
                                                                "potential_stat_values": [
                                                                    "$character.spell_slots_1",
                                                                    "$character.spell_slots_2",
                                                                    "$character.spell_slots_3",
                                                                    "$character.spell_slots_4",
                                                                    "$character.spell_slots_5",
                                                                    "$character.spell_slots_6",
                                                                    "$character.spell_slots_7",
                                                                    "$character.spell_slots_8",
                                                                    "$character.spell_slots_9"
                                                                ],
                                                                "meta_stat": {
                                                                    "type": "concat",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "constant",
                                                                                "value": "$character.spell_slots_",
                                                                                "value_type": "string"
                                                                            },
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "$filterValue"
                                                                            }
                                                                        ]
                                                                    }
                                                                }
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "selected_spell_slots_stat_name",
                    "name": "Selected spell slots stat name",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "$character.spell_slots_",
                                    "value_type": "string"
                                },
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$view?.spell_display_cast_composite_ticker?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": "0",
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "available_selected_slots",
                    "name": "Available selected spell slots",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "character_spell_slots_defined"
                                            },
                                            {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "selected_spell_slots_stat_name"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "$character.spell_slots_0",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "metaStat",
                                    "potential_stat_values": [
                                        "$character.spell_slots_1",
                                        "$character.spell_slots_2",
                                        "$character.spell_slots_3",
                                        "$character.spell_slots_4",
                                        "$character.spell_slots_5",
                                        "$character.spell_slots_6",
                                        "$character.spell_slots_7",
                                        "$character.spell_slots_8",
                                        "$character.spell_slots_9"
                                    ],
                                    "meta_stat": {
                                        "type": "stat",
                                        "ignore_cache": true,
                                        "stat": "selected_spell_slots_stat_name"
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 0,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "should_select_spell_slot_to_cast",
                    "name": "Should select a spell slot to cast",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_cantrip"
                                    }
                                },
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "available_slots_for_use"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "character_is_not_wearing_inproficient_armor",
                    "name": "Character is not currently wear a piece of armor its not proficient with",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$character?.is_not_wearing_inproficient_armor"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        }
                    }
                },
                {
                    "id": "has_required_spell_slots_to_cast",
                    "name": "Has required spell slots to cast",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "is_cantrip"
                                },
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "available_slots_for_use"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "can_cast",
                    "name": "Can cast spell",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "character_is_not_wearing_inproficient_armor"
                                },
                                {
                                    "type": "stat",
                                    "stat": "has_required_spell_slots_to_cast"
                                }
                            ]
                        }
                    }
                }
            ],
            "indexed_stats": [
                "name",
                "display_type",
                "display_requirements",
                "range",
                "classes",
                "level",
                "school",
                "ritual",
                "source"
            ],
            "search_filters": [
                {
                    "name": "Level",
                    "stat": "level",
                    "options": "spell_level"
                },
                {
                    "name": "School",
                    "stat": "school",
                    "options": "spell_school"
                },
                {
                    "name": "Ritual",
                    "stat": "ritual",
                    "true_name": "Ritual",
                    "false_name": "Non-ritual"
                },
                {
                    "name": "Class",
                    "stat": "classes",
                    "options": "class",
                    "options_display_stat": "name"
                },
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "sort_options": [
                {
                    "name": "by level",
                    "stat": "level",
                    "options": "spell_level"
                },
                {
                    "name": "alphabetically",
                    "stat": "name"
                }
            ],
            "mechanics": [
                {
                    "id": "spell_cast",
                    "name": "Cast spell",
                    "event_names": "castSpell",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "roll",
                                "rolls": {
                                    "type": "findFirst",
                                    "filter": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "findFirst",
                                                    "components": {
                                                        "type": "sortBy",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "dice"
                                                        },
                                                        "sort_by_selector": {
                                                            "type": "stat",
                                                            "stat": "$sortByValue.level"
                                                        },
                                                        "order": "desc"
                                                    },
                                                    "filter": {
                                                        "type": "lessThanEquals",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$findFirstValue.level"
                                                                },
                                                                {
                                                                    "type": "when",
                                                                    "clauses": [
                                                                        {
                                                                            "condition": {
                                                                                "type": "stat",
                                                                                "stat": "is_cantrip"
                                                                            },
                                                                            "components": {
                                                                                "type": "stat",
                                                                                "stat": "$character.level"
                                                                            }
                                                                        },
                                                                        {
                                                                            "condition": {
                                                                                "type": "constant",
                                                                                "value": true,
                                                                                "value_type": "bool"
                                                                            },
                                                                            "components": {
                                                                                "type": "stat",
                                                                                "stat": "$view.spell_display_cast_composite_ticker"
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    }
                                                }
                                            ]
                                        },
                                        "mapper": {
                                            "type": "when",
                                            "clauses": [
                                                {
                                                    "condition": {
                                                        "type": "defined",
                                                        "stat": "$mapValue.damage_dice"
                                                    },
                                                    "components": {
                                                        "type": "map",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$mapValue.damage_dice"
                                                        },
                                                        "mapper": {
                                                            "type": "rollable",
                                                            "formulas": {
                                                                "type": "map",
                                                                "components": {
                                                                    "type": "stat",
                                                                    "stat": "$mapValue.dices"
                                                                },
                                                                "mapper": {
                                                                    "type": "stat",
                                                                    "stat": "$mapValue.formula"
                                                                }
                                                            },
                                                            "text": {
                                                                "type": "stat",
                                                                "stat": "$mapValue.damage_type"
                                                            }
                                                        }
                                                    }
                                                },
                                                {
                                                    "condition": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "components": {
                                                        "type": "list",
                                                        "components": []
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            {
                                "type": "fireEvent",
                                "event_names": {
                                    "type": "map",
                                    "components": {
                                        "type": "filter",
                                        "components": {
                                            "type": "stat",
                                            "stat": "effects"
                                        },
                                        "filter": {
                                            "type": "stat",
                                            "stat": "$filterValue.is_active"
                                        }
                                    },
                                    "mapper": {
                                        "type": "eventName",
                                        "event_name": "use",
                                        "for_resource": {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_cantrip"
                                            }
                                        },
                                        "effect": {
                                            "type": "addToStat",
                                            "meta_stat": {
                                                "type": "stat",
                                                "stat": "selected_spell_slots_stat_name"
                                            },
                                            "value": {
                                                "type": "constant",
                                                "value": -1,
                                                "value_type": "integer"
                                            },
                                            "aggregation_type": "set"
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "delayed",
                                "millis": 500,
                                "effect": {
                                    "type": "dismissResource"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "spell_toggle_prepare",
                    "name": "Toggle spell preparation",
                    "event_names": "togglePrepareSpell",
                    "effects": {
                        "type": "setStat",
                        "stat": "prepared",
                        "new_value": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "prepared"
                            }
                        },
                        "aggregation_type": "set"
                    }
                }
            ],
            "display_view": {
                "id": "spell_display",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "spell_display_info",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_display_source",
                                "type": "text",
                                "margin_left": 16,
                                "style": "caption",
                                "resource_id": "source",
                                "resource_instance_ids_stat": "source",
                                "resource_display_stat": "abbreviation"
                            },
                            {
                                "id": "spell_display_source_separator",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": ", ",
                                    "value_type": "string"
                                },
                                "style": "caption"
                            },
                            {
                                "id": "spell_display_classes",
                                "type": "text",
                                "resource_id": "class",
                                "resource_instance_ids_stat": "classes",
                                "resource_display_stat": "name",
                                "style": "caption"
                            }
                        ]
                    },
                    {
                        "id": "spell_display_type",
                        "type": "text",
                        "margin_left": 16,
                        "text": {
                            "type": "stat",
                            "stat": "display_type"
                        },
                        "style": "caption"
                    },
                    {
                        "id": "spell_display_casting_time_composite",
                        "type": "composite",
                        "margin_top": 16,
                        "subviews": [
                            {
                                "id": "spell_display_casting_time_subtitle",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Casting Time: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "spell_display_casting_time_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_casting_time"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "spell_display_range_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_display_range_subtitle",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Range: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "spell_display_range_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "range"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "spell_display_components_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_display_components_subtitle",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Components: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "spell_display_components_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "full_components"
                                },
                                "style": "text"
                            }
                        ],
                        "is_visible": {
                            "type": "stat",
                            "stat": "has_components"
                        }
                    },
                    {
                        "id": "spell_display_duration_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_display_duration_subtitle",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Duration: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "spell_display_duration_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "duration"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "spell_display_description_label",
                        "type": "text",
                        "margin_top": 16,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "description"
                                }
                            }
                        },
                        "style": "text"
                    },
                    {
                        "id": "spell_display_higher_level_description_subtitle",
                        "type": "text",
                        "margin_top": 16,
                        "text": {
                            "type": "constant",
                            "value": "At Higher Levels: ",
                            "value_type": "string"
                        },
                        "style": "text",
                        "bold": true,
                        "is_visible": {
                            "type": "stat",
                            "stat": "has_higher_level_description"
                        }
                    },
                    {
                        "id": "spell_display_higher_level_description_label",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "higher_level_description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "stat",
                            "stat": "has_higher_level_description"
                        }
                    },
                    {
                        "id": "spell_display_dice_collapsible",
                        "type": "collapsible",
                        "margin_top": 8,
                        "title": {
                            "type": "constant",
                            "value": "Damage dice",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "dice"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "spell_display_levelled_dice",
                                "type": "resourceArray",
                                "resource_id": "levelled_damage_dice",
                                "stat": "dice",
                                "view_type": "display"
                            }
                        ]
                    },
                    {
                        "id": "spell_display_effects_collapsible",
                        "type": "collapsible",
                        "margin_top": 8,
                        "start_expanded": true,
                        "title": {
                            "type": "constant",
                            "value": "Magic effects",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "effects"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "spell_display_effects",
                                "type": "resourceArray",
                                "resource_id": "effect",
                                "stat": "effects",
                                "view_type": "display"
                            }
                        ]
                    },
                    {
                        "id": "spell_display_cast_composite",
                        "type": "composite",
                        "margin_top": 16,
                        "is_visible": {
                            "type": "stat",
                            "stat": "should_select_spell_slot_to_cast"
                        },
                        "subviews": [
                            {
                                "id": "spell_display_cast_composite_level_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Level: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "spell_display_cast_composite_ticker",
                                "type": "ticker",
                                "stat": "cast_level",
                                "style": "headline",
                                "button_location": "sideToSide",
                                "button_look": "upDown",
                                "allowed_values": {
                                    "type": "stat",
                                    "stat": "available_slots_for_use"
                                }
                            },
                            {
                                "id": "spell_display_cast_composite_slots_remaining_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Slots remaining: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "spell_display_slots_remaining_composite_ticker",
                                "type": "ticker",
                                "stat": "available_selected_slots",
                                "style": "headline",
                                "is_visible": {
                                    "type": "defined",
                                    "stat": "$view.spell_display_cast_composite_ticker"
                                }
                            }
                        ]
                    },
                    {
                        "id": "spell_display_cast_section_list",
                        "type": "list",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        },
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "spell_display_cast_explanation",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Can't cast when wearing armor you are not proficient with",
                                    "value_type": "string"
                                },
                                "color": {
                                    "type": "constant",
                                    "value": "accent",
                                    "value_type": "string"
                                },
                                "bold": true,
                                "style": "text",
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "character_is_not_wearing_inproficient_armor"
                                    }
                                }
                            },
                            {
                                "id": "spell_display_cast_explanation_spell_slots",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "You don't have the required spell slots to cast this spell right now",
                                    "value_type": "string"
                                },
                                "color": {
                                    "type": "constant",
                                    "value": "accent",
                                    "value_type": "string"
                                },
                                "bold": true,
                                "style": "text",
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "has_required_spell_slots_to_cast"
                                    }
                                }
                            },
                            {
                                "id": "spell_display_cast_button_composite",
                                "type": "composite",
                                "row_only": true,
                                "subviews": [
                                    {
                                        "id": "spell_display_prepare_button",
                                        "type": "button",
                                        "text": {
                                            "type": "stat",
                                            "stat": "prepare_button_text"
                                        },
                                        "is_visible": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_cantrip"
                                            }
                                        },
                                        "event": {
                                            "name": "togglePrepareSpell",
                                            "payload": {}
                                        }
                                    },
                                    {
                                        "id": "spell_display_cast_button_spacer",
                                        "type": "spacer"
                                    },
                                    {
                                        "id": "spell_display_cast_button",
                                        "type": "button",
                                        "text": {
                                            "type": "constant",
                                            "value": "CAST",
                                            "value_type": "string"
                                        },
                                        "enabled": {
                                            "type": "stat",
                                            "stat": "can_cast"
                                        },
                                        "event": {
                                            "name": "castSpell",
                                            "payload": {}
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                ]
            },
            "search_item_view": {
                "id": "spell_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "display_type"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "display_requirements"
                },
                "second_line_extra": {
                    "type": "stat",
                    "stat": "range"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "list_view": {
                "id": "spell_list",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "display_type"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "display_requirements"
                },
                "second_line_extra": {
                    "type": "stat",
                    "stat": "range"
                },
                "chips": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "prepared"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "createChip",
                                                "id": "prepared_chip",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "PREPARED",
                                                    "value_type": "string"
                                                },
                                                "background_color": {
                                                    "type": "constant",
                                                    "value": "#4caf50",
                                                    "value_type": "string"
                                                },
                                                "style": {
                                                    "type": "constant",
                                                    "value": "compact",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            "edit_view": {
                "id": "spell_edit",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "spell_edit_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.spell_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your spell",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "spell_edit_source",
                        "margin_top": 4,
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_edit_source_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Source: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "spell_edit_source_select",
                                "type": "select",
                                "options": "source",
                                "options_display_stat": "abbreviation",
                                "stat": "source"
                            }
                        ]
                    },
                    {
                        "id": "spell_edit_level_school",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "spell_edit_level_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Level: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "spell_edit_level",
                                "type": "select",
                                "options": "spell_level",
                                "stat": "level"
                            },
                            {
                                "id": "spell_edit_school_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "School: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "spell_edit_school",
                                "type": "select",
                                "options": "spell_school",
                                "stat": "school"
                            }
                        ]
                    },
                    {
                        "id": "spell_edit_vsm",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_edit_ritual",
                                "type": "checkbox",
                                "stat": "ritual",
                                "label": {
                                    "type": "constant",
                                    "value": "Ritual",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "spell_edit_verbal",
                                "type": "checkbox",
                                "stat": "verbal",
                                "label": {
                                    "type": "constant",
                                    "value": "V",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "spell_edit_somatic",
                                "type": "checkbox",
                                "stat": "somatic",
                                "label": {
                                    "type": "constant",
                                    "value": "S",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "spell_edit_material",
                                "type": "checkbox",
                                "stat": "material",
                                "label": {
                                    "type": "constant",
                                    "value": "M",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "spell_edit_casting_time_range",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_edit_casting_time",
                                "type": "text",
                                "edit_stat": "casting_time",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Casting time",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            },
                            {
                                "id": "spell_edit_range",
                                "type": "text",
                                "edit_stat": "range",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Range",
                                    "value_type": "string"
                                },
                                "max_length": 80
                            },
                            {
                                "id": "spell_edit_duration",
                                "type": "text",
                                "edit_stat": "duration",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Duration",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            }
                        ]
                    },
                    {
                        "id": "spell_edit_components",
                        "type": "text",
                        "edit_stat": "components",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Components",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "stat",
                            "stat": "$view.spell_edit_material"
                        },
                        "max_length": 300
                    },
                    {
                        "id": "spell_edit_description",
                        "type": "text",
                        "edit_stat": "description",
                        "label": {
                            "type": "constant",
                            "value": "Description",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "spell_edit_higher_level_description",
                        "type": "text",
                        "edit_stat": "higher_level_description",
                        "label": {
                            "type": "constant",
                            "value": "Higher levels description",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "spell_edit_classes",
                        "margin_top": 4,
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "spell_edit_classes_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Classes: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "spell_edit_classes",
                                "type": "select",
                                "options": "class",
                                "options_display_stat": "name",
                                "stat": "classes",
                                "multi_select": true
                            }
                        ]
                    },
                    {
                        "id": "spell_edit_levelled_damage_dice",
                        "type": "resourceArray",
                        "resource_id": "levelled_damage_dice",
                        "view_type": "edit",
                        "left_view": {
                            "id": "spell_edit_levelled_damage_dice_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Damage dice (per lvl): ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "stat": "dice"
                    },
                    {
                        "id": "spell_edit_effects",
                        "type": "resourceArray",
                        "resource_id": "effect",
                        "view_type": "edit",
                        "stat": "effects",
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "edit_display_name"
                        },
                        "left_view": {
                            "id": "spell_edit_effects_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Effects: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    }
                ]
            }
        },
        {
            "id": "weapon",
            "name": "Weapon",
            "plural": "Weapons",
            "core": true,
            "color": "#455A64",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "is_core",
                    "name": "Core",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "mastery",
                    "name": "Mastery",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "none"
                },
                {
                    "id": "description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "cost",
                    "name": "Cost",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "weight",
                    "name": "Weight",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "type",
                    "name": "Type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "club"
                },
                {
                    "id": "attack_ability",
                    "name": "Attack ability",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "strength"
                },
                {
                    "id": "add_attack_ability_to_damage",
                    "name": "Add attack ability to damage",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "rarity",
                    "name": "Rarity",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "common"
                },
                {
                    "id": "requires_attunement",
                    "name": "Requires attunement",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "display_type",
                    "name": "Display type",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_simple"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "is_range"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "simple_ranged",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_simple"
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_range"
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "simple_melee",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_simple"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "is_range"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "martial_ranged",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_simple"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_range"
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "martial_melee",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "is_simple",
                    "name": "Is simple",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "is_two_handed",
                    "name": "Is two-handed",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_finesse",
                    "name": "Is finesse",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_silver",
                    "name": "Is silver",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_thrown",
                    "name": "Is thrown",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "thrown_range",
                    "name": "Thrown range",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "80/320"
                },
                {
                    "id": "is_heavy",
                    "name": "Is heavy",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_light",
                    "name": "Is light",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_loading",
                    "name": "Is loading",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_reach",
                    "name": "Is reach",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "reach_range",
                    "name": "Reach range",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 5
                },
                {
                    "id": "is_special",
                    "name": "Is special",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_improvised",
                    "name": "Is improvised",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_range",
                    "name": "Is range",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "range",
                    "name": "Range",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "80/320"
                },
                {
                    "id": "ammunition_type",
                    "name": "Ammunition type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "none"
                },
                {
                    "id": "extra_attack_bonus",
                    "name": "Extra attack bonus",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "damage_dice",
                    "name": "Damage dice",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "damage_dice",
                    "default_value": []
                },
                {
                    "id": "is_versatile",
                    "name": "Is versatile",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "versatile_damage_dice",
                    "name": "Versatile damage dice",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "damage_dice",
                    "default_value": []
                },
                {
                    "id": "should_load_effects",
                    "name": "Should not load effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$parent?.should_load_effects?"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        }
                    }
                },
                {
                    "id": "effects",
                    "name": "Effects",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "effect",
                    "default_value": []
                },
                {
                    "id": "override_is_proficient",
                    "name": "Override is proficient",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_attuned",
                    "name": "Is attuned",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "currently_used_as_versatile",
                    "name": "Is it currently being used as versatile?",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "advantage_status",
                    "name": "Advantage status",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$character?.is_not_wearing_inproficient_armor"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "string" 
                                                }
                                            },
                                            {
                                                "type": "and",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "notEquals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "attack_ability"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "strength",
                                                                        "value_type": "string"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            "type": "notEquals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "attack_ability"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "dexterity",
                                                                        "value_type": "string"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "none",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "disadvantage",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "has_ammunition",
                    "name": "Has ammunition",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "is_range"
                                },
                                {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "ammunition_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "none",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_proficient",
                    "name": "Is proficient",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "override_is_proficient"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            "components": {
                                                "type": "or",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "contains",
                                                            "haystack": {
                                                                "type": "stat",
                                                                "stat": "$character.weapon_proficiencies"
                                                            },
                                                            "needle": {
                                                                "type": "stat",
                                                                "stat": "type"
                                                            }
                                                        },
                                                        {
                                                            "type": "and",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "contains",
                                                                        "haystack": {
                                                                            "type": "stat",
                                                                            "stat": "$character.weapon_proficiencies"
                                                                        },
                                                                        "needle": {
                                                                            "type": "constant",
                                                                            "value": "all_martial",
                                                                            "value_type": "string"
                                                                        }
                                                                    },
                                                                    {
                                                                        "type": "not",
                                                                        "components": {
                                                                            "type": "stat",
                                                                            "stat": "is_simple"
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            "type": "and",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "contains",
                                                                        "haystack": {
                                                                            "type": "stat",
                                                                            "stat": "$character.weapon_proficiencies"
                                                                        },
                                                                        "needle": {
                                                                            "type": "constant",
                                                                            "value": "all_simple",
                                                                            "value_type": "string"
                                                                        }
                                                                    },
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "is_simple"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": false,
                                                "value_type": "bool"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "versatile_damage_dice_display_description",
                    "name": "Display versatile damage dice",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "versatile_damage_dice"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "no damage",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "joinToString",
                                                        "separator": " + ",
                                                        "components": {
                                                            "type": "map",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "versatile_damage_dice"
                                                            },
                                                            "mapper": {
                                                                "type": "stat",
                                                                "stat": "$mapValue.display_description"
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "flatAppend",
                                                "components": [
                                                    {
                                                        "type": "when",
                                                        "clauses": [
                                                            {
                                                                "condition": {
                                                                    "type": "greaterThan",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "damage_bonus"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": 0,
                                                                                "value_type": "integer"
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "constant",
                                                                            "value": " + ",
                                                                            "value_type": "string"
                                                                        },
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "damage_bonus"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            {
                                                                "condition": {
                                                                    "type": "lessThan",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "damage_bonus"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": 0,
                                                                                "value_type": "integer"
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "constant",
                                                                            "value": " - ",
                                                                            "value_type": "string"
                                                                        },
                                                                        {
                                                                            "type": "multiply",
                                                                            "components": {
                                                                                "type": "list",
                                                                                "components": [
                                                                                    {
                                                                                        "type": "stat",
                                                                                        "stat": "damage_bonus"
                                                                                    },
                                                                                    {
                                                                                        "type": "constant",
                                                                                        "value": -1,
                                                                                        "value_type": "integer"
                                                                                    }
                                                                                ]
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            {
                                                                "condition": {
                                                                    "type": "constant",
                                                                    "value": true,
                                                                    "value_type": "bool"
                                                                },
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": []
                                                                }
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "properties",
                    "name": "Properties",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "rarity"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "enumeratedName",
                                                        "enumerated_type": "item_rarity",
                                                        "id": {
                                                            "type": "stat",
                                                            "stat": "rarity"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "mastery"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "enumeratedName",
                                                        "enumerated_type": "weapon_masteries",
                                                        "id": {
                                                            "type": "stat",
                                                            "stat": "mastery"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_two_handed"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "two-handed",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_versatile"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "versatile",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_silver"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "silver",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_finesse"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "finesse",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_thrown"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "thrown (",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "thrown_range"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": ")",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_heavy"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "heavy",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_light"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "light",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_loading"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "loading",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_special"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "special",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_improvised"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "improvised",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_range"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "range (",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "range"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": ")",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_reach"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "reach ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "reach_range"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": " ft.",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "requires_attunement"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "requires attunement",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "cost?.value"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "cost.description"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "weight?.value"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "weight.description"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "attack_modifier_stat_id",
                    "name": "Attack modifier stat id",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "$character.",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "attack_ability"
                                },
                                {
                                    "type": "constant",
                                    "value": "_modifier",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "attack_bonus",
                    "name": "Attack bonus",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "add",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "max",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "metaStat",
                                                        "potential_stat_values": [
                                                            "$character.strength_modifier",
                                                            "$character.dexterity_modifier",
                                                            "$character.constitution_modifier",
                                                            "$character.intelligence_modifier",
                                                            "$character.wisdom_modifier",
                                                            "$character.charisma_modifier"
                                                        ],
                                                        "meta_stat": {
                                                            "type": "stat",
                                                            "stat": "attack_modifier_stat_id"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "stat",
                                                            "stat": "is_finesse"
                                                        },
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$character.dexterity_modifier"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "list",
                                                            "components": []
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_proficient"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "$character.proficiency_bonus"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": 0,
                                                "value_type": "integer"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "extra_attack_bonus"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "damage_bonus",
                    "name": "Damage bonus",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "add_attack_ability_to_damage"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "max",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "metaStat",
                                                        "potential_stat_values": [
                                                            "$character.strength_modifier",
                                                            "$character.dexterity_modifier",
                                                            "$character.constitution_modifier",
                                                            "$character.intelligence_modifier",
                                                            "$character.wisdom_modifier",
                                                            "$character.charisma_modifier"
                                                        ],
                                                        "meta_stat": {
                                                            "type": "stat",
                                                            "stat": "attack_modifier_stat_id"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "stat",
                                                            "stat": "is_finesse"
                                                        },
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "$character.dexterity_modifier"
                                                                }
                                                            ]
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "list",
                                                            "components": []
                                                        }
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 0,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "display_attack_bonus",
                    "name": "Display attack bonus",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "when",
                                                "clauses": [
                                                    {
                                                        "condition": {
                                                            "type": "greaterThanEquals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "attack_bonus"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": 0,
                                                                        "value_type": "integer"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        "components": {
                                                            "type": "constant",
                                                            "value": "+",
                                                            "value_type": "string"
                                                        }
                                                    },
                                                    {
                                                        "condition": {
                                                            "type": "constant",
                                                            "value": true,
                                                            "value_type": "bool"
                                                        },
                                                        "components": {
                                                            "type": "constant",
                                                            "value": "",
                                                            "value_type": "string"
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "attack_bonus"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "damage_dice_display_description",
                    "name": "Display versatile damage dice",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "damage_dice"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "no damage",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "joinToString",
                                                        "separator": " + ",
                                                        "components": {
                                                            "type": "map",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "damage_dice"
                                                            },
                                                            "mapper": {
                                                                "type": "stat",
                                                                "stat": "$mapValue.display_description"
                                                            }
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "flatAppend",
                                                "components": [
                                                    {
                                                        "type": "when",
                                                        "clauses": [
                                                            {
                                                                "condition": {
                                                                    "type": "not",
                                                                    "components": {
                                                                        "type": "defined",
                                                                        "stat": "$character"
                                                                    }
                                                                },
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                    ]
                                                                }
                                                            },
                                                            {
                                                                "condition": {
                                                                    "type": "greaterThan",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "damage_bonus"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": 0,
                                                                                "value_type": "integer"
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "constant",
                                                                            "value": " + ",
                                                                            "value_type": "string"
                                                                        },
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "damage_bonus"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            {
                                                                "condition": {
                                                                    "type": "lessThan",
                                                                    "components": {
                                                                        "type": "list",
                                                                        "components": [
                                                                            {
                                                                                "type": "stat",
                                                                                "stat": "damage_bonus"
                                                                            },
                                                                            {
                                                                                "type": "constant",
                                                                                "value": 0,
                                                                                "value_type": "integer"
                                                                            }
                                                                        ]
                                                                    }
                                                                },
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "constant",
                                                                            "value": " - ",
                                                                            "value_type": "string"
                                                                        },
                                                                        {
                                                                            "type": "multiply",
                                                                            "components": {
                                                                                "type": "list",
                                                                                "components": [
                                                                                    {
                                                                                        "type": "stat",
                                                                                        "stat": "damage_bonus"
                                                                                    },
                                                                                    {
                                                                                        "type": "constant",
                                                                                        "value": -1,
                                                                                        "value_type": "integer"
                                                                                    }
                                                                                ]
                                                                            }
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            {
                                                                "condition": {
                                                                    "type": "constant",
                                                                    "value": true,
                                                                    "value_type": "bool"
                                                                },
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": []
                                                                }
                                                            }
                                                        ]
                                                    }
                                                ]
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "display_first_line_extra",
                    "name": "Display first line extra",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "display_attack_bonus"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "damage_dice_display_description"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "display_second_line_extra",
                    "name": "Display second line extra",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "damage_dice_display_description"
                                }
                            },
                            {
                                "condition": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "effects"
                                                    }
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "requires_attunement"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Magic",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "second_line_extra_color",
                    "name": "Second line extra color",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "effects"
                                        }
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "accent",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "text",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "temp_shoot_ammo",
                    "name": "Temp ammo item being shot",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "ammunition_items",
                    "name": "Items that can be used as ammunition for this weapon",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "item",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$character.equipment"
                                    },
                                    "filter": {
                                        "type": "and",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "$filterValue.type"
                                                            },
                                                            {
                                                                "type": "constant",
                                                                "value": "ammunition",
                                                                "value_type": "string"
                                                            }
                                                        ]
                                                    }
                                                },
                                                {
                                                    "type": "equals",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "$filterValue.ammunition_type"
                                                            },
                                                            {
                                                                "type": "stat",
                                                                "stat": "ammunition_type"
                                                            }
                                                        ]
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "list",
                                    "components": []
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "selected_item_to_shoot",
                    "name": "Selected item to shoot",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "item",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "stat",
                            "stat": "ammunition_items"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.id"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$view?.weapon_display_ammunition_select?"
                                    }
                                ]
                            }
                        }
                    }
                }
            ],
            "indexed_stats": [
                "name",
                "is_core",
                "properties",
                "display_first_line_extra",
                "display_second_line_extra",
                "second_line_extra_color",
                "source",
                "is_simple",
                "is_two_handed",
                "is_finesse",
                "is_silver",
                "is_thrown",
                "is_heavy",
                "is_light",
                "is_loading",
                "is_reach",
                "is_special",
                "is_improvised",
                "is_range",
                "is_versatile",
                "requires_attunement",
                "display_type",
                "mastery",
                "rarity"
            ],
            "search_filters": [
                {
                    "name": "Simple / Martial",
                    "stat": "is_simple",
                    "true_name": "Simple",
                    "false_name": "Martial"
                },
                {
                    "name": "Core only?",
                    "stat": "is_core",
                    "true_name": "Core only",
                    "false_name": "Non-core only"
                },
                {
                    "name": "Two handedness",
                    "stat": "is_two_handed",
                    "true_name": "Two handed",
                    "false_name": "Non-two handed"
                },
                {
                    "name": "Finesse",
                    "stat": "is_finesse",
                    "true_name": "Finesse",
                    "false_name": "Non-finesse"
                },
                {
                    "name": "Silver",
                    "stat": "is_silver",
                    "true_name": "Silver",
                    "false_name": "Non-silver"
                },
                {
                    "name": "Throwability",
                    "stat": "is_thrown",
                    "true_name": "Thrown",
                    "false_name": "Non-thrown"
                },
                {
                    "name": "Heaviness",
                    "stat": "is_heavy",
                    "true_name": "Heavy",
                    "false_name": "Non-heavy"
                },
                {
                    "name": "Lightness",
                    "stat": "is_light",
                    "true_name": "Light",
                    "false_name": "Non-light"
                },
                {
                    "name": "Loading capacity",
                    "stat": "is_loading",
                    "true_name": "Loading",
                    "false_name": "Non-loading"
                },
                {
                    "name": "Reachability",
                    "stat": "is_reach",
                    "true_name": "Reach",
                    "false_name": "Non-reach"
                },
                {
                    "name": "Specialness",
                    "stat": "is_special",
                    "true_name": "Special",
                    "false_name": "Non-special"
                },
                {
                    "name": "Improvised",
                    "stat": "is_improvised",
                    "true_name": "Improvised",
                    "false_name": "Non-improvised"
                },
                {
                    "name": "Range",
                    "stat": "is_range",
                    "true_name": "Range",
                    "false_name": "Melee"
                },
                {
                    "name": "Versatility",
                    "stat": "is_versatile",
                    "true_name": "Versatile",
                    "false_name": "Non-versatile"
                },
                {
                    "name": "Attunement need",
                    "stat": "requires_attunement",
                    "true_name": "Requires attunement",
                    "false_name": "No attunement"
                },
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                },
                {
                    "name": "Mastery",
                    "stat": "mastery",
                    "options": "weapon_masteries"
                },
                {
                    "name": "Rarity",
                    "stat": "rarity",
                    "options": "item_rarity"
                }
            ],
            "sort_options": [
                {
                    "name": "by type",
                    "stat": "display_type",
                    "options": "weapon_general_types"
                },
                {
                    "name": "by rarity",
                    "stat": "rarity",
                    "options": "item_rarity"
                }
            ],
            "mechanics": [
                {
                    "id": "weapon_attune",
                    "event_names": "toggle_attunement",
                    "effects": {
                        "type": "setStat",
                        "stat": "is_attuned",
                        "new_value": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "is_attuned"
                            }
                        },
                        "aggregation_type": "set"
                    }
                },
                {
                    "id": "weapon_shoot_ammunition",
                    "event_names": "shoot_ammo",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "notNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_item_to_shoot"
                                            }
                                        },
                                        "effect": {
                                            "type": "addToStat",
                                            "stat": "selected_item_to_shoot.quantity",
                                            "value": {
                                                "type": "constant",
                                                "value": -1,
                                                "value_type": "integer"
                                            },
                                            "aggregation_type": "set"
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "fireEvent",
                                "event_names": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": "remove_empty_items",
                                            "value_type": "string"
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "weapon_roll_attack",
                    "event_names": "attack",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "stat",
                                            "stat": "has_ammunition"
                                        },
                                        "effect": {
                                            "type": "fireEvent",
                                            "event": {
                                                "name": "shoot_ammo"
                                            }
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "roll",
                                "rolls": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "rollable",
                                            "formulas": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "when",
                                                                    "clauses": [
                                                                        {
                                                                            "condition": {
                                                                                "type": "equals",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.weapon_display_advantage_disadvantage_select"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "disadvantage",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            },
                                                                            "components": {
                                                                                "type": "constant",
                                                                                "value": "min(2d20) + ",
                                                                                "value_type": "string"
                                                                            }
                                                                        },
                                                                        {
                                                                            "condition": {
                                                                                "type": "equals",
                                                                                "components": {
                                                                                    "type": "list",
                                                                                    "components": [
                                                                                        {
                                                                                            "type": "stat",
                                                                                            "stat": "$view.weapon_display_advantage_disadvantage_select"
                                                                                        },
                                                                                        {
                                                                                            "type": "constant",
                                                                                            "value": "advantage",
                                                                                            "value_type": "string"
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            },
                                                                            "components": {
                                                                                "type": "constant",
                                                                                "value": "max(2d20) + ",
                                                                                "value_type": "string"
                                                                            }
                                                                        },
                                                                        {
                                                                            "condition": {
                                                                                "type": "constant",
                                                                                "value": true,
                                                                                "value_type": "bool"
                                                                            },
                                                                            "components": {
                                                                                "type": "constant",
                                                                                "value": "1d20 + ",
                                                                                "value_type": "string"
                                                                            }
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "attack_bonus"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            "text": {
                                                "type": "constant",
                                                "value": "to hit",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "type": "delayed",
                                "millis": 500,
                                "effect": {
                                    "type": "dismissResource"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "weapon_roll_damage",
                    "event_names": "damage",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "roll",
                                "rolls": {
                                    "type": "map",
                                    "components": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "and",
                                                    "components": {
                                                        "type": "list",
                                                        "components": [
                                                            {
                                                                "type": "stat",
                                                                "stat": "is_versatile"
                                                            },
                                                            {
                                                                "type": "defaultIfNull",
                                                                "components": {
                                                                    "type": "stat",
                                                                    "stat": "$view?.weapon_versatile_toggle?"
                                                                },
                                                                "default_components": {
                                                                    "type": "constant",
                                                                    "value": false,
                                                                    "value_type": "bool"
                                                                }
                                                            }
                                                        ]
                                                    }
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "versatile_damage_dice"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "damage_dice"
                                                }
                                            }
                                        ]
                                    },
                                    "mapper": {
                                        "type": "rollable",
                                        "formulas": {
                                            "type": "flatAppend",
                                            "components": [
                                                {
                                                    "type": "map",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$mapValue.dices"
                                                    },
                                                    "mapper": {
                                                        "type": "stat",
                                                        "stat": "$mapValue.formula"
                                                    }
                                                },
                                                {
                                                    "type": "when",
                                                    "clauses": [
                                                        {
                                                            "condition": {
                                                                "type": "notEquals",
                                                                "components": {
                                                                    "type": "list",
                                                                    "components": [
                                                                        {
                                                                            "type": "stat",
                                                                            "stat": "damage_bonus"
                                                                        },
                                                                        {
                                                                            "type": "constant",
                                                                            "value": 0,
                                                                            "value_type": "integer"
                                                                        }
                                                                    ]
                                                                }
                                                            },
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "toSignedString",
                                                                        "components": {
                                                                            "type": "stat",
                                                                            "stat": "damage_bonus"
                                                                        }
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            "condition": {
                                                                "type": "constant",
                                                                "value": true,
                                                                "value_type": "bool"
                                                            },
                                                            "components": {
                                                                "type": "list",
                                                                "components": []
                                                            }
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        "text": {
                                            "type": "stat",
                                            "stat": "$mapValue.damage_type"
                                        }
                                    }
                                }
                            },
                            {
                                "type": "delayed",
                                "millis": 500,
                                "effect": {
                                    "type": "dismissResource"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "weapon_edit",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "weapon_edit_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.weapon_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your weapon",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "weapon_edit_source_core",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "weapon_edit_source",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "weapon_edit_source_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Source: ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "weapon_edit_source_select",
                                        "type": "select",
                                        "options": "source",
                                        "options_display_stat": "abbreviation",
                                        "stat": "source"
                                    }
                                ]
                            },
                            {
                                "id": "weapon_edit_is_core",
                                "type": "checkbox",
                                "stat": "is_core",
                                "label": {
                                    "type": "constant",
                                    "value": "Core",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "weapon_edit_mastery",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "weapon_edit_mastery_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Mastery: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "weapon_edit_mastery_select",
                                "type": "select",
                                "options": "weapon_masteries",
                                "stat": "mastery"
                            }
                        ]
                    },
                    {
                        "id": "weapon_edit_description",
                        "type": "text",
                        "edit_stat": "description",
                        "label": {
                            "type": "constant",
                            "value": "Description",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "weapon_edit_weight_cost_composite",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "weapon_edit_price_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Price: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "weapon_edit_price",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "cost",
                                "stat": "cost",
                                "create_if_empty": true
                            },
                            {
                                "id": "weapon_edit_weight_label",
                                "type": "text",
                                "margin_left": 4,
                                "text": {
                                    "type": "constant",
                                    "value": "Weight: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "weapon_edit_weight",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "weight",
                                "stat": "weight",
                                "create_if_empty": true
                            }
                        ]
                    },
                    {
                        "id": "weapon_edit_type_attack_ability",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "weapon_edit_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Type: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "weapon_edit_type",
                                "type": "select",
                                "options": "weapon_types",
                                "stat": "type"
                            },
                            {
                                "id": "weapon_edit_attack_ability_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Atk. ability: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "weapon_edit_attack_ability",
                                "type": "select",
                                "options": "ability",
                                "stat": "attack_ability"
                            },
                            {
                                "id": "weapon_edit_add_attack_ability_to_damage",
                                "type": "checkbox",
                                "stat": "add_attack_ability_to_damage",
                                "label": {
                                    "type": "constant",
                                    "value": "Add to damage",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "style": "checkbox"
                            }
                        ]
                    },
                    {
                        "id": "weapon_edit_rarity_requires_attunement",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "weapon_edit_rarity_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Rarity: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "weapon_edit_rarity",
                                "type": "select",
                                "options": "item_rarity",
                                "stat": "rarity"
                            },
                            {
                                "id": "weapon_edit_requires_attunement",
                                "type": "checkbox",
                                "stat": "requires_attunement",
                                "label": {
                                    "type": "constant",
                                    "value": "Requires attunement",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "weapon_edit_properties_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "weapon_edit_is_simple",
                                "type": "checkbox",
                                "stat": "is_simple",
                                "label": {
                                    "type": "constant",
                                    "value": "Simple",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_two_handed",
                                "type": "checkbox",
                                "stat": "is_two_handed",
                                "label": {
                                    "type": "constant",
                                    "value": "Two-handed",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_finesse",
                                "type": "checkbox",
                                "stat": "is_finesse",
                                "label": {
                                    "type": "constant",
                                    "value": "Finesse",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "is_silver",
                                "type": "checkbox",
                                "stat": "is_silver",
                                "label": {
                                    "type": "constant",
                                    "value": "Silver",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_heavy",
                                "type": "checkbox",
                                "stat": "is_heavy",
                                "label": {
                                    "type": "constant",
                                    "value": "Heavy",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_light",
                                "type": "checkbox",
                                "stat": "is_light",
                                "label": {
                                    "type": "constant",
                                    "value": "Light",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_loading",
                                "type": "checkbox",
                                "stat": "is_loading",
                                "label": {
                                    "type": "constant",
                                    "value": "Loading",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_special",
                                "type": "checkbox",
                                "stat": "is_special",
                                "label": {
                                    "type": "constant",
                                    "value": "Special",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_improvised",
                                "type": "checkbox",
                                "stat": "is_improvised",
                                "label": {
                                    "type": "constant",
                                    "value": "Improvised",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_is_thrown",
                                "type": "checkbox",
                                "stat": "is_thrown",
                                "label": {
                                    "type": "constant",
                                    "value": "Thrown",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_thrown_range",
                                "type": "text",
                                "edit_stat": "thrown_range",
                                "style": "text",
                                "max_length": 9,
                                "hint": {
                                    "type": "constant",
                                    "value": "80/320",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.weapon_edit_is_thrown"
                                }
                            },
                            {
                                "id": "weapon_edit_is_reach",
                                "type": "checkbox",
                                "stat": "is_reach",
                                "label": {
                                    "type": "constant",
                                    "value": "Reach",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_reach_range",
                                "type": "text",
                                "edit_stat": "reach_range",
                                "style": "text",
                                "max_length": 3,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "5",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.weapon_edit_is_reach"
                                }
                            },
                            {
                                "id": "weapon_edit_is_versatile",
                                "type": "checkbox",
                                "stat": "is_versatile",
                                "label": {
                                    "type": "constant",
                                    "value": "Versatile",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "edit_weapon_range_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "weapon_edit_is_range",
                                "type": "checkbox",
                                "stat": "is_range",
                                "label": {
                                    "type": "constant",
                                    "value": "Range",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "weapon_edit_range_amount",
                                "type": "text",
                                "edit_stat": "range",
                                "style": "text",
                                "max_length": 9,
                                "hint": {
                                    "type": "constant",
                                    "value": "80/320",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.weapon_edit_is_range"
                                }
                            },
                            {
                                "id": "weapon_edit_ammunition_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Ammunition: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.weapon_edit_is_range"
                                }
                            },
                            {
                                "id": "weapon_edit_ammunition_type",
                                "type": "select",
                                "options": "ammunition_types",
                                "stat": "ammunition_type",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.weapon_edit_is_range"
                                }
                            }
                        ]
                    },
                    {
                        "id": "weapon_edit_extra_attack_bonus_override_is_proficient",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "weapon_edit_extra_attack_bonus_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Extra atk. bonus: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "weapon_edit_extra_attack_bonus",
                                "type": "text",
                                "edit_stat": "extra_attack_bonus",
                                "style": "text",
                                "max_length": 3,
                                "signed": true,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "weapon_edit_override_is_proficient",
                                "type": "checkbox",
                                "stat": "override_is_proficient",
                                "label": {
                                    "type": "constant",
                                    "value": "Proficient",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "defined",
                                    "stat": "$character"
                                }
                            }
                        ]
                    },
                    {
                        "id": "weapon_edit_damage_dice",
                        "type": "resourceArray",
                        "resource_id": "damage_dice",
                        "view_type": "edit",
                        "left_view": {
                            "id": "weapon_edit_damage_dice_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Damage dice: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "stat": "damage_dice"
                    },
                    {
                        "id": "weapon_edit_versatile_damage_dice",
                        "type": "resourceArray",
                        "resource_id": "damage_dice",
                        "view_type": "edit",
                        "left_view": {
                            "id": "weapon_edit_versatile_damage_dice_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Versatile damage dice: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "stat": "versatile_damage_dice",
                        "is_visible": {
                            "type": "stat",
                            "stat": "$view.weapon_edit_is_versatile"
                        }
                    },
                    {
                        "id": "weapon_edit_effects",
                        "type": "resourceArray",
                        "resource_id": "effect",
                        "view_type": "edit",
                        "stat": "effects",
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "edit_display_name"
                        },
                        "left_view": {
                            "id": "weapon_edit_effects_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Effects: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    }                    
                ]
            },
            "search_item_view": {
                "id": "weapon_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "properties"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "display_first_line_extra"
                },
                "second_line_extra": {
                    "type": "stat",
                    "stat": "display_second_line_extra"
                },
                "second_line_extra_color": {
                    "type": "stat",
                    "stat": "second_line_extra_color"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "list_view": {
                "id": "weapon_list",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "properties"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "display_first_line_extra"
                },
                "first_line_extra_color": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "defined",
                                "stat": "$character"
                            },
                            "components": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "stat",
                                            "stat": "is_proficient"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "accent",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "text",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": "text",
                                "value_type": "string"
                            }
                        }
                    ]
                },
                "second_line_extra": {
                    "type": "stat",
                    "stat": "display_second_line_extra"
                },
                "second_line_extra_color": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "defined",
                                "stat": "$character"
                            },
                            "components": {
                                "type": "constant",
                                "value": "text",
                                "value_type": "string"
                            }
                        },
                        {
                            "condition": {
                                "type": "not",
                                "components": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "effects"
                                    }
                                }
                            },
                            "components": {
                                "type": "constant",
                                "value": "accent",
                                "value_type": "string"
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": "text",
                                "value_type": "string"
                            }
                        }
                    ]
                },
                "chips": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "is_attuned"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "createChip",
                                                "id": "attuned_chip",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "ATTUNED",
                                                    "value_type": "string"
                                                },
                                                "background_color": {
                                                    "type": "constant",
                                                    "value": "#4caf50",
                                                    "value_type": "string"
                                                },
                                                "style": {
                                                    "type": "constant",
                                                    "value": "compact",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            "display_view": {
                "id": "weapon_display",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "weapon_display_info",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "weapon_display_source",
                                "type": "text",
                                "margin_left": 16,
                                "style": "caption",
                                "resource_id": "source",
                                "resource_instance_ids_stat": "source",
                                "resource_display_stat": "abbreviation"
                            },
                            {
                                "id": "weapon_display_source_separator",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": ", ",
                                    "value_type": "string"
                                },
                                "style": "caption"
                            },
                            {
                                "id": "weapon_display_properties",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "properties"
                                },
                                "style": "caption",
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "properties"
                                        }
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "id": "weapon_display_character_properties",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "weapon_display_proficient",
                                "type": "text",
                                "margin_left": 16,
                                "text": {
                                    "type": "constant",
                                    "value": "Proficient",
                                    "value_type": "string"
                                },
                                "style": "caption",
                                "color": {
                                    "type": "constant",
                                    "value": "accent",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_proficient"
                                }
                            },
                            {
                                "id": "weapon_display_attuned",
                                "type": "text",
                                "margin_left": 16,
                                "text": {
                                    "type": "constant",
                                    "value": "Attuned",
                                    "value_type": "string"
                                },
                                "style": "caption",
                                "color": {
                                    "type": "constant",
                                    "value": "#4CAF50",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_attuned"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        }
                    },
                    {
                        "id": "weapon_display_type_composite",
                        "type": "composite",
                        "margin_top": 16,
                        "subviews": [
                            {
                                "id": "weapon_display_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Type: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "weapon_display_type_label",
                                "type": "text",
                                "text": {
                                    "type": "enumeratedName",
                                    "enumerated_type": "weapon_types",
                                    "id": {
                                        "type": "stat",
                                        "stat": "type"
                                    }
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "weapon_display_mastery_composite",
                        "type": "composite",
                        "margin_top": 16,
                        "subviews": [
                            {
                                "id": "weapon_display_mastery_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Mastery: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "weapon_display_mastery_label",
                                "type": "text",
                                "text": {
                                    "type": "enumeratedName",
                                    "enumerated_type": "weapon_masteries",
                                    "id": {
                                        "type": "stat",
                                        "stat": "mastery"
                                    }
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "weapon_display_attack_bonus_composite",
                        "type": "composite",
                        "margin_top": 8,
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        },
                        "subviews": [
                            {
                                "id": "weapon_display_attack_bonus_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Attack Bonus: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "weapon_display_attack_bonus_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_attack_bonus"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "weapon_display_damage_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "weapon_display_damage_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Damage: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "weapon_display_damage_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "damage_dice_display_description"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "weapon_display_versatile_damage_composite",
                        "type": "composite",
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defined",
                                        "stat": "$character"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "is_versatile"
                                    }
                                ]
                            }
                        },
                        "subviews": [
                            {
                                "id": "weapon_display_damage_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Damage (two-handed): ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "weapon_display_damage_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "versatile_damage_dice_display_description"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "weapon_display_description",
                        "type": "text",
                        "margin_top": 16,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "description"
                                }
                            }
                        }
                    },
                    {
                        "id": "weapon_display_effects_collapsible",
                        "type": "collapsible",
                        "margin_top": 8,
                        "title": {
                            "type": "constant",
                            "value": "Magic effects",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "effects"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "weapon_display_effects",
                                "type": "resourceArray",
                                "resource_id": "effect",
                                "stat": "effects",
                                "view_type": "display"
                            }
                        ]
                    },
                    {
                        "id": "weapon_display_in_character_controls",
                        "type": "list",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        },
                        "subviews": [
                            {
                                "id": "weapon_versatile_toggle_composite",
                                "type": "composite",
                                "alignment": "end",
                                "subviews": [
                                    {
                                        "id": "weapon_versatile_toggle",
                                        "type": "checkbox",
                                        "stat": "currently_used_as_versatile",
                                        "label": {
                                            "type": "when",
                                            "clauses": [
                                                {
                                                    "condition": {
                                                        "type": "defaultIfNull",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view?.weapon_versatile_toggle?"
                                                        },
                                                        "default_components": {
                                                            "type": "constant",
                                                            "value": false,
                                                            "value_type": "bool"
                                                        }
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": "Two-handed",
                                                        "value_type": "string"
                                                    }
                                                },
                                                {
                                                    "condition": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": "One-handed",
                                                        "value_type": "string"
                                                    }
                                                }
                                            ]
                                        },
                                        "label_alignment": "right",
                                        "style": "switcher",
                                        "is_visible": {
                                            "type": "stat",
                                            "stat": "is_versatile"
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "weapon_display_attune_advantage_composite",
                                "type": "composite",
                                "row_only": true,
                                "subviews": [
                                    {
                                        "id": "weapon_display_attune_button",
                                        "type": "button",
                                        "text": {
                                            "type": "when",
                                            "clauses": [
                                                {
                                                    "condition": {
                                                        "type": "stat",
                                                        "stat": "is_attuned"
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": "UNATTUNE",
                                                        "value_type": "string"
                                                    }
                                                },
                                                {
                                                    "condition": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": "ATTUNE",
                                                        "value_type": "string"
                                                    }
                                                }
                                            ]
                                        },
                                        "event": {
                                            "name": "toggle_attunement"
                                        },
                                        "is_visible": {
                                            "type": "stat",
                                            "stat": "requires_attunement"
                                        }
                                    },
                                    {
                                        "id": "weapon_display_attune_advantage_spacer",
                                        "type": "spacer"
                                    },
                                    {
                                        "id": "weapon_display_advantage_disadvantage_select",
                                        "type": "select",
                                        "stat": "advantage_status",
                                        "options": "advantage_status"
                                    }
                                ]
                            },
                            {
                                "id": "weapon_display_ammunition_use_composite",
                                "type": "composite",
                                "alignment": "end",
                                "subviews": [
                                    {
                                        "id": "weapon_display_ammunition_select",
                                        "type": "select",
                                        "stat": "temp_shoot_ammo",
                                        "resource_options": {
                                            "type": "stat",
                                            "stat": "ammunition_items"
                                        },
                                        "options_display_stat": "name_with_amount",
                                        "is_visible": {
                                            "type": "stat",
                                            "stat": "has_ammunition"
                                        }
                                    },
                                    {
                                        "id": "weapon_display_attack_button",
                                        "type": "button",
                                        "text": {
                                            "type": "when",
                                            "clauses": [
                                                {
                                                    "condition": {
                                                        "type": "stat",
                                                        "stat": "has_ammunition"
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": "SHOOT",
                                                        "value_type": "string"
                                                    }
                                                },
                                                {
                                                    "condition": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": "ATTACK",
                                                        "value_type": "string"
                                                    }
                                                }
                                            ]
                                        },
                                        "event": {
                                            "name": "attack"
                                        }
                                    },
                                    {
                                        "id": "weapon_display_attack_button",
                                        "type": "button",
                                        "text": {
                                            "type": "constant",
                                            "value": "DAMAGE",
                                            "value_type": "string"
                                        },
                                        "event": {
                                            "name": "damage"
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "armor",
            "name": "Armor",
            "plural": "Armors",
            "core": true,
            "color": "#FFA000",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "is_core",
                    "name": "Core",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "cost",
                    "name": "Cost",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "weight",
                    "name": "Weight",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "type",
                    "name": "Type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "light"
                },
                {
                    "id": "rarity",
                    "name": "Rarity",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "common"
                },
                {
                    "id": "impose_stealth_disadvantage",
                    "name": "Stealth disadvantage",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "base_ac",
                    "name": "Base AC",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "modifier",
                    "name": "Modifier",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "none"
                },
                {
                    "id": "has_max_bonus",
                    "name": "Has max bonus",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "max_bonus",
                    "name": "Max bonus",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "required_strength",
                    "name": "Required strength",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "requires_attunement",
                    "name": "Requires attunement",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$parent?.should_load_effects?"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        }
                    }
                },
                {
                    "id": "effects",
                    "name": "Effects",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "effect",
                    "default_value": []
                },
                {
                    "id": "override_is_proficient",
                    "name": "Override is proficient",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_attuned",
                    "name": "Is attuned",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "equip_stat_name",
                    "name": "Equip stat name",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "shield",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "$character.equipped_shield_id",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "$character.equipped_armor_id",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "requires_equipping",
                    "name": "Requires equipping to activate effects",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "is_equipped",
                    "name": "Is equipped",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "metaStat",
                                                "potential_stat_values": [
                                                    "$character.equipped_shield_id",
                                                    "$character.equipped_armor_id"
                                                ],
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "equip_stat_name"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "id"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "is_proficient",
                    "name": "Is proficient",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "override_is_proficient"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            "components": {
                                                "type": "contains",
                                                "haystack": {
                                                    "type": "stat",
                                                    "stat": "$character.armor_proficiencies"
                                                },
                                                "needle": {
                                                    "type": "stat",
                                                    "stat": "type"
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": false,
                                                "value_type": "bool"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "properties",
                    "name": "Properties",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "rarity"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "enumeratedName",
                                                        "enumerated_type": "item_rarity",
                                                        "id": {
                                                            "type": "stat",
                                                            "stat": "rarity"
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "impose_stealth_disadvantage"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "Dis. on stealth",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "requires_attunement"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "Req. attunement",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "cost?.value"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "cost.description"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "weight?.value"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "weight.description"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "armor_class",
                    "name": "Armor class",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "shield",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "+",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "stat",
                                    "stat": "base_ac"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "modifier"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": " + ",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "enumeratedName",
                                                            "enumerated_type": "ability_plus_none",
                                                            "id": {
                                                                "type": "stat",
                                                                "stat": "modifier"
                                                            }
                                                        },
                                                        {
                                                            "type": "when",
                                                            "clauses": [
                                                                {
                                                                    "condition": {
                                                                        "type": "stat",
                                                                        "stat": "has_max_bonus"
                                                                    },
                                                                    "components": {
                                                                        "type": "concat",
                                                                        "components": {
                                                                            "type": "list",
                                                                            "components": [
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": " (max ",
                                                                                    "value_type": "string"
                                                                                },
                                                                                {
                                                                                    "type": "stat",
                                                                                    "stat": "max_bonus"
                                                                                },
                                                                                {
                                                                                    "type": "constant",
                                                                                    "value": ")",
                                                                                    "value_type": "string"
                                                                                }
                                                                            ]
                                                                        }
                                                                    }
                                                                },
                                                                {
                                                                    "condition": {
                                                                        "type": "constant",
                                                                        "value": true,
                                                                        "value_type": "bool"
                                                                    },
                                                                    "components": {
                                                                        "type": "constant",
                                                                        "value": "",
                                                                        "value_type": "string"
                                                                    }
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "required_strength_summary",
                    "name": "Required strength summary",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "greaterThan",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "required_strength"
                                            },
                                            {
                                                "type": "constant",
                                                "value": 0,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "STR ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "required_strength"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                }
            ],
            "indexed_stats": [
                "name",
                "is_core",
                "properties",
                "armor_class",
                "required_strength_summary",
                "source",
                "type",
                "requires_attunement",
                "rarity"
            ],
            "search_filters": [
                {
                    "name": "Type",
                    "stat": "type",
                    "options": "armor_types"
                },
                {
                    "name": "Core only?",
                    "stat": "is_core",
                    "true_name": "Core only",
                    "false_name": "Non-core only"
                },
                {
                    "name": "Attunement need",
                    "stat": "requires_attunement",
                    "true_name": "Requires attunement",
                    "false_name": "No attunement"
                },
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                },
                {
                    "name": "Rarity",
                    "stat": "rarity",
                    "options": "item_rarity"
                }
            ],
            "sort_options": [
                {
                    "name": "by type",
                    "stat": "type",
                    "options": "armor_types"
                },
                {
                    "name": "by rarity",
                    "stat": "rarity",
                    "options": "item_rarity"
                }
            ],
            "mechanics": [
                {
                    "id": "armor_attune",
                    "event_names": "toggle_attunement",
                    "effects": {
                        "type": "setStat",
                        "stat": "is_attuned",
                        "new_value": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "is_attuned"
                            }
                        },
                        "aggregation_type": "set"
                    }
                },
                {
                    "id": "armor_equip",
                    "event_names": "toggle_equip",
                    "effects": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "is_equipped"
                                },
                                "effect": {
                                    "type": "setStat",
                                    "meta_stat": {
                                        "type": "stat",
                                        "stat": "equip_stat_name"
                                    },
                                    "new_value": {
                                        "type": "constant",
                                        "value": "",
                                        "value_type": "string"
                                    },
                                    "aggregation_type": "set"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "effect": {
                                    "type": "setStat",
                                    "meta_stat": {
                                        "type": "stat",
                                        "stat": "equip_stat_name"
                                    },
                                    "new_value": {
                                        "type": "stat",
                                        "stat": "id"
                                    },
                                    "aggregation_type": "set"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "armor_edit",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "armor_edit_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.armor_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your armor",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "armor_edit_source_core",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "armor_edit_source",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "armor_edit_source_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Source: ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "armor_edit_source_select",
                                        "type": "select",
                                        "options": "source",
                                        "options_display_stat": "abbreviation",
                                        "stat": "source"
                                    }
                                ]
                            },
                            {
                                "id": "armor_edit_is_core",
                                "type": "checkbox",
                                "stat": "is_core",
                                "label": {
                                    "type": "constant",
                                    "value": "Core",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_description",
                        "type": "text",
                        "edit_stat": "description",
                        "label": {
                            "type": "constant",
                            "value": "Description",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "armor_edit_weight_cost_composite",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "armor_edit_price_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Price: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "armor_edit_price",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "cost",
                                "stat": "cost",
                                "create_if_empty": true
                            },
                            {
                                "id": "armor_edit_weight_label",
                                "type": "text",
                                "margin_left": 4,
                                "text": {
                                    "type": "constant",
                                    "value": "Weight: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "armor_edit_weight",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "weight",
                                "stat": "weight",
                                "create_if_empty": true
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_type_is_proficient_composite",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "armor_edit_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Type: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "armor_edit_type",
                                "type": "select",
                                "options": "armor_types",
                                "stat": "type"
                            },
                            {
                                "id": "armor_edit_is_proficient",
                                "type": "checkbox",
                                "stat": "override_is_proficient",
                                "label": {
                                    "type": "constant",
                                    "value": "Proficient",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "defined",
                                    "stat": "$character"
                                }
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_rarity",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "armor_edit_rarity_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Rarity: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "armor_edit_rarity",
                                "type": "select",
                                "options": "item_rarity",
                                "stat": "rarity"
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_stealth_disadvantage_override_requires_attunement_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "armor_edit_stealth_disadvantage",
                                "type": "checkbox",
                                "stat": "impose_stealth_disadvantage",
                                "label": {
                                    "type": "constant",
                                    "value": "Stealth Disadv.",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "armor_edit_requires_attunement",
                                "type": "checkbox",
                                "stat": "requires_attunement",
                                "label": {
                                    "type": "constant",
                                    "value": "Requires attunement",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_base_ac_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "armor_edit_base_ac_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Base AC: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "armor_edit_base_ac",
                                "type": "text",
                                "edit_stat": "base_ac",
                                "style": "text",
                                "max_length": 2,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_modifier_composite",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "armor_edit_modifier_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Modifier: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "armor_edit_modifier",
                                "type": "select",
                                "options": "ability_plus_none",
                                "stat": "modifier"
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_max_bonus_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "armor_edit_has_max_bonus",
                                "type": "checkbox",
                                "stat": "has_max_bonus",
                                "label": {
                                    "type": "constant",
                                    "value": "Has max bonus",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "armor_edit_max_bonus",
                                "type": "text",
                                "edit_stat": "max_bonus",
                                "style": "text",
                                "max_length": 2,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.armor_edit_has_max_bonus"
                                }
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_required_strength_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "armor_edit_required_strength_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Required strength: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "armor_edit_required_strength",
                                "type": "text",
                                "edit_stat": "required_strength",
                                "style": "text",
                                "max_length": 2,
                                "signed": false,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "armor_edit_effects",
                        "type": "resourceArray",
                        "resource_id": "effect",
                        "view_type": "edit",
                        "stat": "effects",
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "edit_display_name"
                        },
                        "left_view": {
                            "id": "armor_edit_effects_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Effects: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    }
                ]
            },
            "search_item_view": {
                "id": "armor_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "properties"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "armor_class"
                },
                "second_line_extra": {
                    "type": "stat",
                    "stat": "required_strength_summary"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "list_view": {
                "id": "armor_list",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "properties"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "armor_class"
                },
                "first_line_extra_color": {
                    "type": "when",
                    "clauses": [
                        {
                            "condition": {
                                "type": "defined",
                                "stat": "$character"
                            },
                            "components": {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "stat",
                                            "stat": "is_proficient"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "accent",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "constant",
                                            "value": "text",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            }
                        },
                        {
                            "condition": {
                                "type": "constant",
                                "value": true,
                                "value_type": "bool"
                            },
                            "components": {
                                "type": "constant",
                                "value": "text",
                                "value_type": "string"
                            }
                        }
                    ]
                },
                "second_line_extra": {
                    "type": "stat",
                    "stat": "required_strength_summary"
                },
                "chips": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "is_equipped"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "createChip",
                                                "id": "equipped_chip",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "EQUIPPED",
                                                    "value_type": "string"
                                                },
                                                "background_color": {
                                                    "type": "constant",
                                                    "value": "#4caf50",
                                                    "value_type": "string"
                                                },
                                                "style": {
                                                    "type": "constant",
                                                    "value": "compact",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "is_attuned"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "createChip",
                                                "id": "attuned_chip",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "ATTUNED",
                                                    "value_type": "string"
                                                },
                                                "background_color": {
                                                    "type": "constant",
                                                    "value": "#4caf50",
                                                    "value_type": "string"
                                                },
                                                "style": {
                                                    "type": "constant",
                                                    "value": "compact",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            "display_view": {
                "id": "armor_display",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "armor_display_info",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "armor_display_source",
                                "type": "text",
                                "margin_left": 16,
                                "style": "caption",
                                "resource_id": "source",
                                "resource_instance_ids_stat": "source",
                                "resource_display_stat": "abbreviation"
                            },
                            {
                                "id": "armor_display_source_separator",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": ", ",
                                    "value_type": "string"
                                },
                                "style": "caption"
                            },
                            {
                                "id": "armor_display_properties",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "properties"
                                },
                                "style": "caption",
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "properties"
                                        }
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "id": "armor_display_character_properties",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "armor_display_proficient",
                                "type": "text",
                                "margin_left": 16,
                                "text": {
                                    "type": "constant",
                                    "value": "Proficient",
                                    "value_type": "string"
                                },
                                "style": "caption",
                                "color": {
                                    "type": "constant",
                                    "value": "accent",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_proficient"
                                }
                            },
                            {
                                "id": "armor_display_equipped",
                                "type": "text",
                                "margin_left": 16,
                                "text": {
                                    "type": "constant",
                                    "value": "Equipped",
                                    "value_type": "string"
                                },
                                "style": "caption",
                                "color": {
                                    "type": "constant",
                                    "value": "#4CAF50",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_equipped"
                                }
                            },
                            {
                                "id": "armor_display_attuned",
                                "type": "text",
                                "margin_left": 16,
                                "text": {
                                    "type": "constant",
                                    "value": "Attuned",
                                    "value_type": "string"
                                },
                                "style": "caption",
                                "color": {
                                    "type": "constant",
                                    "value": "#4CAF50",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_attuned"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        }
                    },
                    {
                        "id": "armor_display_type_composite",
                        "type": "composite",
                        "margin_top": 16,
                        "subviews": [
                            {
                                "id": "armor_display_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Type: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "armor_display_type_label",
                                "type": "text",
                                "text": {
                                    "type": "enumeratedName",
                                    "enumerated_type": "armor_types",
                                    "id": {
                                        "type": "stat",
                                        "stat": "type"
                                    }
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "armor_display_armor_class_composite",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "armor_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Armor class: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "armor_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "armor_class"
                                },
                                "style": "text",
                                "color": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_proficient"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "accent",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "hint",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "id": "armor_display_required_strength_composite",
                        "type": "composite",
                        "is_visible": {
                            "type": "greaterThan",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "required_strength"
                                    },
                                    {
                                        "type": "constant",
                                        "value": 0,
                                        "value_type": "integer"
                                    }
                                ]
                            }
                        },
                        "subviews": [
                            {
                                "id": "armor_display_required_strength_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Required strength: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "armor_display_required_strength_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "required_strength"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "armor_display_description",
                        "type": "text",
                        "margin_top": 16,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "description"
                                }
                            }
                        }
                    },
                    {
                        "id": "armor_display_effects_collapsible",
                        "type": "collapsible",
                        "margin_top": 8,
                        "title": {
                            "type": "constant",
                            "value": "Magic effects",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "effects"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "armor_display_effects",
                                "type": "resourceArray",
                                "resource_id": "effect",
                                "stat": "effects",
                                "view_type": "display"
                            }
                        ]
                    },
                    {
                        "id": "armor_display_attune_advantage_composite",
                        "type": "composite",
                        "row_only": true,
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        },
                        "subviews": [
                            {
                                "id": "armor_display_attune_button",
                                "type": "button",
                                "text": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_attuned"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "UNATTUNE",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "ATTUNE",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                "event": {
                                    "name": "toggle_attunement"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "requires_attunement"
                                }
                            },
                            {
                                "id": "armor_display_attune_advantage_spacer",
                                "type": "spacer"
                            },
                            {
                                "id": "armor_display_equip_button",
                                "type": "button",
                                "text": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_equipped"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "UNEQUIP",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "EQUIP",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                "event": {
                                    "name": "toggle_equip"
                                }
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "item",
            "name": "Item",
            "plural": "Items",
            "core": true,
            "color": "#5D4037",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "type",
                    "name": "Type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "adventuring_gear"
                },
                {
                    "id": "cost",
                    "name": "Cost",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "weight",
                    "name": "Weight",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "ammunition_type",
                    "name": "Ammunition type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "arrow"
                },
                {
                    "id": "rarity",
                    "name": "Rarity",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "common"
                },
                {
                    "id": "is_magic",
                    "name": "Is magic",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "requires_attunement",
                    "name": "Requires attunement",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_cursed",
                    "name": "Is cursed",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_intelligent",
                    "name": "Is intelligent",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_spellcasting_focus",
                    "name": "Spellcasting Focus",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$parent?.should_load_effects?"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        }
                    }
                },
                {
                    "id": "effects",
                    "name": "Effects",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "effect",
                    "default_value": []
                },
                {
                    "id": "is_attuned",
                    "name": "Is attuned",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "is_equipped",
                    "name": "Is equipped",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "quantity",
                    "name": "Quantity",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "edit_quantity",
                    "name": "Edit quantity",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },
                {
                    "id": "requires_equipping",
                    "name": "Requires equipping to activate effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "ring",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "rod",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "wand",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "properties",
                    "name": "Properties",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "rarity"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "enumeratedName",
                                                            "enumerated_type": "item_rarity",
                                                            "id": {
                                                                "type": "stat",
                                                                "stat": "rarity"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": " ",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_magic"
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "magic ",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "enumeratedName",
                                    "enumerated_type": "item_types",
                                    "id": {
                                        "type": "stat",
                                        "stat": "type"
                                    }
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "requires_attunement"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": " (requires attunement)",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_cursed"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": ", cursed",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_intelligent"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": ", intelligent",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_spellcasting_focus"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": ", spellcasting focus.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "and",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "type"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "ammunition",
                                                                        "value_type": "string"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            "type": "notEquals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "ammunition_type"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "none",
                                                                        "value_type": "string"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": " (",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "enumeratedName",
                                                            "enumerated_type": "ammunition_types",
                                                            "id": {
                                                                "type": "stat",
                                                                "stat": "ammunition_type"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ")",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "price_and_weight",
                    "name": "Item price and weight",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "cost?.value"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "cost.description"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "weight?.value"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": 0,
                                                                "value_type": "integer"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "weight.description"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "first_line_extra",
                    "name": "Item price and weight or quantity (when in character)",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "quantity"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "price_and_weight"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "name_with_amount",
                    "name": "Name with amount",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "name"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "quantity"
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                }
            ],
            "indexed_stats": [
                "name",
                "properties",
                "first_line_extra",
                "source",
                "type",
                "rarity",
                "is_magic",
                "requires_attunement"
            ],
            "search_filters": [
                {
                    "name": "Type",
                    "stat": "type",
                    "options": "item_types"
                },
                {
                    "name": "Rarity",
                    "stat": "rarity",
                    "options": "item_rarity"
                },
                {
                    "name": "Magicality",
                    "stat": "is_magic",
                    "true_name": "Magic",
                    "false_name": "Non-magic"
                },
                {
                    "name": "Attunement need",
                    "stat": "requires_attunement",
                    "true_name": "Requires attunement",
                    "false_name": "No attunement"
                },
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "sort_options": [
                {
                    "name": "by type",
                    "stat": "type",
                    "options": "item_types"
                },
                {
                    "name": "by rarity",
                    "stat": "rarity",
                    "options": "item_rarity"
                }
            ],
            "mechanics": [
                {
                    "id": "item_attune",
                    "event_names": "toggle_attunement",
                    "effects": {
                        "type": "setStat",
                        "stat": "is_attuned",
                        "new_value": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "is_attuned"
                            }
                        },
                        "aggregation_type": "set"
                    }
                },
                {
                    "id": "item_equip",
                    "event_names": "toggle_equip",
                    "effects": {
                        "type": "setStat",
                        "stat": "is_equipped",
                        "new_value": {
                            "type": "not",
                            "components": {
                                "type": "stat",
                                "stat": "is_equipped"
                            }
                        },
                        "aggregation_type": "set"
                    }
                },
                {
                    "id": "item_add_quantity",
                    "event_names": "add_quantity",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "addToStat",
                                "stat": "quantity",
                                "value": {
                                    "type": "stat",
                                    "stat": "$view.item_quantity"
                                },
                                "aggregation_type": "set"
                            },
                            {
                                "type": "delayed",
                                "millis": 500,
                                "effect": {
                                    "type": "dismissResource"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "item_subtract_quantity",
                    "event_names": "subtract_quantity",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "addToStat",
                                "stat": "quantity",
                                "value": {
                                    "type": "multiply",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$view.item_quantity"
                                            },
                                            {
                                                "type": "constant",
                                                "value": -1,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                "aggregation_type": "set"
                            },
                            {
                                "type": "fireEvent",
                                "event_names": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": "remove_empty_items",
                                            "value_type": "string"
                                        }
                                    ]
                                }
                            },
                            {
                                "type": "delayed",
                                "millis": 500,
                                "effect": {
                                    "type": "dismissResource"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "item_edit",
                "type": "list",
                "padding": 32,
                "subviews": [
                    {
                        "id": "item_edit_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.item_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your item",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "item_edit_source",
                        "margin_top": 4,
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "item_edit_source_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Source: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "item_edit_source_select",
                                "type": "select",
                                "options": "source",
                                "options_display_stat": "abbreviation",
                                "stat": "source"
                            }
                        ]
                    },
                    {
                        "id": "item_edit_description",
                        "type": "text",
                        "edit_stat": "description",
                        "label": {
                            "type": "constant",
                            "value": "Description",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "item_edit_type_ammunition_type_composite",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "item_edit_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Type: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "item_edit_type",
                                "type": "select",
                                "options": "item_types",
                                "stat": "type"
                            },
                            {
                                "id": "item_edit_ammunition_type",
                                "type": "select",
                                "options": "ammunition_types",
                                "stat": "ammunition_type",
                                "is_visible": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$view.item_edit_type"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "ammunition",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "id": "item_edit_weight_cost_composite",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "item_edit_price_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Price: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "item_edit_price",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "cost",
                                "stat": "cost",
                                "create_if_empty": true
                            },
                            {
                                "id": "item_edit_weight_label",
                                "type": "text",
                                "margin_left": 4,
                                "text": {
                                    "type": "constant",
                                    "value": "Weight: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "item_edit_weight",
                                "type": "resource",
                                "view_type": "edit",
                                "resource_id": "weight",
                                "stat": "weight",
                                "create_if_empty": true
                            }
                        ]
                    },
                    {
                        "id": "item_edit_rarity_is_magic",
                        "type": "composite",
                        "margin_top": 4,
                        "subviews": [
                            {
                                "id": "item_edit_rarity_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Rarity: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "item_edit_rarity",
                                "type": "select",
                                "options": "item_rarity",
                                "stat": "rarity"
                            },
                            {
                                "id": "item_edit_is_magic",
                                "type": "checkbox",
                                "stat": "is_magic",
                                "label": {
                                    "type": "constant",
                                    "value": "Magic",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "item_edit_properties_composite",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "item_edit_requires_attunement",
                                "type": "checkbox",
                                "stat": "requires_attunement",
                                "label": {
                                    "type": "constant",
                                    "value": "Requires attunement",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.item_edit_is_magic"
                                }
                            },
                            {
                                "id": "item_edit_is_cursed",
                                "type": "checkbox",
                                "stat": "is_cursed",
                                "label": {
                                    "type": "constant",
                                    "value": "Cursed",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.item_edit_is_magic"
                                }
                            },
                            {
                                "id": "item_edit_is_intelligent",
                                "type": "checkbox",
                                "stat": "is_intelligent",
                                "label": {
                                    "type": "constant",
                                    "value": "Intelligent",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$view.item_edit_is_magic"
                                }
                            },
                            {
                                "id": "item_edit_is_spellcasting_focus",
                                "type": "checkbox",
                                "stat": "is_spellcasting_focus",
                                "label": {
                                    "type": "constant",
                                    "value": "Spellcasting focus",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            }
                        ]
                    },
                    {
                        "id": "item_edit_effects",
                        "type": "resourceArray",
                        "resource_id": "effect",
                        "view_type": "edit",
                        "stat": "effects",
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "edit_display_name"
                        },
                        "left_view": {
                            "id": "item_edit_effects_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Effects: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    }
                ]
            },
            "search_item_view": {
                "id": "item_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "properties"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "first_line_extra"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "list_view": {
                "id": "item_list",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "properties"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "first_line_extra"
                },
                "chips": {
                    "type": "flatAppend",
                    "components": [
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "is_equipped"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "createChip",
                                                "id": "equipped_chip",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "EQUIPPED",
                                                    "value_type": "string"
                                                },
                                                "background_color": {
                                                    "type": "constant",
                                                    "value": "#4caf50",
                                                    "value_type": "string"
                                                },
                                                "style": {
                                                    "type": "constant",
                                                    "value": "compact",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "is_attuned"
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "createChip",
                                                "id": "attuned_chip",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "ATTUNED",
                                                    "value_type": "string"
                                                },
                                                "background_color": {
                                                    "type": "constant",
                                                    "value": "#4caf50",
                                                    "value_type": "string"
                                                },
                                                "style": {
                                                    "type": "constant",
                                                    "value": "compact",
                                                    "value_type": "string"
                                                }
                                            }
                                        ]
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        }
                    ]
                }
            },
            "display_view": {
                "id": "item_display",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "item_display_current_quantity_composite",
                        "type": "composite",
                        "alignment": "end",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        },
                        "subviews": [
                            {
                                "id": "item_display_current_quantity_ticker",
                                "type": "ticker",
                                "stat": "quantity",
                                "style": "title"
                            }
                        ]
                    },
                    {
                        "id": "item_display_info",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "item_display_source",
                                "type": "text",
                                "margin_left": 16,
                                "style": "caption",
                                "resource_id": "source",
                                "resource_instance_ids_stat": "source",
                                "resource_display_stat": "abbreviation"
                            },
                            {
                                "id": "item_display_source_separator",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": ", ",
                                    "value_type": "string"
                                },
                                "style": "caption"
                            },
                            {
                                "id": "item_display_properties",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "properties"
                                },
                                "style": "caption",
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "properties"
                                        }
                                    }
                                }
                            }
                        ]
                    },
                    {
                        "id": "item_display_character_properties",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "item_display_equipped",
                                "type": "text",
                                "margin_left": 16,
                                "text": {
                                    "type": "constant",
                                    "value": "Equipped",
                                    "value_type": "string"
                                },
                                "style": "caption",
                                "color": {
                                    "type": "constant",
                                    "value": "#4CAF50",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_equipped"
                                }
                            },
                            {
                                "id": "item_display_attuned",
                                "type": "text",
                                "margin_left": 16,
                                "text": {
                                    "type": "constant",
                                    "value": "Attuned",
                                    "value_type": "string"
                                },
                                "style": "caption",
                                "color": {
                                    "type": "constant",
                                    "value": "#4CAF50",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_attuned"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        }
                    },
                    {
                        "id": "item_display_price_and_weight",
                        "type": "text",
                        "margin_left": 16,
                        "text": {
                            "type": "stat",
                            "stat": "price_and_weight"
                        },
                        "style": "caption",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "price_and_weight"
                                }
                            }
                        }
                    },
                    {
                        "id": "item_display_description",
                        "type": "text",
                        "margin_top": 16,
                        "text": {
                            "type": "stat",
                            "stat": "description"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "description"
                                }
                            }
                        }
                    },
                    {
                        "id": "item_display_effects_collapsible",
                        "type": "collapsible",
                        "margin_top": 8,
                        "title": {
                            "type": "constant",
                            "value": "Magic effects",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "effects"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "item_display_effects",
                                "type": "resourceArray",
                                "resource_id": "effect",
                                "stat": "effects",
                                "view_type": "display"
                            }
                        ]
                    },
                    {
                        "id": "item_quantity_composite",
                        "type": "composite",
                        "row_only": true,
                        "alignment": "end",
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        },
                        "subviews": [
                            {
                                "id": "item_quantity_spacer",
                                "type": "spacer"
                            },
                            {
                                "id": "item_quantity",
                                "type": "text",
                                "edit_stat": "edit_quantity",
                                "style": "text",
                                "max_length": 12,
                                "hint": {
                                    "type": "constant",
                                    "value": "Amount (default = 1)",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "item_display_attune_equip_add_remove_composite",
                        "type": "composite",
                        "row_only": true,
                        "is_visible": {
                            "type": "defined",
                            "stat": "$character"
                        },
                        "subviews": [
                            {
                                "id": "item_display_attune_button",
                                "type": "button",
                                "text": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_attuned"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "UNATTUNE",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "ATTUNE",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                "event": {
                                    "name": "toggle_attunement"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "requires_attunement"
                                }
                            },
                            {
                                "id": "item_display_equip_button",
                                "type": "button",
                                "text": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "is_equipped"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "UNEQUIP",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "EQUIP",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                },
                                "event": {
                                    "name": "toggle_equip"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "requires_equipping"
                                }
                            },
                            {
                                "id": "item_display_attune_equip_add_remove_spacer",
                                "type": "spacer"
                            },
                            {
                                "id": "item_display_add_button",
                                "type": "button",
                                "text":{
                                    "type": "constant",
                                    "value": "+ ADD",
                                    "value_type": "string"
                                },
                                "event": {
                                    "name": "add_quantity"
                                }
                            },
                            {
                                "id": "item_display_remove_button",
                                "type": "button",
                                "text":{
                                    "type": "constant",
                                    "value": "+ REMOVE",
                                    "value_type": "string"
                                },
                                "event": {
                                    "name": "subtract_quantity"
                                }
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "feat",
            "name": "Feat",
            "plural": "Feats",
            "core": true,
            "color": "#1E88E5",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "type",
                    "name": "Type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "general"
                },
                {
                    "id": "prerequisites",
                    "name": "Prerequisites",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "descriptions",
                    "name": "Descriptions",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_description",
                    "default_value": []
                },
                {
                    "id": "effects",
                    "name": "Effects",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_effect",
                    "default_value": []
                },
                {
                    "id": "selectable_feature_amount_per_level",
                    "name": "Selectable feature amount per level",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "has_selectable_features",
                    "name": "Has selectable features",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "selectable_features",
                    "name": "Selectable features",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "default_value": []
                },
                {
                    "id": "selectable_feature_ids",
                    "name": "Selectable feature ids",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "map",
                        "components": {
                            "type": "stat",
                            "stat": "selectable_features"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.id"
                        }
                    }
                },
                {
                    "id": "selected_selectable_feature_ids",
                    "name": "Selected selectable feature ids",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$parent?.selected_selectable_feature_ids"
                        },
                        "default_components": {
                            "type": "list",
                            "components": []
                        }
                    }
                },
                {
                    "id": "selected",
                    "name": "Selected",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "contains",
                        "haystack": {
                            "type": "stat",
                            "stat": "selected_selectable_feature_ids"
                        },
                        "needle": {
                            "type": "stat",
                            "stat": "id"
                        }
                    }
                },
                {
                    "id": "can_have_selectable_features",
                    "name": "Can have selectable features?",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "not",
                        "components": {
                            "type": "stat",
                            "stat": "is_selectable_feature"
                        }
                    }
                },
                {
                    "id": "level",
                    "name": "Level to use for determining what effects to trigger",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$parent.level"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character.level"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$character.level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 1,
                                    "value_type": "integer"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "levelled_description",
                    "name": "Levelled description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "descriptions"
                                    }
                                },
                                "components": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "name"
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "Empty",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "name"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "name"
                                                }
                                            },
                                            "components": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "lowest_level_description?.display_description"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": "",
                                                    "value_type": "string"
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "Lvl. ",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "defaultIfNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "lowest_level_description?.level"
                                                            },
                                                            "default_components": {
                                                                "type": "constant",
                                                                "value": "1",
                                                                "value_type": "string"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": ": ",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "name"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "min_level",
                    "name": "Minimum level for this feat",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "lowest_level_description?.level"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": 1,
                            "value_type": "integer"
                        }
                    }
                },
                {
                    "id": "lowest_level_description",
                    "name": "Lowest level description",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "levelled_description",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "descriptions"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": null,
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "findFirst",
                                    "components": {
                                        "type": "stat",
                                        "stat": "sorted_descriptions"
                                    },
                                    "filter": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "first_description_text",
                    "name": "First description text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "descriptions"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "No description",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "current_level_levelled_description?.description"
                                    },
                                    "default_components": {
                                        "type": "findFirst",
                                        "components": {
                                            "type": "map",
                                            "components": {
                                                "type": "sortBy",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "descriptions"
                                                },
                                                "sort_by_selector": {
                                                    "type": "stat",
                                                    "stat": "$sortByValue.level"
                                                }
                                            },
                                            "mapper": {
                                                "type": "stat",
                                                "stat": "$mapValue.description"
                                            }
                                        },
                                        "filter": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        }
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "findFirst",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "sortBy",
                                            "components": {
                                                "type": "stat",
                                                "stat": "descriptions"
                                            },
                                            "sort_by_selector": {
                                                "type": "stat",
                                                "stat": "$sortByValue.level"
                                            }
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.description"
                                        }
                                    },
                                    "filter": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "list_view_description",
                    "name": "List view description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "prerequisites"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "first_description_text"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "prerequisites"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "previous_level_levelled_description",
                    "name": "Previous level levelled_description",
                    "type": "calculated",
                    "value_type": "resource",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "descriptions"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "subtract",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "level"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 1,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "current_level_levelled_description",
                    "name": "Current level levelled_description",
                    "type": "calculated",
                    "value_type": "resource",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "descriptions"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "current_level_description",
                    "name": "Current level description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "descriptions"
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "current_level_levelled_description?.description"
                                                },
                                                "default_components": {
                                                    "type": "stat",
                                                    "stat": "first_description_text"
                                                }
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "first_description_text"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "min_required_level",
                    "name": "Minimum required level",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "descriptions"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": 999999,
                                    "value_type": "integer"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "findFirst",
                                    "components": {
                                        "type": "map",
                                        "components": {
                                            "type": "sortBy",
                                            "order": "asc",
                                            "components": {
                                                "type": "stat",
                                                "stat": "descriptions"
                                            },
                                            "sort_by_selector": {
                                                "type": "stat",
                                                "stat": "$sortByValue.level"
                                            }
                                        },
                                        "mapper": {
                                            "type": "stat",
                                            "stat": "$mapValue.level"
                                        }
                                    },
                                    "filter": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "can_be_used",
                    "name": "Can be_used",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "greaterThanEquals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "level"
                                },
                                {
                                    "type": "stat",
                                    "stat": "min_required_level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "available_effects_for_current_level",
                    "name": "Available effects for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "effect",
                    "components": {
                        "type": "map",
                        "components": {
                            "type": "filter",
                            "components": {
                                "type": "sortBy",
                                "order": "asc",
                                "components": {
                                    "type": "stat",
                                    "stat": "effects"
                                },
                                "sort_by_selector": {
                                    "type": "stat",
                                    "stat": "$sortByValue.level"
                                }
                            },
                            "filter": {
                                "type": "lessThanEquals",
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$filterValue.level"
                                        },
                                        {
                                            "type": "stat",
                                            "stat": "level"
                                        }
                                    ]
                                }
                            }
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.effect"
                        }
                    }
                },
                {
                    "id": "active_or_charge_effects_for_current_level",
                    "name": "Active or charge-only effects for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "effect",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "available_effects_for_current_level"
                        },
                        "filter": {
                            "type": "or",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.trigger_type"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": "active",
                                                    "value_type": "string"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.has_charges"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "sorted_descriptions",
                    "name": "Sorted descriptions",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_description",
                    "components": {
                        "type": "sortBy",
                        "order": "asc",
                        "components": {
                            "type": "stat",
                            "stat": "descriptions"
                        },
                        "sort_by_selector": {
                            "type": "stat",
                            "stat": "$sortByValue.level"
                        }
                    }
                },
                {
                    "id": "sorted_effects",
                    "name": "Sorted effects",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_effect",
                    "components": {
                        "type": "sortBy",
                        "order": "asc",
                        "components": {
                            "type": "stat",
                            "stat": "effects"
                        },
                        "sort_by_selector": {
                            "type": "stat",
                            "stat": "$sortByValue.level"
                        }
                    }
                },
                {
                    "id": "sorted_selectable_feature_amount_per_level",
                    "name": "Sorted selectable feature amount per level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "sortBy",
                        "order": "asc",
                        "components": {
                            "type": "stat",
                            "stat": "selectable_feature_amount_per_level"
                        },
                        "sort_by_selector": {
                            "type": "stat",
                            "stat": "$sortByValue.level"
                        }
                    }
                },
                {
                    "id": "current_levelled_amount_of_allowed_selectable_features",
                    "name": "Current levelled amount of allowed selectable features",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "selectable_feature_amount_per_level"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "current_allowed_amount_of_selectable_features",
                    "name": "Current allowed amount of selectable features",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "current_levelled_amount_of_allowed_selectable_features?.amount"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": 0,
                            "value_type": "integer"
                        }
                    }
                },
                {
                    "id": "can_choose_new_selectable_features_in_current_level",
                    "name": "Can choose new selectable features in the current level",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "equals",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "current_levelled_amount_of_allowed_selectable_features?.level"
                                },
                                {
                                    "type": "stat",
                                    "stat": "level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "sorted_selectable_features",
                    "name": "Sorted selectable features",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "sortBy",
                        "order": "asc",
                        "components": {
                            "type": "stat",
                            "stat": "selectable_features"
                        },
                        "sort_by_selector": {
                            "type": "stat",
                            "stat": "$sortByValue.min_level"
                        }
                    }
                },
                {
                    "id": "available_selectable_features_for_current_level",
                    "name": "Available selectable features for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "sorted_selectable_features"
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.min_level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "current_allowed_amount_of_selectable_features_label_text",
                    "name": "Current allowed amount of selectable features label text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Allowed selectable feature amount (for your level): ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "current_allowed_amount_of_selectable_features"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "is_selectable_feature",
                    "name": "Is selectable feature",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defined",
                        "stat": "$parent.selectable_features"
                    }
                },
                {
                    "id": "selected_selectable_feature_ids_stat_path",
                    "name": "Chosen selectable feature ids stat path",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.current_class_details?.selected_selectable_feature_ids?"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "$parent.current_class_details.selected_selectable_feature_ids",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "$character.selected_selectable_feature_ids",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_level_available_selectable_feature_ids",
                    "name": "Current level available selectable feature ids",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "map",
                        "components": {
                            "type": "stat",
                            "stat": "available_selectable_features_for_current_level"
                        },
                        "mapper": {
                            "type": "stat",
                            "stat": "$mapValue.id"
                        }
                    }
                },
                {
                    "id": "chosen_selectable_features",
                    "name": "Chosen selectable features",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "selected_selectable_feature_ids"
                        },
                        "filter": {
                            "type": "contains",
                            "haystack": {
                                "type": "stat",
                                "stat": "current_level_available_selectable_feature_ids"
                            },
                            "needle": {
                                "type": "stat",
                                "stat": "$filterValue"
                            }
                        }
                    }
                },
                {
                    "id": "is_selected_selectable_feature",
                    "name": "Is selected selectable feature",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "contains",
                        "haystack": {
                            "type": "stat",
                            "stat": "selected_selectable_feature_ids"
                        },
                        "needle": {
                            "type": "stat",
                            "stat": "id"
                        }
                    }
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent?.should_load_effects?"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_selectable_feature"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "is_selected_selectable_feature"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "type_name",
                    "name": "Type name",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "enumeratedName",
                        "enumerated_type": "feat_types",
                        "id": {
                            "type": "stat",
                            "stat": "type"
                        }
                    }
                },
                {
                    "id": "list_name",
                    "name": "List view name",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "show_level_in_name"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "level_plus_name"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "name"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "level_plus_name",
                    "name": "First level plus name",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "Lvl. ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "min_level"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "name"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "show_level_in_name",
                    "name": "Show level in feat name",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$parent?.feat_show_level?"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": false,
                            "value_type": "bool"
                        }
                    }
                },
                {
                    "id": "is_feat",
                    "name": "Is feat",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                }
            ],
            "mechanics": [
                {
                    "id": "save_selectable_features_choice",
                    "event_names": "saveSelectableFeaturesChoice",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "setStat",
                                "meta_stat": {
                                    "type": "stat",
                                    "stat": "selected_selectable_feature_ids_stat_path"
                                },
                                "new_value": {
                                    "type": "flatAppend",
                                    "treat_as_set": true,
                                    "components": [
                                        {
                                            "type": "filter",
                                            "components": {
                                                "type": "metaStat",
                                                "meta_stat": {
                                                    "type": "stat",
                                                    "stat": "selected_selectable_feature_ids_stat_path"
                                                }
                                            },
                                            "filter": {
                                                "type": "not",
                                                "components": {
                                                    "type": "contains",
                                                    "haystack": {
                                                        "type": "stat",
                                                        "stat": "selectable_feature_ids"
                                                    },
                                                    "needle": {
                                                        "type": "stat",
                                                        "stat": "$filterValue"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "type": "stat",
                                            "stat": "$view.feat_display_selectable_features_select"
                                        }
                                    ]
                                },
                                "aggregation_type": "set"
                            },
                            {
                                "type": "delayed",
                                "millis": 100,
                                "effect": {
                                    "type": "dismissResource"
                                }
                            }
                        ]
                    }
                }
            ],
            "indexed_stats": [
                "name",
                "list_view_description",
                "source",
                "type",
                "type_name"
            ],
            "search_filters": [
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                },
                {
                    "name": "Type",
                    "stat": "type",
                    "options": "feat_types"
                }
            ],
            "sort_options": [
                {
                    "name": "alphabetically",
                    "stat": "name"
                },
                {
                    "name": "by type",
                    "stat": "type",
                    "options": "feat_types"
                },
                {
                    "name": "by source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "edit_view": {
                "id": "feat_edit",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "feat_edit_name",
                        "type": "text",
                        "edit_stat": "name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.feat_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your feat",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "feat_edit_source",
                        "margin_top": 4,
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "feat_edit_source_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Source: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "feat_edit_source_select",
                                "type": "select",
                                "options": "source",
                                "options_display_stat": "abbreviation",
                                "stat": "source"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defined",
                                "stat": "$parent"
                            }
                        }
                    },
                    {
                        "id": "feat_edit_type",
                        "margin_top": 4,
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "feat_edit_type_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Type: ",
                                    "value_type": "string"
                                },
                                "style": "text"
                            },
                            {
                                "id": "feat_edit_type_select",
                                "type": "select",
                                "options": "feat_types",
                                "stat": "type"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defined",
                                "stat": "$parent"
                            }
                        }
                    },
                    {
                        "id": "feat_edit_prerequisites",
                        "type": "text",
                        "edit_stat": "prerequisites",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Prerequisites",
                            "value_type": "string"
                        },
                        "max_length": 140
                    },
                    {
                        "id": "feat_edit_levelled_descriptions",
                        "type": "resourceArray",
                        "resource_id": "levelled_description",
                        "stat": "descriptions",
                        "view_type": "edit",
                        "left_view": {
                            "id": "feat_edit_descriptions_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Descriptions (per lvl): ",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    },
                    {
                        "id": "feat_edit_effects",
                        "type": "resourceArray",
                        "resource_id": "levelled_effect",
                        "view_type": "edit",
                        "stat": "effects",
                        "left_view": {
                            "id": "feat_edit_effects_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Effects (per lvl): ",
                                "value_type": "string"
                            },
                            "style": "text"
                        }
                    },
                    {
                        "id": "feat_edit_has_selectable_features",
                        "type": "checkbox",
                        "stat": "has_selectable_features",
                        "label": {
                            "type": "constant",
                            "value": "Has selectable features",
                            "value_type": "string"
                        },
                        "label_alignment": "right",
                        "style": "checkbox",
                        "is_visible": {
                            "type": "stat",
                            "stat": "can_have_selectable_features"
                        }
                    },
                    {
                        "id": "feat_edit_selectable_features",
                        "type": "resourceArray",
                        "resource_id": "feat",
                        "stat": "selectable_features",
                        "view_type": "edit",
                        "left_view": {
                            "id": "feat_edit_selectable_features_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Selectable features: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "levelled_description"
                        },
                        "is_visible": {
                            "type": "stat",
                            "stat": "$view.feat_edit_has_selectable_features"
                        }
                    },
                    {
                        "id": "feat_edit_selectable_feature_amount_per_level",
                        "type": "resourceArray",
                        "resource_id": "levelled_amount",
                        "stat": "selectable_feature_amount_per_level",
                        "view_type": "edit",
                        "left_view": {
                            "id": "feat_edit_selectable_features_amount_per_level_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Amount of selectable features per lvl: ",
                                "value_type": "string"
                            },
                            "style": "text"
                        },
                        "is_visible": {
                            "type": "stat",
                            "stat": "$view.feat_edit_has_selectable_features"
                        }
                    }
                ]
            },
            "search_item_view": {
                "id": "feat_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "list_view_description"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "type_name"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "list_view": {
                "id": "feat_list",
                "type": "list",
                "subviews": [
                    {
                        "id": "feat_list_data",
                        "type": "listItem",
                        "title": {
                            "type": "stat",
                            "stat": "list_name"
                        },
                        "subtitle": {
                            "type": "stat",
                            "stat": "list_view_description"
                        },
                        "first_line_extra": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "defined",
                                        "stat": "$parent.classes"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "type_name"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "",
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "feat_list_effects",
                        "type": "resourceArray",
                        "resource_id": "effect",
                        "stat": "active_or_charge_effects_for_current_level",
                        "view_type": "display",
                        "margin_left": 16,
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "defined",
                                        "stat": "$character"
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "defined",
                                            "stat": "$character.$is_new"
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "stat",
                                            "stat": "is_selectable_feature"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                ]
            },
            "display_view": {
                "id": "feat_display",
                "type": "list",
                "padding": 16,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "feat_display_non_level_up",
                        "type": "list",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "defaultIfNull",
                                "components": {
                                    "type": "stat",
                                    "stat": "$character?.currently_levelling_up"
                                },
                                "default_components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "feat_display_info",
                                "type": "composite",
                                "margin_left": 16,
                                "subviews": [
                                    {
                                        "id": "feat_display_source",
                                        "type": "text",
                                        "style": "caption",
                                        "resource_id": "source",
                                        "resource_instance_ids_stat": "source",
                                        "resource_display_stat": "abbreviation",
                                        "is_visible": {
                                            "type": "not",
                                            "components": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "source"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "id": "feat_display_source_separator",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": ", ",
                                            "value_type": "string"
                                        },
                                        "style": "caption",
                                        "is_visible": {
                                            "type": "not",
                                            "components": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "source"
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "id": "feat_display_type",
                                        "type": "text",
                                        "style": "caption",
                                        "text": {
                                            "type": "stat",
                                            "stat": "type_name"
                                        }
                                    },
                                    {
                                        "id": "feat_display_type_separator",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": ", ",
                                            "value_type": "string"
                                        },
                                        "style": "caption"
                                    },
                                    {
                                        "id": "feat_display_prerequisites",
                                        "type": "text",
                                        "text": {
                                            "type": "concat",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "Prerequisites: ",
                                                        "value_type": "string"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "prerequisites"
                                                    }
                                                ]
                                            }
                                        },
                                        "style": "caption",
                                        "is_visible": {
                                            "type": "not",
                                            "components": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "prerequisites"
                                                }
                                            }
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "feat_display_current_level_description",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "current_level_description"
                                },
                                "style": "text"
                            },
                            {
                                "id": "feat_display_all_descriptions_collapsible",
                                "type": "collapsible",
                                "margin_top": 8,
                                "title": {
                                    "type": "constant",
                                    "value": "All descriptions (by level)",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "or",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "not",
                                                            "components": {
                                                                "type": "defined",
                                                                "stat": "$character"
                                                            }
                                                        },
                                                        {
                                                            "type": "defined",
                                                            "stat": "$character.$is_new"
                                                        }
                                                    ]
                                                }
                                            },
                                            {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "length",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "sorted_descriptions"
                                                            }
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 1,
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "feat_display_descriptions",
                                        "type": "resourceArray",
                                        "resource_id": "levelled_description",
                                        "stat": "sorted_descriptions",
                                        "view_type": "display"
                                    }
                                ]
                            },
                            {
                                "id": "feat_display_available_effects_collapsible",
                                "type": "collapsible",
                                "margin_top": 8,
                                "title": {
                                    "type": "constant",
                                    "value": "Magic effects",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "available_effects_for_current_level"
                                                    }
                                                }
                                            },
                                            {
                                                "type": "defined",
                                                "stat": "$character"
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defined",
                                                    "stat": "$character.$is_new"
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "feat_display_effects",
                                        "type": "resourceArray",
                                        "resource_id": "effect",
                                        "stat": "available_effects_for_current_level",
                                        "view_type": "display"
                                    }
                                ]
                            },
                            {
                                "id": "feat_display_effects_collapsible",
                                "type": "collapsible",
                                "margin_top": 8,
                                "title": {
                                    "type": "constant",
                                    "value": "Magic effects",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "sorted_effects"
                                                    }
                                                }
                                            },
                                            {
                                                "type": "or",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "not",
                                                            "components": {
                                                                "type": "defined",
                                                                "stat": "$character"
                                                            }
                                                        },
                                                        {
                                                            "type": "defined",
                                                            "stat": "$character.$is_new"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "feat_display_effects",
                                        "type": "resourceArray",
                                        "resource_id": "effect",
                                        "stat": "sorted_effects",
                                        "view_type": "display"
                                    }
                                ]
                            },
                            {
                                "id": "feat_display_selectable_features_collapsible",
                                "type": "collapsible",
                                "margin_top": 8,
                                "title": {
                                    "type": "constant",
                                    "value": "All selectable features (by level)",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "has_selectable_features"
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "sorted_selectable_features"
                                                    }
                                                }
                                            },
                                            {
                                                "type": "or",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "not",
                                                            "components": {
                                                                "type": "defined",
                                                                "stat": "$character"
                                                            }
                                                        },
                                                        {
                                                            "type": "defined",
                                                            "stat": "$character.$is_new"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "feat_display_selectable_feature_amount_per_level",
                                        "type": "resourceArray",
                                        "resource_id": "levelled_amount",
                                        "stat": "sorted_selectable_feature_amount_per_level",
                                        "view_type": "display"
                                    },
                                    {
                                        "id": "feat_display_selectable_features",
                                        "type": "resourceArray",
                                        "resource_id": "feat",
                                        "stat": "sorted_selectable_features",
                                        "view_type": "list"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "feat_display_level_up_selectable_feature",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Your level up allowed you to select some additional features:",
                            "value_type": "string"
                        },
                        "style": "text",
                        "is_visible": {
                            "type": "defaultIfNull",
                            "components": {
                                "type": "stat",
                                "stat": "$character?.currently_levelling_up"
                            },
                            "default_components": {
                                "type": "constant",
                                "value": false,
                                "value_type": "bool"
                            }
                        }
                    },
                    {
                        "id": "feat_display_selectable_features_select_collapsible",
                        "type": "collapsible",
                        "margin_top": 8,
                        "title": {
                            "type": "constant",
                            "value": "Chosen selectable features",
                            "value_type": "string"
                        },
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "has_selectable_features"
                                    },
                                    {
                                        "type": "greaterThan",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "current_allowed_amount_of_selectable_features"
                                                },
                                                {
                                                    "type": "constant",
                                                    "value": 0,
                                                    "value_type": "integer"
                                                }
                                            ]
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "available_selectable_features_for_current_level"
                                            }
                                        }
                                    },
                                    {
                                        "type": "defined",
                                        "stat": "$character"
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "defined",
                                            "stat": "$character.$is_new"
                                        }
                                    }
                                ]
                            }
                        },
                        "subviews": [
                            {
                                "id": "feat_display_allowed_amount_of_selectable_features",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "current_allowed_amount_of_selectable_features_label_text"
                                },
                                "style": "text"
                            },
                            {
                                "id": "feat_display_selectable_features_select",
                                "type": "select",
                                "stat": "chosen_selectable_features",
                                "resource_options": {
                                    "type": "stat",
                                    "stat": "available_selectable_features_for_current_level"
                                },
                                "max_selection_amount": {
                                    "type": "stat",
                                    "stat": "current_allowed_amount_of_selectable_features"
                                },
                                "options_display_stat": "name",
                                "multi_select": true,
                                "style": "list"
                            },
                            {
                                "id": "feat_display_selectable_features_save_button",
                                "type": "button",
                                "text": {
                                    "type": "constant",
                                    "value": "SAVE",
                                    "value_type": "string"
                                },
                                "event": {
                                    "name": "saveSelectableFeaturesChoice",
                                    "payload": {}
                                }
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "race",
            "name": "Species",
            "plural": "Species",
            "core": true,
            "color": "#F4511E",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "base_ac",
                    "name": "Base AC",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "ac_modifiers",
                    "name": "AC Modifiers",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": ["dexterity"]
                },
                {
                    "id": "actual_base_ac",
                    "name": "Actual base AC",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_subrace"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_subrace?.same_ac_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_subrace.base_ac"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "base_ac"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_ac_modifiers",
                    "name": "Actual AC modifiers",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_subrace"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_subrace?.same_ac_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_subrace.ac_modifiers"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "ac_modifiers"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "same_ac_as_parent",
                    "name": "Same AC as parent",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "speed",
                    "name": "Speed",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 30
                },
                {
                    "id": "burrow_speed",
                    "name": "Burrow",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "climb_speed",
                    "name": "Climb",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "fly_speed",
                    "name": "Fly",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "swim_speed",
                    "name": "Swim",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "traits",
                    "name": "Trait",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "default_value": []
                },
                {
                    "id": "unarmed_strike",
                    "name": "unarmed_strike",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon",
                    "default_value": []
                },
                {
                    "id": "same_spellcasting_ability_as_parent",
                    "name": "Same spellcasting ability as parent",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "spellcasting_ability",
                    "name": "Spellcasting ability",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "intelligence"
                },
                {
                    "id": "spells",
                    "name": "Spells",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "spell",
                    "default_value": []
                },
                {
                    "id": "language_proficiencies",
                    "name": "Language proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "default_value": []
                },
                {
                    "id": "skill_proficiencies",
                    "name": "Skill proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "default_value": []
                },
                {
                    "id": "armor_proficiencies",
                    "name": "Armor proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "default_value": []
                },
                {
                    "id": "weapon_proficiencies",
                    "name": "Weapon proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "default_value": []
                },
                {
                    "id": "tool_proficiencies",
                    "name": "Tool proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "default_value": []
                },
                {
                    "id": "visual_traits",
                    "name": "Visual traits",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "visual_trait",
                    "default_value": []
                },
                {
                    "id": "actual_visual_traits",
                    "name": "Actual visual_traits",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "visual_trait",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "selected_subrace?.visual_traits"
                        },
                        "default_components": {
                            "type": "stat",
                            "stat": "visual_traits"
                        }
                    }
                },
                {
                    "id": "hair_color_selectable",
                    "name": "Hair color selectable",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "actual_hair_color_selectable",
                    "name": "Actual hair_color_selectable",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "selected_subrace?.hair_color_selectable"
                        },
                        "default_components": {
                            "type": "stat",
                            "stat": "hair_color_selectable"
                        }
                    }
                },
                {
                    "id": "eye_color_selectable",
                    "name": "Eye color selectable",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "actual_eye_color_selectable",
                    "name": "Actual eye_color_selectable",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "selected_subrace?.eye_color_selectable"
                        },
                        "default_components": {
                            "type": "stat",
                            "stat": "eye_color_selectable"
                        }
                    }
                },
                {
                    "id": "outfit_selectable",
                    "name": "Outfit selectable",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "actual_outfit_selectable",
                    "name": "Actual outfit_selectable",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "selected_subrace?.outfit_selectable"
                        },
                        "default_components": {
                            "type": "stat",
                            "stat": "outfit_selectable"
                        }
                    }
                },
                {
                    "id": "weapon_selectable",
                    "name": "Weapon selectable",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "actual_appearance_weapon_selectable",
                    "name": "Actual weapon_selectable",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "selected_subrace?.weapon_selectable"
                        },
                        "default_components": {
                            "type": "stat",
                            "stat": "weapon_selectable"
                        }
                    }
                },
                {
                    "id": "sex_selectable",
                    "name": "Sex selectable",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "actual_sex_selectable",
                    "name": "Actual sex_selectable",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "selected_subrace?.sex_selectable"
                        },
                        "default_components": {
                            "type": "stat",
                            "stat": "sex_selectable"
                        }
                    }
                },
                {
                    "id": "subraces",
                    "name": "Ancestries",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "race",
                    "default_value": []
                },
                {
                    "id": "is_subrace",
                    "name": "Is subrace",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defined",
                        "stat": "$parent.subraces"
                    }
                },
                {
                    "id": "subrace_names",
                    "name": "Subrace names",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "map",
                            "components": {
                                "type": "stat",
                                "stat": "subraces"
                            },
                            "mapper": {
                                "type": "stat",
                                "stat": "$mapValue.name"
                            }
                        }
                    }
                },
                {
                    "id": "selected_subrace",
                    "name": "Selected subrace",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "race",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "findFirst",
                                    "components": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "stat",
                                                    "stat": "is_subrace"
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$parent.subraces"
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "subraces"
                                                }
                                            }
                                        ]
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$findFirstValue.id"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$character.subrace_id"
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": null,
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_subrace"
                                    }
                                },
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$character?.subrace_id"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "id"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "current_speed",
                    "name": "Current speed",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_subrace"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_subrace.speed"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "speed"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_burrow_speed",
                    "name": "Current burrow speed",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_subrace"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_subrace.burrow_speed"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "burrow_speed"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_climb_speed",
                    "name": "Current climb speed",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_subrace"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_subrace.climb_speed"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "climb_speed"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_fly_speed",
                    "name": "Current fly speed",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_subrace"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_subrace.fly_speed"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "fly_speed"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_swim_speed",
                    "name": "Current swim speed",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_subrace"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_subrace.swim_speed"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "swim_speed"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_level_weapon",
                    "name": "Current level weapon",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "levelled_weapon",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "unarmed_strike"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "$character.level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "selected_subrace_has_weapon",
                    "name": "Selected subrace has weapon",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_subrace"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_subrace.current_level_weapon"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "weapons",
                    "name": "Weapons",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "weapon",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "selected_subrace_has_weapon"
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "selected_subrace.current_level_weapon.weapon"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "notEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "current_level_weapon"
                                            },
                                            {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "current_level_weapon.weapon"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "list",
                                    "components": []
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "language_proficiencies_for_current_level",
                    "name": "Language proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.language_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "skill_proficiencies_for_current_level",
                    "name": "Skill proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "skill_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.skill_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "armor_proficiencies_for_current_level",
                    "name": "Armor proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.armor_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "weapon_proficiencies_for_current_level",
                    "name": "Weapon proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.weapon_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "tool_proficiencies_for_current_level",
                    "name": "Tool proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.tool_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "language_proficiencies_choices_in_current_level",
                    "name": "Language proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                },
                                "filter": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.language_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "skill_proficiencies_choices_in_current_level",
                    "name": "Skill proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "skill_proficiencies"
                                },
                                "filter": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.skill_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "armor_proficiencies_choices_in_current_level",
                    "name": "Armor proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                },
                                "filter": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.armor_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "weapon_proficiencies_choices_in_current_level",
                    "name": "Weapon proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                },
                                "filter": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.weapon_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "tool_proficiencies_choices_in_current_level",
                    "name": "Tool proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                },
                                "filter": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$character.level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_subrace?.tool_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "all_traits",
                    "name": "All traits",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "flatMap",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "traits"
                                },
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_subrace?.traits"
                                    },
                                    "default_components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        "mapper": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "$mapValue.has_selectable_features"
                                            },
                                            "components": {
                                                "type": "filter",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue.selectable_features"
                                                },
                                                "filter": {
                                                    "type": "contains",
                                                    "haystack": {
                                                        "type": "stat",
                                                        "stat": "selected_selectable_feature_ids"
                                                    },
                                                    "needle": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.id"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected_selectable_feature_ids",
                    "name": "Selected selectable feature ids",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$character?.selected_selectable_feature_ids"
                        },
                        "default_components": {
                            "type": "list",
                            "components": []
                        }
                    }
                },
                {
                    "id": "current_level_traits",
                    "name": "Current level traits",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "all_traits"
                                    },
                                    "filter": {
                                        "type": "lessThanEquals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.min_level"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$character.level"
                                                }
                                            ]
                                        }
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "list",
                                    "components": []
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "traits_with_updates_in_current_level",
                    "name": "Traits with updates in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "all_traits"
                        },
                        "filter_value_key": "$feat",
                        "filter": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$feat.descriptions"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$character.level"
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "id": "display_armor_class",
                    "name": "Display armor class",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_subrace"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "same_ac_as_parent"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.display_armor_class"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "joinToString",
                                    "separator": " + ",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "base_ac"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "ac_modifiers"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }   
                },
                {
                    "id": "display_speeds",
                    "name": "Display speeds",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "concat",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "normal ",
                                                        "value_type": "string"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "speed"
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "burrow_speed"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "burrow ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "burrow_speed"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "climb_speed"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "climb ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "climb_speed"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "fly_speed"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "fly ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "fly_speed"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notEquals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "swim_speed"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "swim ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "swim_speed"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "lowest_level_unarmed_strike",
                    "name": "Lowest level unarmed strike",
                    "type": "calculated",
                    "value_type": "resource",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "asc",
                            "components": {
                                "type": "stat",
                                "stat": "unarmed_strike"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        }
                    }
                },
                {
                    "id": "display_unarmed_strike",
                    "name": "Display unarmed strike",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "unarmed_strike"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "None",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "lowest_level_unarmed_strike.weapon.name"
                                            },
                                            {
                                                "type": "constant",
                                                "value": ", ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "lowest_level_unarmed_strike.weapon.damage_dice_display_description"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " + ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "lowest_level_unarmed_strike.weapon.attack_ability"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                }
            ],
            "indexed_stats": [
                "name", "subrace_names",
                "source"
            ],
            "search_filters": [
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "sort_options": [
                {
                    "name": "alphabetically",
                    "stat": "name"
                },
                {
                    "name": "by source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "edit_view": {
                "id": "race_edit",
                "type": "viewPager",
                "names": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": "Basic information",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Weapon & Spells",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Proficiencies",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Visual traits",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Ancestries",
                            "value_type": "string"
                        }
                    ]
                },
                "color": {
                    "type": "constant",
                    "value": "#A33715",
                    "value_type": "string"
                },
                "subviews": [
                    {
                        "id": "race_edit_basics",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "race_edit_name",
                                "type": "text",
                                "edit_stat": "name",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Name",
                                    "value_type": "string"
                                },
                                "max_length": 140,
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view.race_edit_name"
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "Please add a name to your race",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "race_edit_source",
                                "margin_top": 4,
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "race_edit_source_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Source: ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "race_edit_source_select",
                                        "type": "select",
                                        "options": "source",
                                        "options_display_stat": "abbreviation",
                                        "stat": "source"
                                    }
                                ]
                            },
                            {
                                "id": "race_edit_has_same_ac",
                                "type": "checkbox",
                                "stat": "same_ac_as_parent",
                                "label": {
                                    "type": "constant",
                                    "value": "Has same AC as race",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_subrace"
                                }
                            },
                            {
                                "id": "race_edit_armor_composite",
                                "type": "composite",
                                "margin_top": 4,
                                "is_visible": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_subrace"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view?.race_edit_has_same_ac"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": false,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "race_edit_base_ac",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Base AC: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "race_edit_base_ac",
                                        "type": "text",
                                        "edit_stat": "base_ac",
                                        "style": "text",
                                        "max_length": 2,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "race_edit_ac_modifiers",
                                        "type": "select",
                                        "stat": "ac_modifiers",
                                        "options": "ability",
                                        "multi_select": true,
                                        "margin_left": 4
                                    }
                                ]
                            },
                            {
                                "id": "race_edit_speed_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Speed:",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "race_edit_speed_composite",
                                "type": "composite",
                                "alignment": "center",
                                "subviews": [
                                    {
                                        "id": "race_edit_speed",
                                        "type": "text",
                                        "edit_stat": "speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Normal",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "race_edit_burrow_speed",
                                        "type": "text",
                                        "edit_stat": "burrow_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Burrow",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "race_edit_climb_speed",
                                        "type": "text",
                                        "edit_stat": "climb_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Climb",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "race_edit_fly_speed",
                                        "type": "text",
                                        "edit_stat": "fly_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Fly",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "race_edit_swim_speed",
                                        "type": "text",
                                        "edit_stat": "swim_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Swim",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "race_edit_traits",
                                "type": "resourceArray",
                                "resource_id": "feat",
                                "stat": "traits",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_traits_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Traits: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "levelled_description"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.race_edit_traits"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty traits. Please add some content to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "id": "race_edit_spells_weapons",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "race_edit_unarmed_strike",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon",
                                "stat": "unarmed_strike",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_unarmed_strike_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Unarmed strike (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.race_edit_unarmed_strike"
                                                        },
                                                        "filter": {
                                                            "type": "isNull",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.weapon"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty unarmed strikes. Please work on them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "race_edit_has_same_spellcasting_ability",
                                "type": "checkbox",
                                "stat": "same_spellcasting_ability_as_parent",
                                "label": {
                                    "type": "constant",
                                    "value": "Has same spellcasting ability as race",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_subrace"
                                }
                            },
                            {
                                "id": "race_edit_spellcasting_ability_composite",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "race_edit_spellcasting_ability_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Spellcasting Ability: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "race_edit_spellcasting_ability_select",
                                        "type": "select",
                                        "stat": "spellcasting_ability",
                                        "options": "ability"
                                    }
                                ],
                                "is_visible": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_subrace"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view?.race_edit_has_same_spellcasting_ability"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": false,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "id": "race_edit_spells",
                                "type": "resourceArray",
                                "resource_id": "levelled_spell",
                                "stat": "spells",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_spells_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Spells (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            }
                        ]
                    },
                    {
                        "id": "race_edit_proficiencies",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "race_edit_language_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "language_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_language_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Language proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "race_edit_skill_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_skill_proficiency",
                                "stat": "skill_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_skill_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Skill proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "description"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.race_edit_skill_proficiencies"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.options"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty levelled skill proficiencies. Please add some skills to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "race_edit_armor_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_armor_proficiency",
                                "stat": "armor_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_armor_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Armor proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "race_edit_weapon_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon_proficiency",
                                "stat": "weapon_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_weapon_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Weapon proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "description"
                                }
                            },
                            {
                                "id": "race_edit_tool_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "tool_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_tool_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Tool proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            }
                        ]
                    },
                    {
                        "id": "race_edit_visual_traits",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "race_edit_visual_traits_selectable_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Selectable visual traits:",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "race_edit_visual_traits_comp",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "race_edit_visual_traits_allow_hair_color_selection",
                                        "type": "checkbox",
                                        "stat": "hair_color_selectable",
                                        "label": {
                                            "type": "constant",
                                            "value": "Hair color",
                                            "value_type": "string"
                                        },
                                        "label_alignment": "right"
                                    },
                                    {
                                        "id": "race_edit_visual_traits_allow_eye_color_selection",
                                        "type": "checkbox",
                                        "stat": "eye_color_selectable",
                                        "label": {
                                            "type": "constant",
                                            "value": "Eye color",
                                            "value_type": "string"
                                        },
                                        "label_alignment": "right"
                                    },
                                    {
                                        "id": "race_edit_visual_traits_allow_outfit_selection",
                                        "type": "checkbox",
                                        "stat": "outfit_selectable",
                                        "label": {
                                            "type": "constant",
                                            "value": "Outfit",
                                            "value_type": "string"
                                        },
                                        "label_alignment": "right"
                                    },
                                    {
                                        "id": "race_edit_visual_traits_allow_weapon_selection",
                                        "type": "checkbox",
                                        "stat": "weapon_selectable",
                                        "label": {
                                            "type": "constant",
                                            "value": "Weapon",
                                            "value_type": "string"
                                        },
                                        "label_alignment": "right"
                                    },
                                    {
                                        "id": "race_edit_visual_traits_allow_sex_selection",
                                        "type": "checkbox",
                                        "stat": "sex_selectable",
                                        "label": {
                                            "type": "constant",
                                            "value": "Sex",
                                            "value_type": "string"
                                        },
                                        "label_alignment": "right"
                                    }
                                ]
                            },
                            {
                                "id": "race_edit_visual_traits_array",
                                "type": "resourceArray",
                                "resource_id": "visual_trait",
                                "stat": "visual_traits",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_visual_traits_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Extra visual traits: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "name"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.race_edit_visual_traits"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty visual traits. Please edit them or delete them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "id": "race_edit_subraces",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "race_edit_subraces",
                                "type": "resourceArray",
                                "resource_id": "race",
                                "stat": "subraces",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "race_edit_subraces_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Ancestries: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "window",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "name"
                                },
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_subrace"
                                    }
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.race_edit_subraces"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty ancestries. Please edit them or delete them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "race_edit_subraces_no_subraces_message",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Ancestries cannot have ancestries!",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true,
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_subrace"
                                }
                            }
                        ]
                    }
                ]
            },
            "search_item_view": {
                "id": "race_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "subrace_names"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "list_view": {
                "id": "race_list",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "subrace_names"
                }
            },
            "display_view": {
                "id": "race_display",
                "type": "list",
                "padding": 16,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "race_display_source",
                        "type": "text",
                        "style": "caption",
                        "margin_left": 16,
                        "resource_id": "source",
                        "resource_instance_ids_stat": "source",
                        "resource_display_stat": "abbreviation"
                    },
                    {
                        "id": "race_display_armor_class_composite",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "race_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Armor class: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "race_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_armor_class"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "race_display_speeds",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "race_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Speeds: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "race_display_speeds_text",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_speeds"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "race_display_traits_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Traits",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_traits",
                                "type": "resourceSection",
                                "resource_stat": "traits",
                                "resource_id": "feat",
                                "contentItemMinWidth": 1,
                                "read_only": true
                            }
                        ]
                    },
                    {
                        "id": "race_display_weapon",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "race_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Weapon: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "race_display_weapon_text",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_unarmed_strike"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "race_display_spells_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Spells (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_spells",
                                "type": "resourceSection",
                                "resource_stat": "spells",
                                "resource_id": "levelled_spell",
                                "contentItemMinWidth": 1,
                                "read_only": true
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "spells"
                                }
                            }
                        }
                    },
                    {
                        "id": "race_display_languages_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Languages (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_languages",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "language_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "race_display_skills_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Skill proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_skills",
                                "type": "resourceArray",
                                "resource_id": "levelled_skill_proficiency",
                                "stat": "skill_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "skill_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "race_display_armor_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Armor proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_armor_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_armor_proficiency",
                                "stat": "armor_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "race_display_weapon_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Weapon proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_weapon_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon_proficiency",
                                "stat": "weapon_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "race_display_tool_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Tool proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_tool_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "tool_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "race_display_subraces_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Ancestries",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "race_display_subraces",
                                "type": "resourceSection",
                                "resource_stat": "subraces",
                                "resource_id": "race",
                                "contentItemMinWidth": 1,
                                "read_only": true
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "subraces"
                                }
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "class",
            "name": "Class",
            "plural": "Classes",
            "core": true,
            "color": "#00897B",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "hit_die",
                    "name": "Hit die",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "d8"
                },
                {
                    "id": "hp_modifiers",
                    "name": "HP Modifiers",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": ["constitution"]
                },
                {
                    "id": "actual_hit_die",
                    "name": "Actual hit die",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_archetype?.same_hp_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.hit_die"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "hit_die"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_hp_modifiers",
                    "name": "Actual HP modifiers",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_archetype?.same_hp_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.hp_modifiers"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "hp_modifiers"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "same_hp_as_parent",
                    "name": "Same HP as parent",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "base_ac",
                    "name": "Base AC",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "ac_modifiers",
                    "name": "AC Modifiers",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": ["dexterity"]
                },
                {
                    "id": "actual_base_ac",
                    "name": "Actual base AC",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_archetype?.same_ac_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.base_ac"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "base_ac"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_ac_modifiers",
                    "name": "Actual AC modifiers",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_archetype?.same_ac_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.ac_modifiers"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "ac_modifiers"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "same_ac_as_parent",
                    "name": "Same AC as parent",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "strength_saving_throw_proficiency",
                    "name": "Strength saving throw proficiency",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "dexterity_saving_throw_proficiency",
                    "name": "Dexterity saving throw proficiency",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "constitution_saving_throw_proficiency",
                    "name": "Constitution saving throw proficiency",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "intelligence_saving_throw_proficiency",
                    "name": "Intelligence saving throw proficiency",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "wisdom_saving_throw_proficiency",
                    "name": "Wisdom saving throw proficiency",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "charisma_saving_throw_proficiency",
                    "name": "Charisma saving throw proficiency",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "features",
                    "name": "Features",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "default_value": []
                },
                {
                    "id": "same_spellcasting_ability_as_parent",
                    "name": "Same spellcasting ability as parent",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "spellcasting_ability",
                    "name": "Spellcasting ability",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "intelligence"
                },
                {
                    "id": "actual_spellcasting_ability",
                    "name": "Actual spellcasting ability",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_archetype?.same_spellcasting_ability_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spellcasting_ability"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spellcasting_ability"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "same_effective_caster_level_as_parent",
                    "name": "Same effective caster level as parent",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "effective_caster_level",
                    "name": "Effective caster level",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "zero"
                },
                {
                    "id": "actual_effective_caster_level",
                    "name": "Actual effective caster level",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "selected_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.effective_caster_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "effective_caster_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "spells",
                    "name": "Spells",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "spell",
                    "default_value": []
                },
                {
                    "id": "recharge_slots_on_short_rest",
                    "name": "Recharge slots on short rest",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": false
                },
                {
                    "id": "spell_slots_level_1_per_level",
                    "name": "Spell slots level 1 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_2_per_level",
                    "name": "Spell slots level 2 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_3_per_level",
                    "name": "Spell slots level 3 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_4_per_level",
                    "name": "Spell slots level 4 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_5_per_level",
                    "name": "Spell slots level 5 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_6_per_level",
                    "name": "Spell slots level 6 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_7_per_level",
                    "name": "Spell slots level 7 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_8_per_level",
                    "name": "Spell slots level 8 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "spell_slots_level_9_per_level",
                    "name": "Spell slots level 9 (per level)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "actual_recharge_slots_on_short_rest",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "recharge_slots_on_short_rest"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.recharge_slots_on_short_rest"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_1_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_1_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_1_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_2_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_2_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_2_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_3_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_3_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_3_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_4_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_4_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_4_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_5_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_5_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_5_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_6_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_6_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_6_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_7_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_7_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_7_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_8_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_8_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_8_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "actual_spell_slots_level_9_per_level",
                    "name": "Actual recharge slots on short rest",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.same_effective_caster_level_as_parent"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spell_slots_level_9_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype.spell_slots_level_9_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "weapon",
                    "name": "Weapon",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon",
                    "default_value": []
                },
                {
                    "id": "attacks_per_action_per_level",
                    "name": "Attacks per action (by lvl)",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "default_value": []
                },
                {
                    "id": "language_proficiencies",
                    "name": "Language proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "default_value": []
                },
                {
                    "id": "skill_proficiencies",
                    "name": "Skill proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "default_value": []
                },
                {
                    "id": "account_for_skill_proficiencies_on_multiclass",
                    "name": "Account for skill proficiencies on multiclass",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "armor_proficiencies",
                    "name": "Armor proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "default_value": []
                },
                {
                    "id": "account_for_armor_proficiencies_on_multiclass",
                    "name": "Account for armor proficiencies on multiclass",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "weapon_proficiencies",
                    "name": "Weapon proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "default_value": []
                },
                {
                    "id": "account_for_weapon_proficiencies_on_multiclass",
                    "name": "Account for weapon proficiencies on multiclass",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "tool_proficiencies",
                    "name": "Tool proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "default_value": []
                },
                {
                    "id": "account_for_tool_proficiencies_on_multiclass",
                    "name": "Account for tool proficiencies on multiclass",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "selectable_equipments",
                    "name": "Selectable equipment",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "selectable_items",
                    "default_value": []
                },
                {
                    "id": "selectable_armors",
                    "name": "Selectable armor",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "selectable_armors",
                    "default_value": []
                },
                {
                    "id": "selectable_weapons",
                    "name": "Selectable weapons",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "selectable_weapons",
                    "default_value": []
                },
                {
                    "id": "archetype_selection_level",
                    "name": "Archetype selection level",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 3
                },
                {
                    "id": "archetypes",
                    "name": "Archetypes",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "class",
                    "default_value": []
                },
                {
                    "id": "is_archetype",
                    "name": "Is archetype",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "defined",
                        "stat": "$parent.archetypes"
                    }
                },
                {
                    "id": "archetype_names",
                    "name": "Archetype names",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "map",
                            "components": {
                                "type": "stat",
                                "stat": "archetypes"
                            },
                            "mapper": {
                                "type": "stat",
                                "stat": "$mapValue.name"
                            }
                        }
                    }
                },
                {
                    "id": "current_class_details",
                    "name": "Current class details",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "class_details",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.current_class_details"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent?"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "selected_archetype",
                    "name": "Selected archetype",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "class",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "$parent.archetypes"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "stat",
                                        "stat": "archetypes"
                                    }
                                }
                            ]
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.id"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "current_class_details?.archetype_id?"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "current_level_weapon",
                    "name": "Current level weapon",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "levelled_weapon",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "weapon"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "selected_archetype_has_weapon",
                    "name": "Selected archetype has weapon",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "notNull",
                        "components": {
                            "type": "stat",
                            "stat": "selected_archetype?.current_level_weapon"
                        }
                    }
                },
                {
                    "id": "should_load_effects",
                    "name": "Should load effects",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    }
                                },
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "selected_archetype?.id"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "id"
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "weapons",
                    "name": "Weapons",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "weapon",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "selected_archetype_has_weapon"
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "selected_archetype.current_level_weapon.weapon"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "notNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "current_level_weapon"
                                    }
                                },
                                "components": {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "current_level_weapon.weapon"
                                        }
                                    ]
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "list",
                                    "components": []
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "should_ask_for_effective_caster_level",
                    "name": "Should ask for effective caster level",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    }
                                },
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view?.class_edit_has_same_effective_caster_level?"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": false,
                                            "value_type": "bool"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "should_fill_custom_spell_slots",
                    "name": "Should fill custom spell slots",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "and",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$view?.class_edit_effective_caster_level?"
                                            },
                                            {
                                                "type": "constant",
                                                "value": "custom",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "should_ask_for_effective_caster_level"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "attacks_per_action_text",
                    "name": "Attacks per action text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Override attacks per action (by lvl): ",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Attacks per action (by lvl): ",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "saving_throws_text",
                    "name": "Saving throws text",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Additional saving throws:",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Saving throws:",
                                    "value_type": "string"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "level",
                    "name": "Current class level",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "current_class_details?.class_level?"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": 1,
                            "value_type": "integer"
                        }
                    }
                },
                {
                    "id": "language_proficiencies_for_current_level",
                    "name": "Language proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.language_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "skill_proficiencies_for_current_level",
                    "name": "Skill proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "skill_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.skill_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "armor_proficiencies_for_current_level",
                    "name": "Armor proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.armor_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "weapon_proficiencies_for_current_level",
                    "name": "Weapon proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.weapon_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "tool_proficiencies_for_current_level",
                    "name": "Tool proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                },
                                "filter": {
                                    "type": "lessThanEquals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.tool_proficiencies_for_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "is_primary_class",
                    "name": "Is primary class",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "defined",
                                    "stat": "$character"
                                },
                                "components": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "findFirst",
                                                "components": {
                                                    "type": "map",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$character.classes"
                                                    },
                                                    "mapper": {
                                                        "type": "stat",
                                                        "stat": "$mapValue.class.id"
                                                    }
                                                },
                                                "filter": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                }
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "id"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "constant",
                                    "value": false,
                                    "value_type": "bool"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "language_proficiencies_choices_in_current_level",
                    "name": "Language proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "filter",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                },
                                "filter": {
                                    "type": "equals",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$filterValue.level"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "level"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.language_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "skill_proficiencies_choices_in_current_level",
                    "name": "Skill proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "or",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "is_primary_class"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "account_for_skill_proficiencies_on_multiclass"
                                                    }
                                                ]
                                            }
                                        },
                                        "components": {
                                            "type": "filter",
                                            "components": {
                                                "type": "stat",
                                                "stat": "skill_proficiencies"
                                            },
                                            "filter": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$filterValue.level"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "level"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.skill_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "armor_proficiencies_choices_in_current_level",
                    "name": "Armor proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "or",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "is_primary_class"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "account_for_armor_proficiencies_on_multiclass"
                                                    }
                                                ]
                                            }
                                        },
                                        "components": {
                                            "type": "filter",
                                            "components": {
                                                "type": "stat",
                                                "stat": "armor_proficiencies"
                                            },
                                            "filter": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$filterValue.level"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "level"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.armor_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "weapon_proficiencies_choices_in_current_level",
                    "name": "Weapon proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "or",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "is_primary_class"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "account_for_weapon_proficiencies_on_multiclass"
                                                    }
                                                ]
                                            }
                                        },
                                        "components": {
                                            "type": "filter",
                                            "components": {
                                                "type": "stat",
                                                "stat": "weapon_proficiencies"
                                            },
                                            "filter": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$filterValue.level"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "level"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.weapon_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "tool_proficiencies_choices_in_current_level",
                    "name": "Tool proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "flatAppend",
                        "components": [
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "or",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "is_primary_class"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "account_for_tool_proficiencies_on_multiclass"
                                                    }
                                                ]
                                            }
                                        },
                                        "components": {
                                            "type": "filter",
                                            "components": {
                                                "type": "stat",
                                                "stat": "tool_proficiencies"
                                            },
                                            "filter": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "$filterValue.level"
                                                        },
                                                        {
                                                            "type": "stat",
                                                            "stat": "level"
                                                        }
                                                    ]
                                                }
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            },
                            {
                                "type": "when",
                                "clauses": [
                                    {
                                        "condition": {
                                            "type": "not",
                                            "components": {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            }
                                        },
                                        "components": {
                                            "type": "defaultIfNull",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selected_archetype?.tool_proficiencies_choices_in_current_level"
                                            },
                                            "default_components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    },
                                    {
                                        "condition": {
                                            "type": "constant",
                                            "value": true,
                                            "value_type": "bool"
                                        },
                                        "components": {
                                            "type": "list",
                                            "components": []
                                        }
                                    }
                                ]
                            }
                        ]
                    }
                },
                {
                    "id": "actual_attacks_per_action_per_level",
                    "name": "Actual attacks per action per level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "defaultIfNull",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "selected_archetype?.attacks_per_action_per_level"
                                                        },
                                                        "default_components": {
                                                            "type": "list",
                                                            "components": []
                                                        }
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "selected_archetype?.attacks_per_action_per_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "attacks_per_action_per_level"
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "current_level_attacks_per_action",
                    "name": "Current level attacks per action resource",
                    "type": "calculated",
                    "value_type": "resource",
                    "resource_type": "levelled_amount",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "desc",
                            "components": {
                                "type": "stat",
                                "stat": "actual_attacks_per_action_per_level"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$findFirstValue.level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "attacks_per_action_number_for_current_level",
                    "name": "Attacks per action for current level",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "current_level_attacks_per_action?.amount"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": 1,
                            "value_type": "integer"
                        }
                    }
                },
                {
                    "id": "has_strength_saving_throw_proficiency",
                    "name": "Has strength saving throw proficiency",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.strength_saving_throw_proficiency"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "strength_saving_throw_proficiency"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "has_dexterity_saving_throw_proficiency",
                    "name": "Has dexterity saving throw proficiency",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.dexterity_saving_throw_proficiency"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "dexterity_saving_throw_proficiency"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "has_constitution_saving_throw_proficiency",
                    "name": "Has constitution saving throw proficiency",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.constitution_saving_throw_proficiency"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "constitution_saving_throw_proficiency"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "has_intelligence_saving_throw_proficiency",
                    "name": "Has intelligence saving throw proficiency",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.intelligence_saving_throw_proficiency"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "intelligence_saving_throw_proficiency"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "has_wisdom_saving_throw_proficiency",
                    "name": "Has wisdom saving throw proficiency",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.wisdom_saving_throw_proficiency"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "wisdom_saving_throw_proficiency"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "has_charisma_saving_throw_proficiency",
                    "name": "Has charisma saving throw proficiency",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.charisma_saving_throw_proficiency"
                                    },
                                    "default_components": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    }
                                },
                                {
                                    "type": "stat",
                                    "stat": "charisma_saving_throw_proficiency"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected_selectable_feature_ids",
                    "name": "Selected selectable feature ids",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "current_class_details?.selected_selectable_feature_ids?"
                        },
                        "default_components": {
                            "type": "list",
                            "components": []
                        }
                    }
                },
                {
                    "id": "all_features",
                    "name": "All features",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "flatMap",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "features"
                                },
                                {
                                    "type": "defaultIfNull",
                                    "components": {
                                        "type": "stat",
                                        "stat": "selected_archetype?.features"
                                    },
                                    "default_components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        "mapper": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "$mapValue.has_selectable_features"
                                            },
                                            "components": {
                                                "type": "filter",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue.selectable_features"
                                                },
                                                "filter": {
                                                    "type": "contains",
                                                    "haystack": {
                                                        "type": "stat",
                                                        "stat": "selected_selectable_feature_ids"
                                                    },
                                                    "needle": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.id"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "current_level_features",
                    "name": "Current level features",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "all_features"
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.min_level"
                                    },
                                    {
                                        "type": "stat",
                                        "stat": "level"
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "features_with_updates_in_current_level",
                    "name": "Features with updates in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "all_features"
                        },
                        "filter_value_key": "$feat",
                        "filter": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$feat.descriptions"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "level"
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "id": "display_hp",
                    "name": "Display hp",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "same_hp_as_parent"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.display_hp"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "joinToString",
                                    "separator": " + ",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "1",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "actual_hit_die"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "actual_hp_modifiers"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "display_armor_class",
                    "name": "Display armor class",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "same_ac_as_parent"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.display_armor_class"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "joinToString",
                                    "separator": " + ",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "base_ac"
                                                    }
                                                ]
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "ac_modifiers"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }   
                },
                {
                    "id": "display_saving_throws",
                    "name": "Display saving throws",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "strength_saving_throw_proficiency"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "strength",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "dexterity_saving_throw_proficiency"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "dexterity",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "constitution_saving_throw_proficiency"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "constitution",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "intelligence_saving_throw_proficiency"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "intelligence",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "wisdom_saving_throw_proficiency"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "wisdom",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "charisma_saving_throw_proficiency"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "charisma",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_spellcasting_ability",
                    "name": "Display spellcasting ability",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "same_spellcasting_ability_as_parent"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.display_spellcasting_ability"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "spellcasting_ability"
                                }
                            }
                        ]
                    }   
                },
                {
                    "id": "display_caster_level",
                    "name": "Display caster level",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "is_archetype"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "same_effective_caster_level_as_parent"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "$parent.display_caster_level"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "enumeratedName",
                                    "enumerated_type": "effective_caster_level_types",
                                    "id": {
                                        "type": "stat",
                                        "stat": "effective_caster_level"
                                    }
                                }
                            }
                        ]
                    }   
                },
                {
                    "id": "lowest_level_weapon",
                    "name": "Lowest level weapon",
                    "type": "calculated",
                    "value_type": "resource",
                    "components": {
                        "type": "findFirst",
                        "components": {
                            "type": "sortBy",
                            "order": "asc",
                            "components": {
                                "type": "stat",
                                "stat": "weapon"
                            },
                            "sort_by_selector": {
                                "type": "stat",
                                "stat": "$sortByValue.level"
                            }
                        },
                        "filter": {
                            "type": "constant",
                            "value": true,
                            "value_type": "bool"
                        }
                    }
                },
                {
                    "id": "display_weapon",
                    "name": "Display weapon",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "weapon"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "None",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "lowest_level_weapon.weapon.name"
                                            },
                                            {
                                                "type": "constant",
                                                "value": ", ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "lowest_level_weapon.weapon.damage_dice_display_description"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " + ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "lowest_level_weapon.weapon.attack_ability"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "feat_show_level",
                    "name": "Show feat level",
                    "type": "calculated",
                    "value_type": "bool",
                    "components": {
                        "type": "or",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "not",
                                    "components": {
                                        "type": "defined",
                                        "stat": "$character"
                                    }
                                },
                                {
                                    "type": "defined",
                                    "stat": "$character.$is_new"
                                }
                            ]
                        }
                    }
                }
            ],
            "indexed_stats": [
                "name", "archetype_names",
                "source"
            ],
            "search_filters": [
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "sort_options": [
                {
                    "name": "alphabetically",
                    "stat": "name"
                },
                {
                    "name": "by source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "edit_view": {
                "id": "class_edit",
                "type": "viewPager",
                "names": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": "Basic information",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Features",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Spellcasting",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Weapons & Equipment",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Proficiencies",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Archetypes",
                            "value_type": "string"
                        }
                    ]
                },
                "color": {
                    "type": "constant",
                    "value": "#016157",
                    "value_type": "string"
                },
                "subviews": [
                    {
                        "id": "class_edit_basics",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "class_edit_name",
                                "type": "text",
                                "edit_stat": "name",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Name",
                                    "value_type": "string"
                                },
                                "max_length": 140,
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view.class_edit_name"
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "Please add a name to your class",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "class_edit_source",
                                "margin_top": 4,
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "class_edit_source_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Source: ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "class_edit_source_select",
                                        "type": "select",
                                        "options": "source",
                                        "options_display_stat": "abbreviation",
                                        "stat": "source"
                                    }
                                ]
                            },
                            {
                                "id": "class_edit_has_same_hp",
                                "type": "checkbox",
                                "stat": "same_hp_as_parent",
                                "label": {
                                    "type": "constant",
                                    "value": "Has same HP as class",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                }
                            },
                            {
                                "id": "class_edit_hp_composite",
                                "type": "composite",
                                "margin_top": 4,
                                "is_visible": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view?.class_edit_has_same_hp"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": false,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "class_edit_hit_die_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Hit die: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "class_edit_hit_die",
                                        "type": "select",
                                        "stat": "hit_die",
                                        "options": "dice"
                                    },
                                    {
                                        "id": "class_edit_hp_plus_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": " + ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "class_edit_hp_modifiers",
                                        "type": "select",
                                        "stat": "hp_modifiers",
                                        "options": "ability",
                                        "multi_select": true
                                    }
                                ]
                            },
                            {
                                "id": "class_edit_has_same_ac",
                                "type": "checkbox",
                                "stat": "same_ac_as_parent",
                                "label": {
                                    "type": "constant",
                                    "value": "Has same AC as class",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                }
                            },
                            {
                                "id": "class_edit_armor_composite",
                                "type": "composite",
                                "margin_top": 4,
                                "is_visible": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view?.class_edit_has_same_ac"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": false,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "class_edit_base_ac",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Base AC: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "class_edit_base_ac",
                                        "type": "text",
                                        "edit_stat": "base_ac",
                                        "style": "text",
                                        "max_length": 2,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "class_edit_ac_plus_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": " + ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "class_edit_ac_modifiers",
                                        "type": "select",
                                        "stat": "ac_modifiers",
                                        "options": "ability",
                                        "multi_select": true
                                    }
                                ]
                            },
                            {
                                "id": "class_edit_saving_throw_proficiencies_label",
                                "margin_top": 4,
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "saving_throws_text"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "class_edit_saving_throws_composite",
                                "type": "composite",
                                "alignment": "center",
                                "subviews": [
                                    {
                                        "id": "class_edit_strength_saving_throw_proficiency_composite",
                                        "type": "list",
                                        "padding": 4,
                                        "alignment": "center",
                                        "subviews": [
                                            {
                                                "id": "class_edit_strength_saving_throw_proficiency",
                                                "type": "checkbox",
                                                "stat": "strength_saving_throw_proficiency"
                                            },
                                            {
                                                "id": "class_edit_strength_saving_throw_proficiency_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "STR",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        ]
                                    },
                                    {
                                        "id": "class_edit_dexterity_saving_throw_proficiency_composite",
                                        "type": "list",
                                        "padding": 4,
                                        "alignment": "center",
                                        "subviews": [
                                            {
                                                "id": "class_edit_dexterity_saving_throw_proficiency",
                                                "type": "checkbox",
                                                "stat": "dexterity_saving_throw_proficiency"
                                            },
                                            {
                                                "id": "class_edit_dexterity_saving_throw_proficiency_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "DEX",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        ]
                                    },
                                    {
                                        "id": "class_edit_constitution_saving_throw_proficiency_composite",
                                        "type": "list",
                                        "padding": 4,
                                        "alignment": "center",
                                        "subviews": [
                                            {
                                                "id": "class_edit_constitution_saving_throw_proficiency",
                                                "type": "checkbox",
                                                "stat": "constitution_saving_throw_proficiency"
                                            },
                                            {
                                                "id": "class_edit_constitution_saving_throw_proficiency_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "CON",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        ]
                                    },
                                    {
                                        "id": "class_edit_intelligence_saving_throw_proficiency_composite",
                                        "type": "list",
                                        "padding": 4,
                                        "alignment": "center",
                                        "subviews": [
                                            {
                                                "id": "class_edit_intelligence_saving_throw_proficiency",
                                                "type": "checkbox",
                                                "stat": "intelligence_saving_throw_proficiency"
                                            },
                                            {
                                                "id": "class_edit_intelligence_saving_throw_proficiency_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "INT",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        ]
                                    },
                                    {
                                        "id": "class_edit_wisdom_saving_throw_proficiency_composite",
                                        "type": "list",
                                        "padding": 4,
                                        "alignment": "center",
                                        "subviews": [
                                            {
                                                "id": "class_edit_wisdom_saving_throw_proficiency",
                                                "type": "checkbox",
                                                "stat": "wisdom_saving_throw_proficiency"
                                            },
                                            {
                                                "id": "class_edit_wisdom_saving_throw_proficiency_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "WIS",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        ]
                                    },
                                    {
                                        "id": "class_edit_charisma_saving_throw_proficiency_composite",
                                        "type": "list",
                                        "padding": 4,
                                        "alignment": "center",
                                        "subviews": [
                                            {
                                                "id": "class_edit_charisma_saving_throw_proficiency",
                                                "type": "checkbox",
                                                "stat": "charisma_saving_throw_proficiency"
                                            },
                                            {
                                                "id": "class_edit_charisma_saving_throw_proficiency_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "CHA",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "class_edit_features",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "class_edit_features",
                                "type": "resourceArray",
                                "resource_id": "feat",
                                "stat": "features",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_features_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Features: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "levelled_description"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.class_edit_features"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty features. Please add some content to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "id": "class_edit_spells",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "class_edit_has_same_spellcasting_ability",
                                "type": "checkbox",
                                "stat": "same_spellcasting_ability_as_parent",
                                "label": {
                                    "type": "constant",
                                    "value": "Has same spellcasting ability as class",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                }
                            },
                            {
                                "id": "class_edit_spellcasting_ability_composite",
                                "type": "composite",
                                "margin_bottom": 4,
                                "is_visible": {
                                    "type": "or",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "is_archetype"
                                                }
                                            },
                                            {
                                                "type": "not",
                                                "components": {
                                                    "type": "defaultIfNull",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view?.class_edit_has_same_spellcasting_ability"
                                                    },
                                                    "default_components": {
                                                        "type": "constant",
                                                        "value": false,
                                                        "value_type": "bool"
                                                    }
                                                }
                                            }
                                        ]
                                    }
                                },
                                "subviews": [
                                    {
                                        "id": "class_edit_spellcasting_ability_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Spellcasting Ability: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "class_edit_spellcasting_ability_select",
                                        "type": "select",
                                        "stat": "spellcasting_ability",
                                        "options": "ability"
                                    }
                                ]
                            },
                            {
                                "id": "class_edit_has_same_effective_caster_level",
                                "type": "checkbox",
                                "stat": "same_effective_caster_level_as_parent",
                                "label": {
                                    "type": "constant",
                                    "value": "Has same caster level as class",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                }
                            },
                            {
                                "id": "class_edit_effective_caster_level_composite",
                                "type": "composite",
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "should_ask_for_effective_caster_level"
                                },
                                "subviews": [
                                    {
                                        "id": "class_edit_effective_caster_level_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Effective caster level: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "class_edit_effective_caster_level",
                                        "type": "select",
                                        "stat": "effective_caster_level",
                                        "options": "effective_caster_level_types"
                                    }
                                ]
                            },
                            {
                                "id": "class_edit_spell_slots_per_level",
                                "type": "list",
                                "padding": 0,
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "should_fill_custom_spell_slots"
                                },
                                "subviews": [
                                    {
                                        "id": "class_edit_spell_recharge_slots_on_short_rest",
                                        "type": "checkbox",
                                        "stat": "recharge_slots_on_short_rest",
                                        "label": {
                                            "type": "constant",
                                            "value": "Recharge slots on short rest",
                                            "value_type": "string"
                                        },
                                        "label_alignment": "right"
                                    },
                                    {
                                        "id": "class_edit_spell_slots_per_level_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Spell slots:",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_1_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 1",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_1_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_1_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_1_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 1 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_2_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 2",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_2_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_2_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_2_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 2 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_3_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 3",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_3_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_3_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_3_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 3 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_4_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 4",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_4_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_4_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_4_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 4 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_5_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 5",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_5_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_5_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_5_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 5 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_6_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 6",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_6_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_6_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_6_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 6 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_7_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 7",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_7_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_7_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_7_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 7 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_8_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 8",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_8_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_8_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_8_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 8 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    },
                                    {
                                        "id": "class_edit_spell_slots_level_9_per_level_bottom_sheet_button",
                                        "type": "popUpButton",
                                        "text": {
                                            "type": "constant",
                                            "value": "Level 9",
                                            "value_type": "string"
                                        },
                                        "pop_up_view": {
                                            "id": "class_edit_spell_slots_level_9_per_level",
                                            "type": "resourceArray",
                                            "resource_id": "levelled_amount",
                                            "stat": "spell_slots_level_9_per_level",
                                            "view_type": "edit",
                                            "left_view": {
                                                "id": "class_edit_spell_slots_level_9_per_level_label",
                                                "type": "text",
                                                "text": {
                                                    "type": "constant",
                                                    "value": "Max. amount per level: ",
                                                    "value_type": "string"
                                                },
                                                "style": "text"
                                            }
                                        },
                                        "pop_up_title": {
                                            "type": "constant",
                                            "value": "Edit Level 9 Slots",
                                            "value_type": "string"
                                        },
                                        "display_cancel_button": true,
                                        "display_save_button": true
                                    }
                                ]
                            },
                            {
                                "id": "class_edit_spells",
                                "type": "resourceArray",
                                "resource_id": "levelled_spell",
                                "stat": "spells",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_spells_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Spells (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            }
                        ]
                    },
                    {
                        "id": "class_edit_weapons_and_equipment",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "class_edit_weapon",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon",
                                "stat": "weapon",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_weapon_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Class weapon (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "class_edit_attacks_per_action",
                                "type": "resourceArray",
                                "resource_id": "levelled_amount",
                                "stat": "attacks_per_action_per_level",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_attacks_per_action_label",
                                    "type": "text",
                                    "text": {
                                        "type": "stat",
                                        "stat": "attacks_per_action_text"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "class_edit_selectable_armors",
                                "type": "resourceArray",
                                "resource_id": "selectable_armors",
                                "stat": "selectable_armors",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_selectable_armors_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Armor choices: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "display_description"
                                },
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    }
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.class_edit_selectable_armors"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.options"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty armor options. Please select some armors or remove it.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "class_edit_selectable_weapons",
                                "type": "resourceArray",
                                "resource_id": "selectable_weapons",
                                "stat": "selectable_weapons",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_selectable_weapons_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Weapon choices: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "display_description"
                                },
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    }
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.class_edit_selectable_weapons"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.options"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty weapon options. Please select some weapons or remove it.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "class_edit_selectable_equipments",
                                "type": "resourceArray",
                                "resource_id": "selectable_items",
                                "stat": "selectable_equipments",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_selectable_equipments_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Equipment choices: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "display_description"
                                },
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    }
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.class_edit_selectable_equipments"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.options"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty equipment options. Please select some equipments or remove it.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "id": "class_edit_proficiencies",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "class_edit_language_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "language_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_language_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Language proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "class_edit_skill_proficiencies_multiclass_check",
                                "type": "checkbox",
                                "stat": "account_for_skill_proficiencies_on_multiclass",
                                "label": {
                                    "type": "constant",
                                    "value": "Grant skill proficiencies on multiclass",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "class_edit_skill_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_skill_proficiency",
                                "stat": "skill_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_skill_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Skill proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "description"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.class_edit_skill_proficiencies"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.options"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty levelled skill proficiencies. Please add some skills to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "class_edit_armor_proficiencies_multiclass_check",
                                "type": "checkbox",
                                "stat": "account_for_armor_proficiencies_on_multiclass",
                                "label": {
                                    "type": "constant",
                                    "value": "Grant armor proficiencies on multiclass",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "class_edit_armor_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_armor_proficiency",
                                "stat": "armor_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_armor_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Armor proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "class_edit_weapon_proficiencies_multiclass_check",
                                "type": "checkbox",
                                "stat": "account_for_weapon_proficiencies_on_multiclass",
                                "label": {
                                    "type": "constant",
                                    "value": "Grant weapon proficiencies on multiclass",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "class_edit_weapon_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon_proficiency",
                                "stat": "weapon_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_weapon_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Weapon proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "class_edit_tool_proficiencies_multiclass_check",
                                "type": "checkbox",
                                "stat": "account_for_tool_proficiencies_on_multiclass",
                                "label": {
                                    "type": "constant",
                                    "value": "Grant tool proficiencies on multiclass",
                                    "value_type": "string"
                                },
                                "label_alignment": "right"
                            },
                            {
                                "id": "class_edit_tool_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "tool_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_tool_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Tool proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            }
                        ]
                    },
                    {
                        "id": "class_edit_archetypes_list",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "class_edit_archetype_selection_level_composite",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "class_edit_archetype_selection_level_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Archetype selection level: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "class_edit_archetype_selection_level",
                                        "type": "text",
                                        "edit_stat": "archetype_selection_level",
                                        "style": "text",
                                        "max_length": 2,
                                        "hint": {
                                            "type": "constant",
                                            "value": "3",
                                            "value_type": "string"
                                        }
                                    }
                                ],
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    }
                                }
                            },
                            {
                                "id": "class_edit_archetypes",
                                "type": "resourceArray",
                                "resource_id": "class",
                                "stat": "archetypes",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "class_edit_archetypes_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Archetypes: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "window",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "name"
                                },
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "is_archetype"
                                    }
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.class_edit_archetypes"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty archetypes. Please edit them or delete them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "class_edit_archetypes_no_archetypes_message",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Archetypes cannot have archetypes!",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true,
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "is_archetype"
                                }
                            }
                        ]
                    }
                ]
            },
            "search_item_view": {
                "id": "class_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "archetype_names"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "list_view": {
                "id": "class_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "archetype_names"
                }
            },
            "display_view": {
                "id": "class_display",
                "type": "list",
                "padding": 16,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "class_display_source",
                        "type": "text",
                        "style": "caption",
                        "margin_left": 16,
                        "resource_id": "source",
                        "resource_instance_ids_stat": "source",
                        "resource_display_stat": "abbreviation"
                    },
                    {
                        "id": "class_display_hit_die_composite",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "class_display_hit_die_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "HP: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "class_display_hit_die_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_hp"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "class_display_armor_class_composite",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "class_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Armor class: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "class_display_armor_class_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_armor_class"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "class_display_saving_throws",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "class_display_saving_throws_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Saving throws: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "class_display_saving_throws_text",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_saving_throws"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "class_display_features_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Features",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_features",
                                "type": "resourceSection",
                                "resource_stat": "features",
                                "resource_id": "feat",
                                "contentItemMinWidth": 1,
                                "read_only": true
                            }
                        ]
                    },
                    {
                        "id": "class_display_spellcasting_ability_composite",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "class_display_spellcasting_ability_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Spellcasting ability: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "class_display_spellcasting_ability_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_spellcasting_ability"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "class_display_caster_level_composite",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "class_display_caster_level_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Caster level: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "class_display_caster_level_label",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_caster_level"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "class_display_spells_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Spells (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_spells",
                                "type": "resourceSection",
                                "resource_stat": "spells",
                                "resource_id": "levelled_spell",
                                "contentItemMinWidth": 1,
                                "read_only": true
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "spells"
                                }
                            }
                        }
                    },
                    {
                        "id": "class_display_weapon",
                        "type": "composite",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "class_display_weapon_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Weapon: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "class_display_weapon_text",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_weapon"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "class_display_attacks_per_action_per_level",
                        "type": "resourceArray",
                        "resource_id": "levelled_amount",
                        "stat": "attacks_per_action_per_level",
                        "view_type": "display",
                        "left_view": {
                            "id": "class_display_armor_class_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Attacks per action (per level): ",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "attacks_per_action_per_level"
                                }
                            }
                        }
                    },
                    {
                        "id": "class_display_equipment_choices_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Starting equipment choices",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_selectable_armors",
                                "type": "resourceArray",
                                "resource_id": "selectable_armors",
                                "stat": "selectable_armors",
                                "view_type": "display"
                            },
                            {
                                "id": "class_display_selectable_weapons",
                                "type": "resourceArray",
                                "resource_id": "selectable_weapons",
                                "stat": "selectable_weapons",
                                "view_type": "display"
                            },
                            {
                                "id": "class_display_selectable_items",
                                "type": "resourceArray",
                                "resource_id": "selectable_items",
                                "stat": "selectable_equipments",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selectable_armors"
                                            }
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selectable_weapons"
                                            }
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selectable_equipments"
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "class_display_languages_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Languages (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_languages",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "language_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "class_display_skills_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Skill proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_skills",
                                "type": "resourceArray",
                                "resource_id": "levelled_skill_proficiency",
                                "stat": "skill_proficiencies",
                                "view_type": "display",
                                "left_view": {
                                    "id": "class_display_skills_multiclassable",
                                    "type": "checkbox",
                                    "stat": "account_for_skill_proficiencies_on_multiclass",
                                    "label": {
                                        "type": "constant",
                                        "value": "Available on multiclass",
                                        "value_type": "string"
                                    },
                                    "enabled": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "skill_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "class_display_armor_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Armor proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_armor_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_armor_proficiency",
                                "stat": "armor_proficiencies",
                                "view_type": "display",
                                "left_view": {
                                    "id": "class_display_armor_proficiencies_multiclassable",
                                    "type": "checkbox",
                                    "stat": "account_for_armor_proficiencies_on_multiclass",
                                    "label": {
                                        "type": "constant",
                                        "value": "Available on multiclass",
                                        "value_type": "string"
                                    },
                                    "enabled": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "class_display_weapon_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Weapon proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_weapon_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon_proficiency",
                                "stat": "weapon_proficiencies",
                                "view_type": "display",
                                "left_view": {
                                    "id": "class_display_weapon_proficiencies_multiclassable",
                                    "type": "checkbox",
                                    "stat": "account_for_weapon_proficiencies_on_multiclass",
                                    "label": {
                                        "type": "constant",
                                        "value": "Available on multiclass",
                                        "value_type": "string"
                                    },
                                    "enabled": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "class_display_tool_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Tool proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_tool_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "tool_proficiencies",
                                "view_type": "display",
                                "left_view": {
                                    "id": "class_display_tool_proficiencies_multiclassable",
                                    "type": "checkbox",
                                    "stat": "account_for_tool_proficiencies_on_multiclass",
                                    "label": {
                                        "type": "constant",
                                        "value": "Available on multiclass",
                                        "value_type": "string"
                                    },
                                    "enabled": {
                                        "type": "constant",
                                        "value": false,
                                        "value_type": "bool"
                                    },
                                    "label_alignment": "right",
                                    "style": "checkbox"
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "class_display_archetypes_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Archetypes",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "class_display_archetypes",
                                "type": "resourceSection",
                                "resource_stat": "archetypes",
                                "resource_id": "class",
                                "contentItemMinWidth": 1,
                                "read_only": true,
                                "header_view": {
                                    "id": "class_display_archetype_selection_level_composite",
                                    "type": "composite",
                                    "margin_top": 8,
                                    "subviews": [
                                        {
                                            "id": "class_display_archetype_selection_level_label",
                                            "type": "text",
                                            "text": {
                                                "type": "constant",
                                                "value": "Selection level: ",
                                                "value_type": "string"
                                            },
                                            "style": "text",
                                            "bold": true
                                        },
                                        {
                                            "id": "class_display_archetype_selection_level_label",
                                            "type": "text",
                                            "text": {
                                                "type": "stat",
                                                "stat": "archetype_selection_level"
                                            },
                                            "style": "text"
                                        }
                                    ]
                                }
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "archetypes"
                                }
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "background",
            "name": "Background",
            "plural": "Backgrounds",
            "core": true,
            "color": "#43A047",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "ability_score_increases",
                    "name": "Ability score increases",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "ability_score_increase",
                    "default_value": []
                },
                {
                    "id": "features",
                    "name": "Feat",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "feat",
                    "default_value": null
                },
                {
                    "id": "selectable_equipments",
                    "name": "Selectable equipment",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "selectable_items",
                    "default_value": []
                },
                {
                    "id": "selectable_armors",
                    "name": "Selectable armor",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "selectable_armors",
                    "default_value": []
                },
                {
                    "id": "selectable_weapons",
                    "name": "Selectable weapons",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "selectable_weapons",
                    "default_value": []
                },
                {
                    "id": "language_proficiencies",
                    "name": "Language proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "default_value": []
                },
                {
                    "id": "skill_proficiencies",
                    "name": "Skill proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "default_value": []
                },
                {
                    "id": "armor_proficiencies",
                    "name": "Armor proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "default_value": []
                },
                {
                    "id": "weapon_proficiencies",
                    "name": "Weapon proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "default_value": []
                },
                {
                    "id": "tool_proficiencies",
                    "name": "Tool proficiencies",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "default_value": []
                },
                {
                    "id": "language_proficiencies_for_current_level",
                    "name": "Language proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "language_proficiencies"
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "skill_proficiencies_for_current_level",
                    "name": "Skill proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "skill_proficiencies"
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "armor_proficiencies_for_current_level",
                    "name": "Armor proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "armor_proficiencies"
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "weapon_proficiencies_for_current_level",
                    "name": "Weapon proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "weapon_proficiencies"
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "tool_proficiencies_for_current_level",
                    "name": "Tool proficiencies for current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "tool_proficiencies"
                        },
                        "filter": {
                            "type": "lessThanEquals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "language_proficiencies_choices_in_current_level",
                    "name": "Language proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "language_proficiencies"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "skill_proficiencies_choices_in_current_level",
                    "name": "Skill proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_skill_proficiency",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "skill_proficiencies"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "armor_proficiencies_choices_in_current_level",
                    "name": "Armor proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_armor_proficiency",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "armor_proficiencies"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "weapon_proficiencies_choices_in_current_level",
                    "name": "Weapon proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_weapon_proficiency",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "weapon_proficiencies"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "tool_proficiencies_choices_in_current_level",
                    "name": "Tool proficiencies choices in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "levelled_choice_text",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "stat",
                            "stat": "tool_proficiencies"
                        },
                        "filter": {
                            "type": "equals",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "stat",
                                        "stat": "$filterValue.level"
                                    },
                                    {
                                        "type": "defaultIfNull",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$character.level"
                                        },
                                        "default_components": {
                                            "type": "constant",
                                            "value": 1,
                                            "value_type": "integer"
                                        }
                                    }
                                ]
                            }
                        }
                    }
                },
                {
                    "id": "formatted_description",
                    "name": "Formatted description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "(",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": ", ",
                                    "components": {
                                        "type": "flatAppend",
                                        "components": [
                                            {
                                                "type": "map",
                                                "components": {
                                                    "type": "flatMap",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "ability_score_increases"
                                                    },
                                                    "mapper": {
                                                        "type": "stat",
                                                        "stat": "$mapValue.modifier_options"
                                                    },
                                                    "treat_as_set": true
                                                },
                                                "mapper": {
                                                    "type": "enumeratedAbbreviation",
                                                    "enumerated_type": "ability",
                                                    "id": {
                                                        "type": "stat",
                                                        "stat": "$mapValue"
                                                    }
                                                }
                                            }
                                        ],
                                        "treat_as_set": true
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ") ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "notNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "features"
                                                }
                                            },
                                            "components": {
                                                "type": "stat",
                                                "stat": "features.name"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "",
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "selected_selectable_feature_ids",
                    "name": "Selected selectable feature ids",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "$character?.selected_selectable_feature_ids"
                        },
                        "default_components": {
                            "type": "list",
                            "components": []
                        }
                    }
                },
                {
                    "id": "current_level_features",
                    "name": "Current level features",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "flatMap",
                        "components": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "defined",
                                        "stat": "$character"
                                    },
                                    "components": {
                                        "type": "filter",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "features"
                                                }
                                            ]
                                        },
                                        "filter": {
                                            "type": "lessThanEquals",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "stat",
                                                        "stat": "$filterValue.min_level"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "$character.level"
                                                    }
                                                ]
                                            }
                                        }
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "list",
                                        "components": []
                                    }
                                }
                            ]
                        },
                        "mapper": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "$mapValue.has_selectable_features"
                                            },
                                            "components": {
                                                "type": "filter",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue.selectable_features"
                                                },
                                                "filter": {
                                                    "type": "contains",
                                                    "haystack": {
                                                        "type": "stat",
                                                        "stat": "selected_selectable_feature_ids"
                                                    },
                                                    "needle": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.id"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "features_with_updates_in_current_level",
                    "name": "Features with updates in current level",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "filter",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "features"
                                }
                            ]
                        },
                        "filter_value_key": "$feat",
                        "filter": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "filter",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$feat.descriptions"
                                    },
                                    "filter": {
                                        "type": "equals",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "stat",
                                                    "stat": "$filterValue.level"
                                                },
                                                {
                                                    "type": "stat",
                                                    "stat": "$character.level"
                                                }
                                            ]
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                {
                    "id": "all_features",
                    "name": "All features",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "flatMap",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "features"
                                }
                            ]
                        },
                        "mapper": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "stat",
                                            "stat": "$mapValue"
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "stat",
                                                "stat": "$mapValue.has_selectable_features"
                                            },
                                            "components": {
                                                "type": "filter",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$mapValue.selectable_features"
                                                },
                                                "filter": {
                                                    "type": "contains",
                                                    "haystack": {
                                                        "type": "stat",
                                                        "stat": "selected_selectable_feature_ids"
                                                    },
                                                    "needle": {
                                                        "type": "stat",
                                                        "stat": "$filterValue.id"
                                                    }
                                                }
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "features_list",
                    "name": "Features list",
                    "type": "calculated",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "feat",
                    "components": {
                        "type": "list",
                        "components": [
                            {
                                "type": "stat",
                                "stat": "features"
                            }
                        ]
                    }
                }
            ],
            "indexed_stats": [
                "name", "formatted_description",
                "source"
            ],
            "search_filters": [
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "sort_options": [
                {
                    "name": "alphabetically",
                    "stat": "name"
                },
                {
                    "name": "by source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                }
            ],
            "edit_view": {
                "id": "background_edit",
                "type": "viewPager",
                "names": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": "Basic information",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Proficiencies",
                            "value_type": "string"
                        }
                    ]
                },
                "color": {
                    "type": "constant",
                    "value": "#2D6C2F",
                    "value_type": "string"
                },
                "subviews": [
                    {
                        "id": "background_edit_basics",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "background_edit_name",
                                "type": "text",
                                "edit_stat": "name",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Name",
                                    "value_type": "string"
                                },
                                "max_length": 140,
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "$view.background_edit_name"
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "Please add a name to your background",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "background_edit_source",
                                "margin_top": 4,
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "background_edit_source_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Source: ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "background_edit_source_select",
                                        "type": "select",
                                        "options": "source",
                                        "options_display_stat": "abbreviation",
                                        "stat": "source"
                                    }
                                ]
                            },
                            {
                                "id": "background_edit_ability_score_increases",
                                "type": "resourceArray",
                                "resource_id": "ability_score_increase",
                                "stat": "ability_score_increases",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_ability_scores_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Ability Scores: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "use_bottom_sheet": false
                            },
                            {
                                "id": "background_edit_features_composite",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "background_edit_features_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Feat: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "background_edit_features",
                                        "type": "selectResources",
                                        "stat": "features",
                                        "resource_id": "feat",
                                        "view_type": "list",
                                        "filters": {
                                            "type": {
                                                "type": "constant",
                                                "value": "origin",
                                                "value_type": "string"
                                            }
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "background_edit_selectable_armors",
                                "type": "resourceArray",
                                "resource_id": "selectable_armors",
                                "stat": "selectable_armors",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_selectable_armors_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Armor choices: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "display_description"
                                }
                            },
                            {
                                "id": "background_edit_selectable_weapons",
                                "type": "resourceArray",
                                "resource_id": "selectable_weapons",
                                "stat": "selectable_weapons",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_selectable_weapons_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Weapon choices: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "display_description"
                                }
                            },
                            {
                                "id": "background_edit_selectable_equipments",
                                "type": "resourceArray",
                                "resource_id": "selectable_items",
                                "stat": "selectable_equipments",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_selectable_equipments_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Equipment choices: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "display_description"
                                }
                            }
                        ]
                    },
                    {
                        "id": "background_edit_proficiencies",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "background_edit_language_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "language_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_language_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Language proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "background_edit_skill_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_skill_proficiency",
                                "stat": "skill_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_skill_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Skill proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "description"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.background_edit_skill_proficiencies"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.options"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty levelled skill proficiencies. Please add some skills to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "background_edit_armor_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_armor_proficiency",
                                "stat": "armor_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_armor_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Armor proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "background_edit_weapon_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon_proficiency",
                                "stat": "weapon_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_weapon_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Weapon proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            },
                            {
                                "id": "background_edit_tool_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "tool_proficiencies",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "background_edit_tool_proficiencies_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Tool proficiency choices (per lvl): ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                }
                            }
                        ]
                    }
                ]
            },
            "search_item_view": {
                "id": "background_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "formatted_description"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "display_view": {
                "id": "background_display",
                "type": "list",
                "padding": 16,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "background_display_source",
                        "type": "text",
                        "style": "caption",
                        "margin_left": 16,
                        "resource_id": "source",
                        "resource_instance_ids_stat": "source",
                        "resource_display_stat": "abbreviation"
                    },
                    {
                        "id": "background_display_ability_score_increases",
                        "type": "resourceArray",
                        "resource_id": "ability_score_increase",
                        "stat": "ability_score_increases",
                        "view_type": "display",
                        "left_view": {
                            "id": "background_display_armor_class_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Ability Scores: ",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "ability_score_increases"
                                }
                            }
                        }
                    },
                    {
                        "id": "background_display_features_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Features",
                            "value_type": "string"
                        },
                        "start_expanded": true,
                        "subviews": [
                            {
                                "id": "background_display_features",
                                "type": "resourceSection",
                                "resource_stat": "features_list",
                                "resource_id": "feat",
                                "contentItemMinWidth": 1,
                                "read_only": true
                            }
                        ]
                    },
                    {
                        "id": "background_display_equipment_choices_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Starting equipment choices",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "background_display_selectable_armors",
                                "type": "resourceArray",
                                "resource_id": "selectable_armors",
                                "stat": "selectable_armors",
                                "view_type": "display"
                            },
                            {
                                "id": "background_display_selectable_weapons",
                                "type": "resourceArray",
                                "resource_id": "selectable_weapons",
                                "stat": "selectable_weapons",
                                "view_type": "display"
                            },
                            {
                                "id": "background_display_selectable_items",
                                "type": "resourceArray",
                                "resource_id": "selectable_items",
                                "stat": "selectable_equipments",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "and",
                            "components": {
                                "type": "list",
                                "components": [
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selectable_armors"
                                            }
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selectable_weapons"
                                            }
                                        }
                                    },
                                    {
                                        "type": "not",
                                        "components": {
                                            "type": "isEmpty",
                                            "components": {
                                                "type": "stat",
                                                "stat": "selectable_equipments"
                                            }
                                        }
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "id": "background_display_languages_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Languages (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "background_display_languages",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "language_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "language_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "background_display_skills_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Skill proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "background_display_skills",
                                "type": "resourceArray",
                                "resource_id": "levelled_skill_proficiency",
                                "stat": "skill_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "skill_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "background_display_armor_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Armor proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "background_display_armor_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_armor_proficiency",
                                "stat": "armor_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "armor_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "background_display_weapon_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Weapon proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "background_display_weapon_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_weapon_proficiency",
                                "stat": "weapon_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "weapon_proficiencies"
                                }
                            }
                        }
                    },
                    {
                        "id": "background_display_tool_proficiencies_collapsible",
                        "type": "collapsible",
                        "title": {
                            "type": "constant",
                            "value": "Tool proficiencies (per lvl)",
                            "value_type": "string"
                        },
                        "start_expanded": false,
                        "subviews": [
                            {
                                "id": "background_display_tool_proficiencies",
                                "type": "resourceArray",
                                "resource_id": "levelled_choice_text",
                                "stat": "tool_proficiencies",
                                "view_type": "display"
                            }
                        ],
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "tool_proficiencies"
                                }
                            }
                        }
                    }
                ]
            }
        },
        {
            "id": "note",
            "name": "Note",
            "plural": "Notes",
            "display_name": "display_title",
            "stats": [
                {
                    "id": "title",
                    "name": "Title",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "text",
                    "name": "Text",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "display_title",
                    "name": "Display title",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "isEmpty",
                                    "components": {
                                        "type": "stat",
                                        "stat": "title"
                                    }
                                },
                                "components": {
                                    "type": "constant",
                                    "value": "Untitled note",
                                    "value_type": "string"
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "stat",
                                    "stat": "title"
                                }
                            }
                        ]
                    }
                }
            ],
            "edit_view": {
                "id": "note_edit",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "note_edit_title",
                        "type": "text",
                        "edit_stat": "title",
                        "style": "text",
                        "max_length": 80,
                        "label": {
                            "type": "constant",
                            "value": "Note title",
                            "value_type": "string"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "and",
                                        "components": {
                                            "type": "list",
                                            "components": [
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view.note_edit_title"
                                                    }
                                                },
                                                {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "$view.note_edit_text"
                                                    }
                                                }
                                            ]
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Looks like you're trying to save an empty note! Why don't you write something down?",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "note_edit_text",
                        "type": "text",
                        "edit_stat": "text",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Note",
                            "value_type": "string"
                        },
                        "hint": {
                            "type": "constant",
                            "value": "Jot something down...",
                            "value_type": "string"
                        }
                    }
                ]
            },
            "display_view": {
                "id": "note_display",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "note_display_text",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "text"
                        },
                        "style": "text"
                    }
                ]
            },
            "list_view": {
                "id": "note_list",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "display_title"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "text"
                }
            }
        },
        {
            "id": "source",
            "name": "Source",
            "plural": "Sources",
            "core": true,
            "color": "#333333",
            "display_name": "abbreviation",
            "stats": [
                 {
                    "id": "abbreviation",
                    "name": "Abbreviation",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                }
            ],
            "indexed_stats": [
                "abbreviation"
            ],
            "edit_view": {
                "id": "source_edit",
                "type": "list",
                "padding": 32,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "source_edit_abbreviation",
                        "type": "text",
                        "edit_stat": "abbreviation",
                        "style": "text",
                        "max_length": 8,
                        "label": {
                            "type": "constant",
                            "value": "Abbreviation",
                            "value_type": "string"
                        },
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.source_edit_abbreviation"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please fill in the abbreviation field",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    }
                ]
            },
            "search_item_view": {
                "id": "background_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "abbreviation"
                },
                "subtitle": {
                    "type": "constant",
                    "value": "",
                    "value_type": "string"
                }
            },
            "display_view": {
                "id": "source_display",
                "type": "list",
                "padding": 16,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "source_display",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Not a lot to see here for now! You can use sources to organize your content",
                            "value_type": "string"
                        },
                        "style": "text"
                    }
                ]
            }
        },
        {
            "id": "monster_trait",
            "name": "Trait",
            "plural": "Traits",
            "stats": [
                {
                    "id": "trait_name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "trait_description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                }
            ],
            "edit_view": {
                "id": "monster_trait_edit",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "monster_trait_edit_name",
                        "type": "text",
                        "edit_stat": "trait_name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.monster_trait_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to your trait",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "monster_trait_edit_description",
                        "type": "text",
                        "edit_stat": "trait_description",
                        "label": {
                            "type": "constant",
                            "value": "Description",
                            "value_type": "string"
                        },
                        "style": "text"
                    }
                ]
            },
            "list_view": {
                "id": "monster_trait_list",
                "type": "list",
                "padding_left": 8,
                "padding_right": 8,
                "padding_bottom": 4,
                "subviews": [
                    {
                        "id": "monster_trait_list_name",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "trait_name"
                        },
                        "style": "text",
                        "bold": true
                    },
                    {
                        "id": "monster_trait_list_description",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "trait_description"
                        },
                        "style": "text"
                    }
                ]
            }
        },
        {
            "id": "damage_variant",
            "name": "Damage variant",
            "stats": [
                {
                    "id": "variant_name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "variant_damage_dice",
                    "name": "Damage dice",
                    "abbreviation": "Dmg Dice",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "damage_dice",
                    "default_value": []
                },
                {
                    "id": "variant_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "variant_name"
                                },
                                {
                                    "type": "constant",
                                    "value": ": ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "joinToString",
                                    "separator": " + ",
                                    "components": {
                                        "type": "when",
                                        "clauses": [
                                            {
                                                "condition": {
                                                    "type": "not",
                                                    "components": {
                                                        "type": "isEmpty",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "variant_damage_dice"
                                                        }
                                                    }
                                                },
                                                "components": {
                                                    "type": "map",
                                                    "components": {
                                                        "type": "stat",
                                                        "stat": "variant_damage_dice"
                                                    },
                                                    "mapper": {
                                                        "type": "stat",
                                                        "stat": "$mapValue.display_description"
                                                    }
                                                }
                                            },
                                            {
                                                "condition": {
                                                    "type": "constant",
                                                    "value": true,
                                                    "value_type": "bool"
                                                },
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "No damage",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "damage_variant_edit",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "damage_variant_edit_name",
                        "type": "text",
                        "edit_stat": "variant_name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.damage_variant_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to the damage variant",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "damage_variant_edit_dice",
                        "type": "resourceArray",
                        "resource_id": "damage_dice",
                        "stat": "variant_damage_dice",
                        "view_type": "edit",
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "display_description"
                        }
                    }
                ]
            },
            "display_view": {
                "id": "damage_variant_display",
                "type": "text",
                "text": {
                    "type": "stat",
                    "stat": "variant_description"
                },
                "style": "text"
            }
        },
        {
            "id": "monster_action",
            "name": "Action",
            "plural": "Actions",
            "stats": [
                {
                    "id": "action_name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "action_description",
                    "name": "Description",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "action_type",
                    "name": "Type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "none"
                },
                {
                    "id": "action_attack_bonus",
                    "name": "Attack bonus",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "action_damage_variants",
                    "name": "Damage variants",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "damage_variant",
                    "default_value": []
                },
                {
                    "id": "action_display_description",
                    "name": "Display description",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "equals",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "action_type"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": "none",
                                                            "value_type": "string"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "enumeratedName",
                                                        "enumerated_type": "monster_action_types",
                                                        "id": {
                                                            "type": "stat",
                                                            "stat": "action_type"
                                                        }
                                                    },
                                                    {
                                                        "type": "constant",
                                                        "value": " ",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "and",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "action_type"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": "none",
                                                                        "value_type": "string"
                                                                    }
                                                                ]
                                                            }
                                                        },
                                                        {
                                                            "type": "equals",
                                                            "components": {
                                                                "type": "list",
                                                                "components": [
                                                                    {
                                                                        "type": "stat",
                                                                        "stat": "action_attack_bonus"
                                                                    },
                                                                    {
                                                                        "type": "constant",
                                                                        "value": 0,
                                                                        "value_type": "integer"
                                                                    }
                                                                ]
                                                            }
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "Attack: ",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "trim",
                                            "components": {
                                                "type": "stat",
                                                "stat": "action_description"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "monster_action_edit",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "monster_action_edit_name",
                        "type": "text",
                        "edit_stat": "action_name",
                        "style": "text",
                        "label": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "max_length": 140,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.monster_action_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please add a name to the action",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "monster_action_edit_type",
                        "type": "select",
                        "stat": "action_type",
                        "options": "monster_action_types"
                    },
                    {
                        "id": "monster_action_edit_description",
                        "type": "text",
                        "edit_stat": "action_description",
                        "label": {
                            "type": "constant",
                            "value": "Description",
                            "value_type": "string"
                        },
                        "style": "text"
                    },
                    {
                        "id": "monster_action_edit_attack_bonus",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "monster_action_edit_attack_bonus_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Attack bonus: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_action_edit_attack_bonus_text",
                                "type": "text",
                                "edit_stat": "action_attack_bonus",
                                "style": "text",
                                "max_length": 3,
                                "signed": true,
                                "hint": {
                                    "type": "constant",
                                    "value": "0",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "monster_action_edit_damage_variants",
                        "type": "resourceArray",
                        "resource_id": "damage_variant",
                        "stat": "action_damage_variants",
                        "view_type": "edit",
                        "left_view": {
                            "id": "monster_action_edit_damage_variants_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Damage variants",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        "pop_up_type": "bottomSheet",
                        "pop_up_button_text": {
                            "type": "stat",
                            "stat": "variant_description"
                        }
                    }
                ]
            },
            "list_view": {
                "id": "monster_action_list",
                "type": "list",
                "padding_left": 8,
                "padding_right": 8,
                "padding_bottom": 4,
                "subviews": [
                    {
                        "id": "monster_action_list_name",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "action_name"
                        },
                        "style": "text",
                        "bold": true
                    },
                    {
                        "id": "monster_action_list_description",
                        "type": "text",
                        "text": {
                            "type": "stat",
                            "stat": "action_display_description"
                        },
                        "style": "text"
                    }
                ]
            }
        },
        {
            "id": "monster",
            "name": "Monster",
            "plural": "Monsters",
            "core": true,
            "color": "#512DA8",
            "stats": [
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "photo",
                    "name": "Photo",
                    "type": "base",
                    "value_type": "photo",
                    "default_value": null
                },
                {
                    "id": "source",
                    "name": "Source",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "tag",
                    "name": "Tag",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "armor_class",
                    "name": "Armor Class",
                    "abbreviation": "AC",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "hit_points",
                    "name": "hp",
                    "type": "base",
                    "value_type": "resource",
                    "resource_type": "dice_roll",
                    "default_value": null
                },
                {
                    "id": "average_hp",
                    "name": "Average HP",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "hit_points?.average"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": 1,
                            "value_type": "integer"
                        }
                    }
                },
                {
                    "id": "cr",
                    "name": "CR",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "cr_0"
                },
                {
                    "id": "xp",
                    "name": "Experience",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "cr_xp",
                    "name": "CR (XP)",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "enumeratedName",
                                    "enumerated_type": "monster_cr_types",
                                    "id": {
                                        "type": "stat",
                                        "stat": "cr"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "xp"
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "initiative",
                    "name": "Initiative",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "speed",
                    "name": "Speed",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 30
                },
                {
                    "id": "burrow_speed",
                    "name": "Burrow",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "climb_speed",
                    "name": "Climb",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "fly_speed",
                    "name": "Fly",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "swim_speed",
                    "name": "Swim",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "display_speeds",
                    "name": "Display speeds",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": "\n",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "concat",
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "constant",
                                                        "value": "Speed ",
                                                        "value_type": "string"
                                                    },
                                                    {
                                                        "type": "stat",
                                                        "stat": "speed"
                                                    },
                                                    {
                                                        "type": "constant",
                                                        "value": " ft.",
                                                        "value_type": "string"
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "burrow_speed"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "Burrow ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "burrow_speed"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": " ft.",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "climb_speed"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "Climb ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "climb_speed"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": " ft.",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "fly_speed"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "Fly ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "fly_speed"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": " ft.",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "greaterThan",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "stat",
                                                            "stat": "swim_speed"
                                                        },
                                                        {
                                                            "type": "constant",
                                                            "value": 0,
                                                            "value_type": "integer"
                                                        }
                                                    ]
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": "Swim ",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "swim_speed"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": " ft.",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "strength_score",
                    "name": "Strength",
                    "abbreviation": "STR",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "dexterity_score",
                    "name": "Dexterity",
                    "abbreviation": "DEX",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "constitution_score",
                    "name": "Constitution",
                    "abbreviation": "CON",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "intelligence_score",
                    "name": "Intelligence",
                    "abbreviation": "INT",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "wisdom_score",
                    "name": "Wisdom",
                    "abbreviation": "WIS",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "charisma_score",
                    "name": "Charisma",
                    "abbreviation": "CHA",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "strength_saving_throw_modifier",
                    "name": "Strength saving throw modifier",
                    "abbreviation": "STR",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "dexterity_saving_throw_modifier",
                    "name": "Dexterity saving throw modifier",
                    "abbreviation": "DEX",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "constitution_saving_throw_modifier",
                    "name": "Constitution saving throw modifier",
                    "abbreviation": "CON",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "intelligence_saving_throw_modifier",
                    "name": "Intelligence saving throw modifier",
                    "abbreviation": "INT",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "wisdom_saving_throw_modifier",
                    "name": "Wisdom saving throw modifier",
                    "abbreviation": "WIS",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "charisma_saving_throw_modifier",
                    "name": "Charisma saving throw modifier",
                    "abbreviation": "CHA",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "skills",
                    "name": "Skills",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "gear",
                    "name": "Gear",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "vulnerabilities",
                    "name": "Vulnerabilities",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "immunities",
                    "name": "Immunitites",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "resistances",
                    "name": "Resistances",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "senses",
                    "name": "Senses",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "languages",
                    "name": "Languages",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "size",
                    "name": "Size",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "medium"
                },
                {
                    "id": "type",
                    "name": "Type",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "aberration"
                },
                {
                    "id": "alignment",
                    "name": "Alignment",
                    "type": "base",
                    "value_type": "string",
                    "default_value": "true_neutral"
                },
                {
                    "id": "traits",
                    "name": "Traits",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "monster_trait",
                    "default_value": []
                },
                {
                    "id": "actions",
                    "name": "Actions",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "monster_action",
                    "default_value": []
                },
                {
                    "id": "bonus_actions",
                    "name": "Bonus actions",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "monster_action",
                    "default_value": []
                },
                {
                    "id": "reactions",
                    "name": "Reactions",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "monster_action",
                    "default_value": []
                },
                {
                    "id": "legendary_actions",
                    "name": "Legendary actions",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "monster_action",
                    "default_value": []
                },
                {
                    "id": "spells",
                    "name": "Spells",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "resource",
                    "resource_type": "spell",
                    "default_value": []
                },
                {
                    "id": "habitat",
                    "name": "Habitat",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "treasure",
                    "name": "Treasure",
                    "type": "base",
                    "value_type": "array",
                    "sub_value_type": "string",
                    "default_value": []
                },
                {
                    "id": "formatted_type",
                    "name": "Formatted type",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "enumeratedName",
                        "enumerated_type": "monster_types",
                        "id": {
                            "type": "stat",
                            "stat": "type"
                        }
                    }
                },
                {
                    "id": "formatted_cr",
                    "name": "Formatted cr",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "enumeratedName",
                        "enumerated_type": "monster_cr_types",
                        "id": {
                            "type": "stat",
                            "stat": "cr"
                        }
                    }
                },
                {
                    "id": "formatted_xp",
                    "name": "Formatted xp",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "stat",
                                    "stat": "xp"
                                },
                                {
                                    "type": "constant",
                                    "value": " XP",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "type_info",
                    "name": "Type info",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "flatAppend",
                            "components": [
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "enumeratedName",
                                            "enumerated_type": "monster_sizes",
                                            "id": {
                                                "type": "stat",
                                                "stat": "size"
                                            }
                                        },
                                        {
                                            "type": "constant",
                                            "value": " ",
                                            "value_type": "string"
                                        },
                                        {
                                            "type": "enumeratedName",
                                            "enumerated_type": "monster_types",
                                            "id": {
                                                "type": "stat",
                                                "stat": "type"
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "isEmpty",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "tag"
                                                }
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": []
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "list",
                                                "components": [
                                                    {
                                                        "type": "concat",
                                                        "components": {
                                                            "type": "list",
                                                            "components": [
                                                                {
                                                                    "type": "constant",
                                                                    "value": " (",
                                                                    "value_type": "string"
                                                                },
                                                                {
                                                                    "type": "stat",
                                                                    "stat": "tag"
                                                                },
                                                                {
                                                                    "type": "constant",
                                                                    "value": ")",
                                                                    "value_type": "string"
                                                                }
                                                            ]
                                                        }
                                                    }
                                                ]
                                            }
                                        }
                                    ]
                                },
                                {
                                    "type": "list",
                                    "components": [
                                        {
                                            "type": "constant",
                                            "value": ", ",
                                            "value_type": "string"
                                        },
                                        {
                                            "type": "enumeratedName",
                                            "enumerated_type": "monster_alignments",
                                            "id": {
                                                "type": "stat",
                                                "stat": "alignment"
                                            }
                                        }
                                    ]
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "hit_points_formatted",
                    "name": "Formatted hit points",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "when",
                        "clauses": [
                            {
                                "condition": {
                                    "type": "and",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "defined",
                                                "stat": "$parent.max_hp"
                                            },
                                            {
                                                "type": "defined",
                                                "stat": "$parent.hp"
                                            }
                                        ]
                                    }
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "$parent.hp"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " / ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "$parent.max_hp"
                                            }
                                        ]
                                    }
                                }
                            },
                            {
                                "condition": {
                                    "type": "constant",
                                    "value": true,
                                    "value_type": "bool"
                                },
                                "components": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "average_hp"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " (",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "defaultIfNull",
                                                "components": {
                                                    "type": "stat",
                                                    "stat": "hit_points?.formula"
                                                },
                                                "default_components": {
                                                    "type": "constant",
                                                    "value": "0",
                                                    "value_type": "string"
                                                }
                                            },
                                            {
                                                "type": "constant",
                                                "value": ")",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                }
                            }
                        ]
                    }
                },
                {
                    "id": "strength_modifier",
                    "name": "Strength",
                    "abbreviation": "STR",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "divide",
                        "rounding_method": "down",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "strength_score"
                                            },
                                            {
                                                "type": "constant",
                                                "value": -10,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 2,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "dexterity_modifier",
                    "name": "Dexterity",
                    "abbreviation": "DEX",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "divide",
                        "rounding_method": "down",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "dexterity_score"
                                            },
                                            {
                                                "type": "constant",
                                                "value": -10,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 2,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "constitution_modifier",
                    "name": "Constitution",
                    "abbreviation": "CON",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "divide",
                        "rounding_method": "down",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "constitution_score"
                                            },
                                            {
                                                "type": "constant",
                                                "value": -10,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 2,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "intelligence_modifier",
                    "name": "Intelligence",
                    "abbreviation": "INT",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "divide",
                        "rounding_method": "down",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "intelligence_score"
                                            },
                                            {
                                                "type": "constant",
                                                "value": -10,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 2,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "wisdom_modifier",
                    "name": "Wisdom",
                    "abbreviation": "WIS",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "divide",
                        "rounding_method": "down",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "wisdom_score"
                                            },
                                            {
                                                "type": "constant",
                                                "value": -10,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 2,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "charisma_modifier",
                    "name": "Charisma",
                    "abbreviation": "CHA",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "divide",
                        "rounding_method": "down",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "add",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "stat",
                                                "stat": "charisma_score"
                                            },
                                            {
                                                "type": "constant",
                                                "value": -10,
                                                "value_type": "integer"
                                            }
                                        ]
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": 2,
                                    "value_type": "integer"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_strength_with_mod",
                    "name": "Display strength with mod",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "STR: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "strength_score"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "strength_modifier"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_dexterity_with_mod",
                    "name": "Display dexterity with mod",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "DEX: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "dexterity_score"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "dexterity_modifier"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_constitution_with_mod",
                    "name": "Display constitution with mod",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "CON: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "constitution_score"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "constitution_modifier"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_intelligence_with_mod",
                    "name": "Display intelligence with mod",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "INT: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "intelligence_score"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "intelligence_modifier"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_wisdom_with_mod",
                    "name": "Display wisdom with mod",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "WIS: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "wisdom_score"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "wisdom_modifier"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_charisma_with_mod",
                    "name": "Display charisma with mod",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "CHA: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "stat",
                                    "stat": "charisma_score"
                                },
                                {
                                    "type": "constant",
                                    "value": " (",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "charisma_modifier"
                                    }
                                },
                                {
                                    "type": "constant",
                                    "value": ")",
                                    "value_type": "string"
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_strength_save",
                    "name": "Display strength save",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "STR: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "strength_saving_throw_modifier"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_dexterity_save",
                    "name": "Display dexterity save",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "DEX: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "dexterity_saving_throw_modifier"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_constitution_save",
                    "name": "Display constitution save",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "CON: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "constitution_saving_throw_modifier"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_intelligence_save",
                    "name": "Display intelligence save",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "INT: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "intelligence_saving_throw_modifier"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_wisdom_save",
                    "name": "Display wisdom save",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "WIS: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "wisdom_saving_throw_modifier"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "display_charisma_save",
                    "name": "Display charisma save",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "concat",
                        "components": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "constant",
                                    "value": "CHA: ",
                                    "value_type": "string"
                                },
                                {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "charisma_saving_throw_modifier"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "formatted_habitats",
                    "name": "Formatted habitats",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "map",
                            "components": {
                                "type": "stat",
                                "stat": "habitat"
                            },
                            "mapper": {
                                "type": "enumeratedName",
                                "enumerated_type": "monster_habitats",
                                "id": {
                                    "type": "stat",
                                    "stat": "$mapValue"
                                }
                            }
                        }
                    }
                },
                {
                    "id": "formatted_treasure",
                    "name": "Formatted treasure",
                    "type": "calculated",
                    "value_type": "string",
                    "components": {
                        "type": "joinToString",
                        "separator": ", ",
                        "components": {
                            "type": "map",
                            "components": {
                                "type": "stat",
                                "stat": "treasure"
                            },
                            "mapper": {
                                "type": "enumeratedName",
                                "enumerated_type": "monster_treasure_themes",
                                "id": {
                                    "type": "stat",
                                    "stat": "$mapValue"
                                }
                            }
                        }
                    }
                }
            ],
            "indexed_stats": [
                "name", 
                "size",
                "cr",
                "alignment",
                "type",
                "source",
                "formatted_type",
                "formatted_cr",
                "formatted_xp"
            ],
            "search_filters": [
                {
                    "name": "Source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                },
                {
                    "name": "Habitat",
                    "stat": "habitat",
                    "options": "monster_habitats"
                },
                {
                    "name": "Size",
                    "stat": "size",
                    "options": "monster_sizes"
                },
                {
                    "name": "Alignment",
                    "stat": "alignment",
                    "options": "monster_alignments"
                },
                {
                    "name": "Type",
                    "stat": "type",
                    "options": "monster_types"
                },
                {
                    "name": "CR",
                    "stat": "cr",
                    "options": "monster_cr_types"
                }
            ],
            "sort_options": [
                {
                    "name": "alphabetically",
                    "stat": "name"
                },
                {
                    "name": "by source",
                    "stat": "source",
                    "options": "source",
                    "options_display_stat": "abbreviation"
                },
                {
                    "name": "by creature type",
                    "stat": "type",
                    "options": "monster_types"
                },
                {
                    "name": "by CR",
                    "stat": "cr",
                    "options": "monster_cr_types"
                }
            ],
            "edit_view": {
                "id": "monster_edit",
                "type": "viewPager",
                "names": {
                    "type": "list",
                    "components": [
                        {
                            "type": "constant",
                            "value": "Basic information",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Traits & Actions",
                            "value_type": "string"
                        },
                        {
                            "type": "constant",
                            "value": "Extra information",
                            "value_type": "string"
                        }
                    ]
                },
                "color": {
                    "type": "constant",
                    "value": "#311B66",
                    "value_type": "string"
                },
                "subviews": [
                    {
                        "id": "monster_edit_basics",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "monster_edit_basics_name_photo",
                                "type": "composite",
                                "alignment": "center",
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_photo",
                                        "type": "avatar",
                                        "photo_stat": "photo",
                                        "name_stat": "name",
                                        "size": "medium",
                                        "interactable": true
                                    },
                                    {
                                        "id": "monster_edit_name",
                                        "type": "text",
                                        "edit_stat": "name",
                                        "style": "text",
                                        "label": {
                                            "type": "constant",
                                            "value": "Name",
                                            "value_type": "string"
                                        },
                                        "max_length": 140,
                                        "validation_message": {
                                            "type": "when",
                                            "clauses": [
                                                {
                                                    "condition": {
                                                        "type": "isEmpty",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.monster_edit_name"
                                                        }
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": "Please add a name to your monster",
                                                        "value_type": "string"
                                                    }
                                                },
                                                {
                                                    "condition": {
                                                        "type": "constant",
                                                        "value": true,
                                                        "value_type": "bool"
                                                    },
                                                    "components": {
                                                        "type": "constant",
                                                        "value": null,
                                                        "value_type": "string"
                                                    }
                                                }
                                            ]
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_source",
                                "margin_top": 4,
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "monster_edit_source_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Source: ",
                                            "value_type": "string"
                                        },
                                        "style": "text"
                                    },
                                    {
                                        "id": "monster_edit_source_select",
                                        "type": "select",
                                        "options": "source",
                                        "options_display_stat": "abbreviation",
                                        "stat": "source"
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_size_type",
                                "type": "composite",
                                "margin_top": 4,
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_size",
                                        "type": "select",
                                        "stat": "size",
                                        "options": "monster_sizes"
                                    },
                                    {
                                        "id": "monster_edit_basics_type",
                                        "type": "select",
                                        "stat": "type",
                                        "options": "monster_types"
                                    },
                                    {
                                        "id": "monster_edit_basics_alignment",
                                        "type": "select",
                                        "stat": "alignment",
                                        "options": "monster_alignments"
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_tag_alignment",
                                "type": "composite",
                                "margin_top": 4,
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_tag",
                                        "type": "text",
                                        "edit_stat": "tag",
                                        "style": "text",
                                        "max_length": 14,
                                        "hint": {
                                            "type": "constant",
                                            "value": "(tag)",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_cr_xp",
                                "type": "composite",
                                "margin_top": 4,
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_cr",
                                        "type": "select",
                                        "stat": "cr",
                                        "options": "monster_cr_types",
                                        "margin_right": 4
                                    },
                                    {
                                        "id": "monster_edit_basics_xp_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "XP: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "monster_edit_basics_xp_label",
                                        "type": "text",
                                        "edit_stat": "xp",
                                        "style": "text",
                                        "max_length": 8
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_habitat",
                                "type": "composite",
                                "margin_top": 4,
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_habitat_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Habitat: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "monster_edit_basics_habitat_select",
                                        "type": "select",
                                        "stat": "habitat",
                                        "multi_select": true,
                                        "options": "monster_habitats"
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_treasure",
                                "type": "composite",
                                "margin_top": 4,
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_treasure_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Treasure: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "monster_edit_basics_treasure_select",
                                        "type": "select",
                                        "stat": "treasure",
                                        "multi_select": true,
                                        "options": "monster_treasure_themes"
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_divider_1",
                                "type": "divider"
                            },
                            {
                                "id": "monster_edit_basics_armor_class",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_armor_class_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Armor class: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "monster_edit_basics_armor_class_text",
                                        "type": "text",
                                        "edit_stat": "armor_class",
                                        "style": "text",
                                        "max_length": 2
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_hit_points",
                                "type": "composite",
                                "margin_top": 4,
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_hit_points_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Hit points: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "monster_edit_basics_hit_points_res",
                                        "type": "resource",
                                        "view_type": "edit",
                                        "resource_id": "dice_roll",
                                        "stat": "hit_points",
                                        "create_if_empty": true
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_initiative",
                                "type": "composite",
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_initiative_label",
                                        "type": "text",
                                        "text": {
                                            "type": "constant",
                                            "value": "Initiative: ",
                                            "value_type": "string"
                                        },
                                        "style": "text",
                                        "bold": true
                                    },
                                    {
                                        "id": "monster_edit_basics_initiative_text",
                                        "type": "text",
                                        "edit_stat": "initiative",
                                        "style": "text",
                                        "signed": true,
                                        "max_length": 3
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_speed_composite",
                                "type": "composite",
                                "alignment": "center",
                                "subviews": [
                                    {
                                        "id": "monster_edit_basics_speed",
                                        "type": "text",
                                        "edit_stat": "speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Normal",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "monster_edit_basics_burrow_speed",
                                        "type": "text",
                                        "edit_stat": "burrow_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Burrow",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "monster_edit_basics_climb_speed",
                                        "type": "text",
                                        "edit_stat": "climb_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Climb",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "monster_edit_basics_fly_speed",
                                        "type": "text",
                                        "edit_stat": "fly_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Fly",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "monster_edit_basics_swim_speed",
                                        "type": "text",
                                        "edit_stat": "swim_speed",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_left": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "0",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "Swim",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_divider_1",
                                "type": "divider"
                            },
                            {
                                "id": "monster_edit_basics_ability_scores_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Ability scores:",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "edit_character_basics_ability_scores_composite",
                                "type": "composite",
                                "alignment": "center",
                                "subviews": [
                                    {
                                        "id": "edit_character_basics_ability_scores_str",
                                        "type": "text",
                                        "edit_stat": "strength_score",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "STR",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_ability_scores_dex",
                                        "type": "text",
                                        "edit_stat": "dexterity_score",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "DEX",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_ability_scores_con",
                                        "type": "text",
                                        "edit_stat": "constitution_score",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "CON",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_ability_scores_int",
                                        "type": "text",
                                        "edit_stat": "intelligence_score",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "INT",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_ability_scores_wis",
                                        "type": "text",
                                        "edit_stat": "wisdom_score",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "WIS",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_ability_scores_cha",
                                        "type": "text",
                                        "edit_stat": "charisma_score",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "CHA",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "monster_edit_basics_saving_throws_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Saving throw modifiers:",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true,
                                "margin_top": 4
                            },
                            {
                                "id": "edit_character_basics_saving_throws_composite",
                                "type": "composite",
                                "alignment": "center",
                                "subviews": [
                                    {
                                        "id": "edit_character_basics_saving_throws_str",
                                        "type": "text",
                                        "edit_stat": "strength_saving_throw_modifier",
                                        "style": "text",
                                        "max_length": 3,
                                        "margin_right": 4,
                                        "signed": true,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "STR",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_saving_throws_dex",
                                        "type": "text",
                                        "edit_stat": "dexterity_saving_throw_modifier",
                                        "style": "text",
                                        "max_length": 3,
                                        "margin_right": 4,
                                        "signed": true,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "DEX",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_saving_throws_con",
                                        "type": "text",
                                        "edit_stat": "constitution_saving_throw_modifier",
                                        "style": "text",
                                        "max_length": 3,
                                        "margin_right": 4,
                                        "signed": true,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "CON",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            },
                            {
                                "id": "edit_character_basics_saving_throws_composite_2",
                                "type": "composite",
                                "alignment": "center",
                                "subviews": [
                                    {
                                        "id": "edit_character_basics_saving_throws_int",
                                        "type": "text",
                                        "edit_stat": "intelligence_saving_throw_modifier",
                                        "style": "text",
                                        "max_length": 3,
                                        "margin_right": 4,
                                        "signed": true,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "INT",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_saving_throws_wis",
                                        "type": "text",
                                        "edit_stat": "wisdom_saving_throw_modifier",
                                        "style": "text",
                                        "max_length": 3,
                                        "margin_right": 4,
                                        "signed": true,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "WIS",
                                            "value_type": "string"
                                        }
                                    },
                                    {
                                        "id": "edit_character_basics_saving_throws_cha",
                                        "type": "text",
                                        "edit_stat": "charisma_saving_throw_modifier",
                                        "style": "text",
                                        "max_length": 2,
                                        "margin_right": 4,
                                        "signed": false,
                                        "hint": {
                                            "type": "constant",
                                            "value": "8",
                                            "value_type": "string"
                                        },
                                        "label": {
                                            "type": "constant",
                                            "value": "CHA",
                                            "value_type": "string"
                                        }
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "id": "monster_edit_traits_and_actions",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "monster_edit_traits",
                                "type": "resourceArray",
                                "resource_id": "monster_trait",
                                "stat": "traits",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "monster_edit_traits_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Traits: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "trait_name"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.monster_edit_traits"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.trait_name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty traits. Please add some content to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "monster_edit_actions",
                                "type": "resourceArray",
                                "resource_id": "monster_action",
                                "stat": "actions",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "monster_edit_actions_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Actions: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "action_name"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.monster_edit_actions"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.action_name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty actions. Please add some content to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "monster_edit_bonus_actions",
                                "type": "resourceArray",
                                "resource_id": "monster_action",
                                "stat": "bonus_actions",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "monster_edit_actions_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Bonus actions: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "action_name"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.monster_edit_bonus_actions"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.action_name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty bonus actions. Please add some content to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "monster_edit_reactions",
                                "type": "resourceArray",
                                "resource_id": "monster_action",
                                "stat": "reactions",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "monster_edit_actions_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Rections: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "action_name"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.monster_edit_reactions"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.action_name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty reactions. Please add some content to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "monster_edit_legendary_actions",
                                "type": "resourceArray",
                                "resource_id": "monster_action",
                                "stat": "legendary_actions",
                                "view_type": "edit",
                                "left_view": {
                                    "id": "monster_edit_actions_label",
                                    "type": "text",
                                    "text": {
                                        "type": "constant",
                                        "value": "Legendary actions: ",
                                        "value_type": "string"
                                    },
                                    "style": "text",
                                    "bold": true
                                },
                                "pop_up_type": "bottomSheet",
                                "pop_up_button_text": {
                                    "type": "stat",
                                    "stat": "action_name"
                                },
                                "validation_message": {
                                    "type": "when",
                                    "clauses": [
                                        {
                                            "condition": {
                                                "type": "not",
                                                "components": {
                                                    "type": "isEmpty",
                                                    "components": {
                                                        "type": "filter",
                                                        "components": {
                                                            "type": "stat",
                                                            "stat": "$view.monster_edit_legendary_actions"
                                                        },
                                                        "filter": {
                                                            "type": "isEmpty",
                                                            "components": {
                                                                "type": "stat",
                                                                "stat": "$filterValue.action_name"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": "You have empty legendary actions. Please add some content to them or remove them.",
                                                "value_type": "string"
                                            }
                                        },
                                        {
                                            "condition": {
                                                "type": "constant",
                                                "value": true,
                                                "value_type": "bool"
                                            },
                                            "components": {
                                                "type": "constant",
                                                "value": null,
                                                "value_type": "string"
                                            }
                                        }
                                    ]
                                }
                            },
                            {
                                "id": "monster_edit_spells",
                                "type": "resourceSection",
                                "resource_stat": "spells",
                                "resource_id": "spell",
                                "header_view": {
                                    "id": "monster_edit_spells_comp",
                                    "type": "composite",
                                    "subviews": [
                                        {
                                            "id": "monster_edit_spells_label",
                                            "type": "text",
                                            "text": {
                                                "type": "constant",
                                                "value": "Spells: ",
                                                "value_type": "string"
                                            },
                                            "style": "text",
                                            "bold": true
                                        },
                                        {
                                            "id": "monster_edit_spells_add_spell",
                                            "type": "selectResources",
                                            "stat": "spells",
                                            "resource_id": "spell",
                                            "view_type": "icon",
                                            "should_append": true,
                                            "should_save_on_selection": true
                                        }
                                    ]
                                }
                            }
                        ]
                    },
                    {
                        "id": "monster_edit_basics",
                        "type": "list",
                        "padding": 16,
                        "subviews": [
                            {
                                "id": "monster_edit_skills",
                                "type": "text",
                                "edit_stat": "skills",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Skills",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            },
                            {
                                "id": "monster_edit_gear",
                                "type": "text",
                                "edit_stat": "gear",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Gear",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            },
                            {
                                "id": "monster_edit_vulnerabilities",
                                "type": "text",
                                "edit_stat": "vulnerabilities",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Vulnerabilities",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            },
                            {
                                "id": "monster_edit_immunities",
                                "type": "text",
                                "edit_stat": "immunities",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Immunities",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            },
                            {
                                "id": "monster_edit_resistances",
                                "type": "text",
                                "edit_stat": "resistances",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Resistances",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            },
                            {
                                "id": "monster_edit_senses",
                                "type": "text",
                                "edit_stat": "senses",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Senses",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            },
                            {
                                "id": "monster_edit_languages",
                                "type": "text",
                                "edit_stat": "languages",
                                "style": "text",
                                "label": {
                                    "type": "constant",
                                    "value": "Languages",
                                    "value_type": "string"
                                },
                                "max_length": 140
                            }
                        ]
                    }
                ]
            },
            "search_item_view": {
                "id": "monster_search_item",
                "type": "listItem",
                "title": {
                    "type": "stat",
                    "stat": "name"
                },
                "first_line_extra": {
                    "type": "stat",
                    "stat": "formatted_cr"
                },
                "subtitle": {
                    "type": "stat",
                    "stat": "formatted_type"
                },
                "second_line_extra": {
                    "type": "stat",
                    "stat": "formatted_xp"
                },
                "chips": {
                    "type": "list",
                    "components": [
                        {
                            "type": "createChip",
                            "id": "spell_search_item_source_chip",
                            "background_color": {
                                "type": "constant",
                                "value": "hint",
                                "value_type": "string"
                            },
                            "style": {
                                "type": "constant",
                                "value": "compact",
                                "value_type": "string"
                            },
                            "resource_id": "source",
                            "resource_instance_ids_stat": "source",
                            "resource_display_stat": "abbreviation"
                        }
                    ]
                }
            },
            "display_view": {
                "id": "monster_display",
                "type": "list",
                "padding": 16,
                "alignment": "start",
                "subviews": [
                    {
                        "id": "monster_display_source_type_info",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "monster_display_source",
                                "type": "text",
                                "style": "caption",
                                "margin_left": 16,
                                "margin_right": 4,
                                "resource_id": "source",
                                "resource_instance_ids_stat": "source",
                                "resource_display_stat": "abbreviation"
                            },
                            {
                                "id": "monster_display_type_info",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "type_info"
                                },
                                "style": "caption"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_photo_comp",
                        "type": "composite",
                        "alignment": "end",
                        "subviews": [
                            {
                                "id": "monster_display_photo",
                                "type": "avatar",
                                "photo_stat": "photo",
                                "name_stat": "name",
                                "size": "medium",
                                "interactable": false,
                                "preview_enabled": true
                            }
                        ]
                    },
                    {
                        "id": "monster_display_ac_hp_speed",
                        "type": "composite",
                        "alignment": "center",
                        "subviews": [
                            {
                                "id": "monster_display_ac_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "AC: ",
                                    "value_type": "string"
                                },
                                "style": "subhead",
                                "bold": true
                            },
                            {
                                "id": "monster_display_ac",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "armor_class"
                                },
                                "style": "text",
                                "margin_right": 16
                            },
                            {
                                "id": "monster_display_hp_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "HP: ",
                                    "value_type": "string"
                                },
                                "style": "subhead",
                                "bold": true
                            },
                            {
                                "id": "monster_display_hp",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "hit_points_formatted"
                                },
                                "style": "text",
                                "margin_right": 16
                            },
                            {
                                "id": "monster_display_hp",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_speeds"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_initiative",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "monster_display_initiative_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Initiative: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_initiative",
                                "type": "text",
                                "text": {
                                    "type": "toSignedString",
                                    "components": {
                                        "type": "stat",
                                        "stat": "initiative"
                                    }
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_ability_scores_label",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Abilities:",
                            "value_type": "string"
                        },
                        "style": "text",
                        "bold": true,
                        "margin_top": 4
                    },
                    {
                        "id": "monster_display_ability_scores_1",
                        "type": "composite",
                        "alignment": "center",
                        "subviews": [
                            {
                                "id": "monster_display_strength_score",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_strength_with_mod"
                                },
                                "style": "text",
                                "margin_right": 16
                            },
                            {
                                "id": "monster_display_dexterity_score",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_dexterity_with_mod"
                                },
                                "style": "text",
                                "margin_right": 16
                            },
                            {
                                "id": "monster_display_constitution_score",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_constitution_with_mod"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_ability_scores_2",
                        "type": "composite",
                        "alignment": "center",
                        "margin_top": 8,
                        "subviews": [
                            {
                                "id": "monster_display_intelligence_score",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_intelligence_with_mod"
                                },
                                "style": "text",
                                "margin_right": 16
                            },
                            {
                                "id": "monster_display_wisdom_score",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_wisdom_with_mod"
                                },
                                "style": "text",
                                "margin_right": 16
                            },
                            {
                                "id": "monster_display_charisma_score",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_charisma_with_mod"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_saves_label",
                        "type": "text",
                        "text": {
                            "type": "constant",
                            "value": "Saves:",
                            "value_type": "string"
                        },
                        "style": "text",
                        "bold": true
                    },
                    {
                        "id": "monster_display_saves",
                        "type": "composite",
                        "alignment": "center",
                        "subviews": [
                            {
                                "id": "monster_display_strength_save",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_strength_save"
                                },
                                "style": "text",
                                "margin_right": 8
                            },
                            {
                                "id": "monster_display_dexterity_save",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_dexterity_save"
                                },
                                "style": "text",
                                "margin_right": 8
                            },
                            {
                                "id": "monster_display_constitution_save",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_constitution_save"
                                },
                                "style": "text",
                                "margin_right": 8
                            },
                            {
                                "id": "monster_display_intelligence_save",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_intelligence_save"
                                },
                                "style": "text",
                                "margin_right": 8
                            },
                            {
                                "id": "monster_display_wisdom_save",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_wisdom_save"
                                },
                                "style": "text",
                                "margin_right": 8
                            },
                            {
                                "id": "monster_display_charisma_save",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "display_charisma_save"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_stats_senses_divider",
                        "type": "divider",
                        "margin_bottom": 8
                    },
                    {
                        "id": "monster_display_skills_comp",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "skills"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "monster_display_skills_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Skills: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_skills",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "skills"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_gear_comp",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "gear"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "monster_display_gear_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Gear: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_gear",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "gear"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_vulnerabilities_comp",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "vulnerabilities"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "monster_display_vulnerabilities_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Vulnerabilities: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_vulnerabilities",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "vulnerabilities"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_immunities_comp",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "immunities"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "monster_display_immunities_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Immunities: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_immunities",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "immunities"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_resistances_comp",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "resistances"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "monster_display_resistances_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Resistances: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_resistances",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "resistances"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_senses_comp",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "senses"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "monster_display_senses_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Senses: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_senses",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "senses"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_languages_comp",
                        "type": "composite",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "languages"
                                }
                            }
                        },
                        "subviews": [
                            {
                                "id": "monster_display_languages_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Languages: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_languages",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "languages"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_cr_xp",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "monster_display_cr_xp_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Challenge: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_cr_xp",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "cr_xp"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_traits_divider",
                        "type": "divider"
                    },
                    {
                        "id": "monster_display_traits",
                        "type": "resourceArray",
                        "resource_id": "monster_trait",
                        "stat": "traits",
                        "view_type": "list",
                        "hide_line": true,
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "traits"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_actions_divider",
                        "type": "divider",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "traits"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_actions",
                        "type": "resourceArray",
                        "resource_id": "monster_action",
                        "stat": "actions",
                        "view_type": "list",
                        "hide_line": true,
                        "left_view": {
                            "id": "monster_display_actions_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Actions",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "actions"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_bonus_actions_divider",
                        "type": "divider",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "actions"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_bonus_actions",
                        "type": "resourceArray",
                        "resource_id": "monster_action",
                        "stat": "bonus_actions",
                        "view_type": "list",
                        "hide_line": true,
                        "left_view": {
                            "id": "monster_display_actions_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Bonus actions",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "bonus_actions"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_reactions_divider",
                        "type": "divider",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "bonus_actions"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_reactions",
                        "type": "resourceArray",
                        "resource_id": "monster_action",
                        "stat": "reactions",
                        "view_type": "list",
                        "hide_line": true,
                        "left_view": {
                            "id": "monster_display_reactions_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Reactions",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "reactions"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_legendary_actions_divider",
                        "type": "divider",
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "reactions"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_legendary_actions",
                        "type": "resourceArray",
                        "resource_id": "monster_action",
                        "stat": "legendary_actions",
                        "view_type": "list",
                        "hide_line": true,
                        "left_view": {
                            "id": "monster_display_actions_label",
                            "type": "text",
                            "text": {
                                "type": "constant",
                                "value": "Legendary actions",
                                "value_type": "string"
                            },
                            "style": "text",
                            "bold": true
                        },
                        "is_visible": {
                            "type": "not",
                            "components": {
                                "type": "isEmpty",
                                "components": {
                                    "type": "stat",
                                    "stat": "legendary_actions"
                                }
                            }
                        }
                    },
                    {
                        "id": "monster_display_habitat",
                        "type": "composite",
                        "margin_top": 12,
                        "subviews": [
                            {
                                "id": "monster_display_habitat_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Habitat: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_habitat",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "formatted_habitats"
                                },
                                "style": "text"
                            }
                        ]
                    },
                    {
                        "id": "monster_display_treasure",
                        "type": "composite",
                        "subviews": [
                            {
                                "id": "monster_display_treasure_label",
                                "type": "text",
                                "text": {
                                    "type": "constant",
                                    "value": "Treasure: ",
                                    "value_type": "string"
                                },
                                "style": "text",
                                "bold": true
                            },
                            {
                                "id": "monster_display_treasure",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "formatted_treasure"
                                },
                                "style": "text"
                            }
                        ]
                    }
                ]
            }
        },
        {
            "id": "companion",
            "name": "Companion",
            "plural": "Companions",
            "stats": [
                {
                    "id": "is_companion",
                    "name": "Is companion",
                    "type": "base",
                    "value_type": "bool",
                    "default_value": true
                },
                {
                    "id": "name",
                    "name": "Name",
                    "type": "base",
                    "value_type": "string",
                    "default_value": ""
                },
                {
                    "id": "monster",
                    "name": "Monster",
                    "type": "base",
                    "value_type": "resource",
                    "default_value": null
                },
                {
                    "id": "hp",
                    "name": "HP",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "stat",
                        "stat": "max_hp"
                    }
                },
                {
                    "id": "max_hp",
                    "name": "Max HP",
                    "type": "calculated",
                    "value_type": "integer",
                    "components": {
                        "type": "defaultIfNull",
                        "components": {
                            "type": "stat",
                            "stat": "monster?.average_hp"
                        },
                        "default_components": {
                            "type": "constant",
                            "value": 1,
                            "value_type": "integer"
                        }
                    }
                },
                {
                    "id": "hit_dice_amount",
                    "name": "Hit dice (total)",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 1
                },

                

                {
                    "id": "ac",
                    "name": "AC",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "initiative",
                    "name": "Initiative",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "speed",
                    "name": "Speed",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 5
                },
                {
                    "id": "burrow_speed",
                    "name": "Burrow",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "climb_speed",
                    "name": "Climb",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "fly_speed",
                    "name": "Fly",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "swim_speed",
                    "name": "Swim",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 0
                },
                {
                    "id": "strength_score",
                    "name": "Strength",
                    "abbreviation": "STR",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "dexterity_score",
                    "name": "Dexterity",
                    "abbreviation": "DEX",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "constitution_score",
                    "name": "Constitution",
                    "abbreviation": "CON",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "intelligence_score",
                    "name": "Intelligence",
                    "abbreviation": "INT",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "wisdom_score",
                    "name": "Wisdom",
                    "abbreviation": "WIS",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                },
                {
                    "id": "charisma_score",
                    "name": "Charisma",
                    "abbreviation": "CHA",
                    "type": "base",
                    "value_type": "integer",
                    "default_value": 10
                }
            ],
            "mechanics": [
                {
                    "id": "on_create",
                    "name": "On create",
                    "event_names": "rpg_onCreate",
                    "effects": {
                        "type": "sequence",
                        "effects": [
                            {
                                "type": "setStat",
                                "stat": "max_hp",
                                "new_value": {
                                    "type": "stat",
                                    "stat": "monster.average_hp"
                                },
                                "aggregation_type": "set"
                            },
                            {
                                "type": "setStat",
                                "stat": "hp",
                                "new_value": {
                                    "type": "stat",
                                    "stat": "max_hp"
                                },
                                "aggregation_type": "set"
                            }
                        ]
                    }
                },
                {
                    "id": "roll_stat",
                    "event_names": "companion_list_roll_stat",
                    "effects": {
                        "type": "roll",
                        "rolls": {
                            "type": "list",
                            "components": [
                                {
                                    "type": "rollable",
                                    "formulas": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "concat",
                                                "components": {
                                                    "type": "list",
                                                    "components": [
                                                        {
                                                            "type": "constant",
                                                            "value": "1d20 + ",
                                                            "value_type": "string"
                                                        },
                                                        {
                                                            "type": "metaStat",
                                                            "meta_stat": {
                                                                "type": "stat",
                                                                "stat": "$event.stat"
                                                            }
                                                        }
                                                    ]
                                                }
                                            }
                                        ]
                                    },
                                    "text": {
                                        "type": "stat",
                                        "stat": "$event.statName"
                                    }
                                }
                            ]
                        }
                    }
                },
                {
                    "id": "companion_list_show_monster",
                    "name": "Show monster",
                    "event_names": "companion_list_show_monster",
                    "effects": {
                        "type": "showResource",
                        "resource": {
                            "type": "stat",
                            "stat": "monster"
                        },
                        "edit_stat": {
                            "type": "constant",
                            "value": "monster",
                            "value_type": "string"
                        }
                    }
                }
            ],
            "edit_view": {
                "id": "companion_edit",
                "type": "list",
                "padding": 16,
                "subviews": [
                    {
                        "id": "companion_edit_name",
                        "type": "text",
                        "hint": {
                            "type": "constant",
                            "value": "Name",
                            "value_type": "string"
                        },
                        "edit_stat": "name",
                        "style": "title",
                        "max_length": 40,
                        "validation_message": {
                            "type": "when",
                            "clauses": [
                                {
                                    "condition": {
                                        "type": "isEmpty",
                                        "components": {
                                            "type": "stat",
                                            "stat": "$view.companion_edit_name"
                                        }
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": "Please make sure to provide a name",
                                        "value_type": "string"
                                    }
                                },
                                {
                                    "condition": {
                                        "type": "constant",
                                        "value": true,
                                        "value_type": "bool"
                                    },
                                    "components": {
                                        "type": "constant",
                                        "value": null,
                                        "value_type": "string"
                                    }
                                }
                            ]
                        }
                    },
                    {
                        "id": "companion_edit_monster",
                        "type": "selectResources",
                        "stat": "monster",
                        "resource_id": "monster"
                    }
                ]
            },
            "list_view": {
                "id": "companion_list",
                "type": "list",
                "alignment": "center",
                "subviews": [
                    {
                        "id": "status_header_section",
                        "type": "section",
                        "show_divider": true,
                        "content_item_min_width": 1,
                        "collapsible": false,
                        "header": [
                            {
                                "id": "avatar_view",
                                "type": "avatar",
                                "margin_top": 8,
                                "margin_right": 8,
                                "margin_left": 16,
                                "photo_stat": "monster.photo",
                                "name_stat": "name",
                                "size": "small",
                                "preview_enabled": true
                            },
                            {
                                "id": "status_hp",
                                "type": "ticker",
                                "margin_left": 16,
                                "stat": "hp",
                                "style": "title",
                                "button_location": "right",
                                "button_look": "plusMinus",
                                "should_auto_save": true,
                                "change_amount": 1,
                                "min_value_allowed": 0,
                                "label": {
                                    "type": "concat",
                                    "components": {
                                        "type": "list",
                                        "components": [
                                            {
                                                "type": "constant",
                                                "value": "/ ",
                                                "value_type": "string"
                                            },
                                            {
                                                "type": "stat",
                                                "stat": "max_hp"
                                            },
                                            {
                                                "type": "constant",
                                                "value": " HP",
                                                "value_type": "string"
                                            }
                                        ]
                                    }
                                },
                                "label_alignment": "right",
                                "edit_bottom_sheet_title": {
                                    "type": "constant",
                                    "value": "Hit points",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "not",
                                    "components": {
                                        "type": "stat",
                                        "stat": "$character.$edit_mode"
                                    }
                                }
                            },
                            {
                                "id": "status_max_hp",
                                "type": "ticker",
                                "margin_left": 16,
                                "stat": "max_hp",
                                "style": "title",
                                "button_location": "right",
                                "button_look": "plusMinus",
                                "should_auto_save": true,
                                "change_amount": 1,
                                "min_value_allowed": 1,
                                "label": {
                                    "type": "constant",
                                    "value": "Max HP",
                                    "value_type": "string"
                                },
                                "label_alignment": "right",
                                "edit_bottom_sheet_title": {
                                    "type": "constant",
                                    "value": "Max hit points",
                                    "value_type": "string"
                                },
                                "is_visible": {
                                    "type": "stat",
                                    "stat": "$character.$edit_mode"
                                }
                            }
                        ],
                        "content": [
                            {
                                "id": "companion_list_status_name",
                                "type": "text",
                                "text": {
                                    "type": "stat",
                                    "stat": "name"
                                },
                                "edit_stat": "name",
                                "style": "headline",
                                "max_length": 40,
                                "margin_left": 16,
                                "margin_right": 16,
                                "margin_top": 8,
                                "hint": {
                                    "type": "constant",
                                    "value": "Name",
                                    "value_type": "string"
                                }
                            }
                        ]
                    },
                    {
                        "id": "status_section",
                        "type": "section",
                        "show_divider": false,
                        "content_item_min_width": 180,
                        "collapsible": false,
                        "header": [],
                        "content": [
                            {
                                "id": "monster_list_armor_class",
                                "type": "stat",
                                "stat": "monster.armor_class",
                                "change_amount": 1,
                                "min_value_allowed": 0
                            },
                            {
                                "id": "monster_list_initiative",
                                "type": "stat",
                                "stat": "monster.initiative",
                                "change_amount": 1,
                                "on_tap_event": {
                                    "name": "companion_list_roll_stat",
                                    "payload": {
                                        "stat": "monster.initiative",
                                        "statName": "Initiative"
                                    }
                                }
                            },
                            {
                                "id": "monster_list_speed",
                                "type": "stat",
                                "stat": "monster.speed",
                                "change_amount": 5,
                                "min_value_allowed": 0,
                                "bottom_sheet_in_edit_mode": true,
                                "bottom_sheet_view": {
                                    "id": "monster_list_speed_section",
                                    "type": "section",
                                    "header": [],
                                    "show_divider": false,
                                    "content_item_min_width": 125,
                                    "collapsible": false,
                                    "content": [
                                        {
                                            "id": "monster_list_speed_bottom_sheet_stat",
                                            "type": "stat",
                                            "stat": "monster.speed",
                                            "change_amount": 5,
                                            "min_value_allowed": 0
                                        },
                                        {
                                            "id": "monster_list_burrow_speed_bottom_sheet_stat",
                                            "type": "stat",
                                            "stat": "monster.burrow_speed",
                                            "change_amount": 5,
                                            "min_value_allowed": 0
                                        },
                                        {
                                            "id": "monster_list_climb_speed_bottom_sheet_stat",
                                            "type": "stat",
                                            "stat": "monster.climb_speed",
                                            "change_amount": 5,
                                            "min_value_allowed": 0
                                        },
                                        {
                                            "id": "monster_list_fly_speed_bottom_sheet_stat",
                                            "type": "stat",
                                            "stat": "monster.fly_speed",
                                            "change_amount": 5,
                                            "min_value_allowed": 0
                                        },
                                        {
                                            "id": "monster_list_swim_speed_bottom_sheet_stat",
                                            "type": "stat",
                                            "stat": "monster.swim_speed",
                                            "change_amount": 5,
                                            "min_value_allowed": 0
                                        }
                                    ]
                                },
                                "sheet_title": {
                                    "type": "constant",
                                    "value": "Manage speeds",
                                    "value_type": "string"
                                }
                            },
                            {
                                "id": "monster_list_hit_dice",
                                "type": "stat",
                                "stat": "hit_dice_amount",
                                "change_amount": 1,
                                "min_value_allowed": 0
                            }
                        ]
                    },
                    {
                        "id": "companion_list_show_monster",
                        "type": "button",
                        "text": {
                            "type": "constant",
                            "value": "VIEW STATS",
                            "value_type": "string"
                        },
                        "event": {
                            "name": "companion_list_show_monster",
                            "payload": {}
                        }
                    }
                ]
            }
        }
    ],
    "currencies": [
        {
            "id": "currencies_platinum_pieces",
            "name": "Platinum Piece",
            "plural": "Platinum Pieces",
            "abbreviation": "PP",
            "conversion": {
                "currencies_gold_pieces": 10,
                "currencies_electrum_pieces": 20,
                "currencies_silver_pieces": 100,
                "currencies_copper_pieces": 1000
            }
        },
        {
            "id": "currencies_gold_pieces",
            "name": "Gold Piece",
            "plural": "Gold Pieces",
            "abbreviation": "GP",
            "conversion": {
                "currencies_platinum_pieces": 0.1,
                "currencies_electrum_pieces": 2,
                "currencies_silver_pieces": 10,
                "currencies_copper_pieces": 100
            }
        },
        {
            "id": "currencies_electrum_pieces",
            "name": "Electrum Piece",
            "plural": "Electrum Pieces",
            "abbreviation": "EP",
            "conversion": {
                "currencies_platinum_pieces": 0.05,
                "currencies_gold_pieces": 0.5,
                "currencies_silver_pieces": 5,
                "currencies_copper_pieces": 50
            }
        },
        {
            "id": "currencies_silver_pieces",
            "name": "Silver Piece",
            "plural": "Silver Pieces",
            "abbreviation": "SP",
            "conversion": {
                "currencies_platinum_pieces": 0.01,
                "currencies_gold_pieces": 0.1,
                "currencies_electrum_pieces": 0.2,
                "currencies_copper_pieces": 10
            }
        },
        {
            "id": "currencies_copper_pieces",
            "name": "Copper Piece",
            "plural": "Copper Pieces",
            "abbreviation": "CP",
            "conversion": {
                "currencies_platinum_pieces": 0.001,
                "currencies_gold_pieces": 0.01,
                "currencies_electrum_pieces": 0.02,
                "currencies_silver_pieces": 0.1
            }
        }
    ]
}