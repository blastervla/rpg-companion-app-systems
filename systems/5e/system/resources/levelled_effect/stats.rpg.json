[
  {
    "id": "level",
    "name": "Level",
    "abbreviation": "Lvl",
    "type": "base",
    "value_type": "integer",
    "default_value": 1
  },
  {
    "id": "effect",
    "name": "Effect",
    "type": "base",
    "value_type": "resource",
    "resource_type": "effect",
    "default_value": null
  },
  {
    "id": "is_levelled",
    "name": "Is levelled",
    "type": "base",
    "value_type": "bool",
    "default_value": true
  },
  {
    "id": "current_level",
    "name": "Current level for character / resource this is attached to",
    "type": "calculated",
    "value_type": "integer",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "defined",
            "stat": "$parent.level"
          },
          "components": {
            "type": "stat",
            "stat": "$parent.level"
          }
        },
        {
          "condition": {
            "type": "defined",
            "stat": "$character.level"
          },
          "components": {
            "type": "stat",
            "stat": "$character.level"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": 1,
            "value_type": "integer"
          }
        }
      ]
    }
  },
  {
    "id": "execution_level",
    "name": "Min level for execution",
    "type": "calculated",
    "value_type": "integer",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "defaultIfNull",
            "components": {
              "type": "stat",
              "stat": "$parent?.is_feat?"
            },
            "default_components": {
              "type": "constant",
              "value": false,
              "value_type": "bool"
            }
          },
          "components": {
            "type": "max",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "stat",
                  "stat": "level"
                },
                {
                  "type": "stat",
                  "stat": "$parent.min_level"
                }
              ]
            }
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "stat",
            "stat": "level"
          }
        }
      ]
    }
  },
  {
    "id": "can_execute",
    "name": "Can execute",
    "type": "calculated",
    "value_type": "bool",
    "components": {
      "type": "greaterThanEquals",
      "components": {
        "type": "list",
        "components": [
          {
            "type": "stat",
            "stat": "current_level"
          },
          {
            "type": "stat",
            "stat": "execution_level"
          }
        ]
      }
    }
  },
  {
    "id": "should_load_effects",
    "name": "Should load effects",
    "type": "calculated",
    "value_type": "bool",
    "components": {
      "type": "and",
      "components": {
        "type": "list",
        "components": [
          {
            "type": "defaultIfNull",
            "components": {
              "type": "stat",
              "stat": "$parent?.should_load_effects?"
            },
            "default_components": {
              "type": "constant",
              "value": true,
              "value_type": "bool"
            }
          }
        ]
      }
    }
  },
  {
    "id": "description",
    "name": "Display description",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "notEquals",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "stat",
                  "stat": "effect"
                },
                {
                  "type": "constant",
                  "value": null,
                  "value_type": "string"
                }
              ]
            }
          },
          "components": {
            "type": "concat",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "constant",
                  "value": "Lvl. ",
                  "value_type": "string"
                },
                {
                  "type": "stat",
                  "stat": "level"
                },
                {
                  "type": "constant",
                  "value": ": ",
                  "value_type": "string"
                },
                {
                  "type": "stat",
                  "stat": "effect.edit_display_name"
                }
              ]
            }
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": "No effect",
            "value_type": "string"
          }
        }
      ]
    }
  },
  {
    "id": "effect_only_description",
    "name": "Effect display description",
    "type": "calculated",
    "value_type": "string",
    "components": {
      "type": "when",
      "clauses": [
        {
          "condition": {
            "type": "notEquals",
            "components": {
              "type": "list",
              "components": [
                {
                  "type": "stat",
                  "stat": "effect"
                },
                {
                  "type": "constant",
                  "value": null,
                  "value_type": "string"
                }
              ]
            }
          },
          "components": {
            "type": "stat",
            "stat": "effect.edit_display_name"
          }
        },
        {
          "condition": {
            "type": "constant",
            "value": true,
            "value_type": "bool"
          },
          "components": {
            "type": "constant",
            "value": "No effect",
            "value_type": "string"
          }
        }
      ]
    }
  }
]